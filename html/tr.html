<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>tr API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#appointment">appointment</a>
            </li>
            <li>
                    <a class="variable" href="#cxxkitid">cxxkitid</a>
            </li>
            <li>
                    <a class="variable" href="#samplingdate">samplingdate</a>
            </li>
            <li>
                    <a class="variable" href="#concentration">concentration</a>
            </li>
            <li>
                    <a class="variable" href="#derivaldate">derivaldate</a>
            </li>
            <li>
                    <a class="variable" href="#category">category</a>
            </li>
            <li>
                    <a class="variable" href="#initialamount">initialamount</a>
            </li>
            <li>
                    <a class="variable" href="#initialunit">initialunit</a>
            </li>
            <li>
                    <a class="variable" href="#first_repositiondate">first_repositiondate</a>
            </li>
            <li>
                    <a class="variable" href="#method">method</a>
            </li>
            <li>
                    <a class="variable" href="#kitid">kitid</a>
            </li>
            <li>
                    <a class="variable" href="#locationname">locationname</a>
            </li>
            <li>
                    <a class="variable" href="#locationpath">locationpath</a>
            </li>
            <li>
                    <a class="variable" href="#orga">orga</a>
            </li>
            <li>
                    <a class="variable" href="#parentid">parentid</a>
            </li>
            <li>
                    <a class="variable" href="#parentoid">parentoid</a>
            </li>
            <li>
                    <a class="variable" href="#patientid">patientid</a>
            </li>
            <li>
                    <a class="variable" href="#project">project</a>
            </li>
            <li>
                    <a class="variable" href="#receiptdate">receiptdate</a>
            </li>
            <li>
                    <a class="variable" href="#receptacle">receptacle</a>
            </li>
            <li>
                    <a class="variable" href="#repositiondate">repositiondate</a>
            </li>
            <li>
                    <a class="variable" href="#restamount">restamount</a>
            </li>
            <li>
                    <a class="variable" href="#restunit">restunit</a>
            </li>
            <li>
                    <a class="variable" href="#sampleid">sampleid</a>
            </li>
            <li>
                    <a class="variable" href="#sampleoid">sampleoid</a>
            </li>
            <li>
                    <a class="variable" href="#sampletype">sampletype</a>
            </li>
            <li>
                    <a class="variable" href="#secondprocessing">secondprocessing</a>
            </li>
            <li>
                    <a class="variable" href="#secondprocessingdate">secondprocessingdate</a>
            </li>
            <li>
                    <a class="variable" href="#stockprocessing">stockprocessing</a>
            </li>
            <li>
                    <a class="variable" href="#stockprocessingdate">stockprocessingdate</a>
            </li>
            <li>
                    <a class="variable" href="#trial">trial</a>
            </li>
            <li>
                    <a class="variable" href="#type">type</a>
            </li>
            <li>
                    <a class="variable" href="#values">values</a>
            </li>
            <li>
                    <a class="variable" href="#xposition">xposition</a>
            </li>
            <li>
                    <a class="variable" href="#yposition">yposition</a>
            </li>
            <li>
                    <a class="variable" href="#cnftemplate">cnftemplate</a>
            </li>
            <li>
                    <a class="function" href="#floatornull">floatornull</a>
            </li>
            <li>
                    <a class="function" href="#get_ids">get_ids</a>
            </li>
            <li>
                    <a class="class" href="#Identifier">Identifier</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Identifier.__init__">Identifier</a>
                        </li>
                        <li>
                                <a class="variable" href="#Identifier.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#Identifier.code">code</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Amount">Amount</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Amount.__init__">Amount</a>
                        </li>
                        <li>
                                <a class="variable" href="#Amount.value">value</a>
                        </li>
                        <li>
                                <a class="variable" href="#Amount.unit">unit</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Idable">Idable</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Idable.__init__">Idable</a>
                        </li>
                        <li>
                                <a class="variable" href="#Idable.ids">ids</a>
                        </li>
                        <li>
                                <a class="variable" href="#Idable.mainidc">mainidc</a>
                        </li>
                        <li>
                                <a class="function" href="#Idable.identifier">identifier</a>
                        </li>
                        <li>
                                <a class="function" href="#Idable.id">id</a>
                        </li>
                        <li>
                                <a class="function" href="#Idable.iddict">iddict</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Sample">Sample</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Sample.__init__">Sample</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.appointment">appointment</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.category">category</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.concentration">concentration</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.derivaldate">derivaldate</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.receiptdate">receiptdate</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.first_repositiondate">first_repositiondate</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.initialamount">initialamount</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.locationname">locationname</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.locationpath">locationpath</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.orga">orga</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.parent">parent</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.patient">patient</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.project">project</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.receptacle">receptacle</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.restamount">restamount</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.samplingdate">samplingdate</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.secondprocessing">secondprocessing</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.secondprocessingdate">secondprocessingdate</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.stockprocessing">stockprocessing</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.stockprocessingdate">stockprocessingdate</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.repositiondate">repositiondate</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.trial">trial</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.type">type</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.xposition">xposition</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.yposition">yposition</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.cxxkitid">cxxkitid</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.kitid">kitid</a>
                        </li>
                        <li>
                                <a class="function" href="#Sample.default">default</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.sampleid">sampleid</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Patient">Patient</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Patient.__init__">Patient</a>
                        </li>
                        <li>
                                <a class="variable" href="#Patient.orga">orga</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Finding">Finding</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Finding.__init__">Finding</a>
                        </li>
                        <li>
                                <a class="variable" href="#Finding.method">method</a>
                        </li>
                        <li>
                                <a class="variable" href="#Finding.findingdate">findingdate</a>
                        </li>
                        <li>
                                <a class="variable" href="#Finding.methodname">methodname</a>
                        </li>
                        <li>
                                <a class="variable" href="#Finding.patient">patient</a>
                        </li>
                        <li>
                                <a class="variable" href="#Finding.recs">recs</a>
                        </li>
                        <li>
                                <a class="variable" href="#Finding.sample">sample</a>
                        </li>
                        <li>
                                <a class="variable" href="#Finding.sender">sender</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Rec">Rec</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Rec.__init__">Rec</a>
                        </li>
                        <li>
                                <a class="variable" href="#Rec.method">method</a>
                        </li>
                        <li>
                                <a class="variable" href="#Rec.labval">labval</a>
                        </li>
                        <li>
                                <a class="variable" href="#Rec.type">type</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#BooleanRec">BooleanRec</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BooleanRec.__init__">BooleanRec</a>
                        </li>
                        <li>
                                <a class="variable" href="#BooleanRec.value">value</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#NumberRec">NumberRec</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#NumberRec.__init__">NumberRec</a>
                        </li>
                        <li>
                                <a class="variable" href="#NumberRec.value">value</a>
                        </li>
                        <li>
                                <a class="variable" href="#NumberRec.unit">unit</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#StringRec">StringRec</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#StringRec.__init__">StringRec</a>
                        </li>
                        <li>
                                <a class="variable" href="#StringRec.value">value</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DateRec">DateRec</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DateRec.__init__">DateRec</a>
                        </li>
                        <li>
                                <a class="variable" href="#DateRec.value">value</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CatalogRec">CatalogRec</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CatalogRec.__init__">CatalogRec</a>
                        </li>
                        <li>
                                <a class="variable" href="#CatalogRec.values">values</a>
                        </li>
                        <li>
                                <a class="variable" href="#CatalogRec.catalog">catalog</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MultiRec">MultiRec</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MultiRec.__init__">MultiRec</a>
                        </li>
                        <li>
                                <a class="variable" href="#MultiRec.values">values</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#idable_csv">idable_csv</a>
            </li>
            <li>
                    <a class="class" href="#traction">traction</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#traction.__init__">traction</a>
                        </li>
                        <li>
                                <a class="variable" href="#traction.settings">settings</a>
                        </li>
                        <li>
                                <a class="variable" href="#traction.jd">jd</a>
                        </li>
                        <li>
                                <a class="function" href="#traction.sample">sample</a>
                        </li>
                        <li>
                                <a class="function" href="#traction.patient">patient</a>
                        </li>
                        <li>
                                <a class="function" href="#traction.trial">trial</a>
                        </li>
                        <li>
                                <a class="function" href="#traction.finding">finding</a>
                        </li>
                        <li>
                                <a class="function" href="#traction.method">method</a>
                        </li>
                        <li>
                                <a class="function" href="#traction.name">name</a>
                        </li>
                        <li>
                                <a class="function" href="#traction.sidc">sidc</a>
                        </li>
                        <li>
                                <a class="function" href="#traction.pidc">pidc</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
tr    </h1>

                
                        <input id="mod-tr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-tr-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="c1"># automatically generated, DON&#39;T EDIT. please edit init.ct from where this file stems.</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">dbcq</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">cnf</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">dip</span><span class="w"> </span><span class="kn">import</span> <span class="n">dig</span><span class="p">,</span> <span class="n">dis</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="c1">#from json import JSONEncoder</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">jsonpickle</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="n">appointment</span> <span class="o">=</span> <span class="s2">&quot;appointment&quot;</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="n">cxxkitid</span> <span class="o">=</span> <span class="s2">&quot;cxxkitid&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="n">samplingdate</span> <span class="o">=</span> <span class="s2">&quot;samplingdate&quot;</span> <span class="c1"># entnahmedatum / extraction date. </span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="n">concentration</span> <span class="o">=</span> <span class="s2">&quot;concentration&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="n">derivaldate</span> <span class="o">=</span> <span class="s2">&quot;derivaldate&quot;</span> <span class="c1"># aufteilungsdatum / date of distribution</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="n">category</span> <span class="o">=</span> <span class="s2">&quot;category&quot;</span> <span class="c1"># MASTER, ALIQUOTGROUP, DERIVED. dtype in db.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="n">initialamount</span> <span class="o">=</span> <span class="s2">&quot;initialamount&quot;</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="n">initialunit</span> <span class="o">=</span> <span class="s2">&quot;initialunit&quot;</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="n">first_repositiondate</span> <span class="o">=</span> <span class="s2">&quot;first_repositiondate&quot;</span> <span class="c1"># datum der ersten einlagerung / date of first storage (not in fhir). is identical to derivaldate. first_repositiondate in db.</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;method&quot;</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="n">kitid</span> <span class="o">=</span> <span class="s2">&quot;kitid&quot;</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="n">locationname</span> <span class="o">=</span> <span class="s2">&quot;locationname&quot;</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="n">locationpath</span> <span class="o">=</span> <span class="s2">&quot;locationpath&quot;</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="n">orga</span> <span class="o">=</span> <span class="s2">&quot;orga&quot;</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="n">parentid</span> <span class="o">=</span> <span class="s2">&quot;parentid&quot;</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="n">parentoid</span> <span class="o">=</span> <span class="s2">&quot;parentoid&quot;</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="n">patientid</span> <span class="o">=</span> <span class="s2">&quot;patientid&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="n">project</span> <span class="o">=</span> <span class="s2">&quot;project&quot;</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="n">receiptdate</span> <span class="o">=</span> <span class="s2">&quot;receiptdate&quot;</span> <span class="c1"># eingangsdatum / date of receipt. receiptdate in db.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="n">receptacle</span> <span class="o">=</span> <span class="s2">&quot;receptacle&quot;</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="n">repositiondate</span> <span class="o">=</span> <span class="s2">&quot;repositiondate&quot;</span> <span class="c1"># datum der letzten einlagerung / most recent storage date. </span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="n">restamount</span> <span class="o">=</span> <span class="s2">&quot;restamount&quot;</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="n">restunit</span> <span class="o">=</span> <span class="s2">&quot;restunit&quot;</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="n">sampleid</span> <span class="o">=</span> <span class="s2">&quot;sampleid&quot;</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="n">sampleoid</span> <span class="o">=</span> <span class="s2">&quot;sampleoid&quot;</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="n">sampletype</span> <span class="o">=</span> <span class="s2">&quot;sampletype&quot;</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="n">secondprocessing</span> <span class="o">=</span> <span class="s2">&quot;secondprocessing&quot;</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="n">secondprocessingdate</span> <span class="o">=</span> <span class="s2">&quot;secondprocessingdate&quot;</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="n">stockprocessing</span> <span class="o">=</span> <span class="s2">&quot;stockprocessing&quot;</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="n">stockprocessingdate</span> <span class="o">=</span> <span class="s2">&quot;stockprocessingdate&quot;</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="n">trial</span> <span class="o">=</span> <span class="s2">&quot;trial&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;type&quot;</span> <span class="c1"># sampletype (EDTA, stool etc) in db. </span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="n">values</span> <span class="o">=</span> <span class="s2">&quot;values&quot;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="n">xposition</span> <span class="o">=</span> <span class="s2">&quot;xposition&quot;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="n">yposition</span> <span class="o">=</span> <span class="s2">&quot;yposition&quot;</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="n">cnftemplate</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="s2"># settings for traction.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="s2"># sampleid sets the idcontainertype code that is used when searching for sampleid.</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="s2"># put in a code per db target.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="s2">sampleid: </span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="s2">  &lt;db target&gt;: &lt;an idcontainertype code, e.g. SAMPLEID&gt;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="s2"># patientid sets the idcontainertype code that is used when searching for patientid.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="s2"># put in a code per db target.</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="s2">patientid: </span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="s2">  &lt;db target&gt;: &lt;an idcontainertype code, e.g. LIMSPSN&gt;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="s2"># idc holds additional idcontainertype codes that will be queryable as command line flags.</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="s2">idc:</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="s2"> - &lt;an idcontainertype code&gt;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="s2"> - &lt;another idcontainertype code&gt;</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_checkverbose</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="n">possible</span><span class="p">):</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">     _checkverbose makes shure that only allowed keys are in the verbose array. </span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>    <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">possible</span><span class="p">:</span> 
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error: verbose entry </span><span class="si">{</span><span class="n">verb</span><span class="si">}</span><span class="s2"> must be in </span><span class="si">{</span><span class="n">possible</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="k">def</span><span class="w"> </span><span class="nf">floatornull</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">     floatornull casts to float or returns None. somehow the values passed</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">     to Amount need float casts, and float casts don&#39;t accept None.</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_ids</span><span class="p">(</span><span class="n">idables</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">     get_ids returns a list of string ids from a list of Idables (Sample or</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">     Patient).</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>    <span class="k">return</span> <span class="p">[</span> <span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">idables</span> <span class="p">]</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Identifier</span><span class="p">:</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="sd">         __init__ initializes an identifier.</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Amount</span><span class="p">:</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd">         __init__ initializes an amount.</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">         __str__ gives the value and unit in human-readable format.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Idable</span><span class="p">:</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mainidc</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="sd">         __init__ initializes an Idable from a list of Identifiers and a</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="sd">         mainidc string.</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ids</span> <span class="o">=</span> <span class="n">ids</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mainidc</span> <span class="o">=</span> <span class="n">mainidc</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>        <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">))</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Identifier</span><span class="p">:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">         identifier returns the Identifier for the given code, if no code</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="sd">         given, the Identifier for the main idc returned.</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainidc</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>        <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">:</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>            <span class="k">if</span> <span class="n">identifier</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="n">code</span><span class="p">:</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>                <span class="k">return</span> <span class="n">identifier</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="sd">         id returns the id value for the given code, if no code</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="sd">         given, the id value for the main idc is returned.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="o">.</span><span class="n">id</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>        <span class="k">return</span> <span class="kc">None</span> 
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">iddict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">idcs</span><span class="p">):</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">         iddict returns a copy of the __dict__ holding the given ids at the</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">         root level of the dict in addition to the classes attributes.  if no</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">         ids are given, all ids taken.  the ids and mainidc fields are cleared,</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="sd">         exept when keep is true. if iddict is called on an inheriting class</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">         (e.g. Sample) the dict gives the inheriting classes attributes.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>        <span class="k">if</span> <span class="n">idcs</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">idcs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>            <span class="n">idcs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">id</span><span class="o">.</span><span class="n">code</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">]</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>        <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="n">idcs</span><span class="p">:</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>            <span class="n">d</span><span class="p">[</span><span class="n">idc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">idc</span><span class="p">)</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>        <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">]</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>        <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;mainidc&quot;</span><span class="p">]</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>        <span class="k">return</span> <span class="n">d</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">         __str__ gives a human readable representation of Idable, here the</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">         id string.</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">()</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Sample</span><span class="p">(</span><span class="n">Idable</span><span class="p">):</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>    <span class="n">appointment</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>    <span class="n">category</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>    <span class="n">concentration</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>    <span class="n">derivaldate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>    <span class="n">receiptdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>    <span class="n">first_repositiondate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>    <span class="n">initialamount</span><span class="p">:</span><span class="n">Amount</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>    <span class="n">locationname</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>    <span class="n">locationpath</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>    <span class="n">orga</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>    <span class="n">parent</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span> 
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>    <span class="n">patient</span><span class="p">:</span><span class="n">Idable</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>    <span class="n">project</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>    <span class="n">receptacle</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>    <span class="n">restamount</span><span class="p">:</span><span class="n">Amount</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>    <span class="n">samplingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>    <span class="n">secondprocessing</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>    <span class="n">secondprocessingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>    <span class="n">stockprocessing</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>    <span class="n">stockprocessingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>    <span class="n">repositiondate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>    <span class="n">trial</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>    <span class="nb">type</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>    <span class="n">xposition</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>    <span class="n">yposition</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>         <span class="bp">self</span><span class="p">,</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>         <span class="n">appointment</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>         <span class="n">category</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>         <span class="n">cxxkitid</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>         <span class="n">concentration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># str?</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>         <span class="n">derivaldate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>         <span class="n">first_repositiondate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>         <span class="n">ids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># of Identifier         </span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>         <span class="n">initialamount</span><span class="p">:</span><span class="n">Amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>         <span class="n">kitid</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>         <span class="n">locationpath</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>         <span class="n">locationname</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>         <span class="n">orga</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>         <span class="n">parent</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>         <span class="n">patient</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>         <span class="n">project</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>         <span class="n">receptacle</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>         <span class="n">restamount</span><span class="p">:</span><span class="n">Amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>         <span class="n">samplingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>         <span class="n">secondprocessing</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>         <span class="n">secondprocessingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>         
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>         <span class="n">stockprocessing</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>         <span class="n">stockprocessingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>         
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>         <span class="n">receiptdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>         
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>         <span class="n">repositiondate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>         <span class="n">sidc</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>         <span class="n">trial</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>         <span class="nb">type</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>         <span class="n">xposition</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>         <span class="n">yposition</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>         <span class="p">):</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>        <span class="n">Idable</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="n">sidc</span><span class="p">)</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">appointment</span> <span class="o">=</span> <span class="n">appointment</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">category</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cxxkitid</span> <span class="o">=</span> <span class="n">cxxkitid</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">concentration</span> <span class="o">=</span> <span class="n">concentration</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">derivaldate</span> <span class="o">=</span> <span class="n">derivaldate</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">receiptdate</span> <span class="o">=</span> <span class="n">receiptdate</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">first_repositiondate</span> <span class="o">=</span> <span class="n">first_repositiondate</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialamount</span> <span class="o">=</span> <span class="n">initialamount</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kitid</span> <span class="o">=</span> <span class="n">kitid</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locationpath</span> <span class="o">=</span> <span class="n">locationpath</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locationname</span> <span class="o">=</span> <span class="n">locationname</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orga</span> <span class="o">=</span> <span class="n">orga</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">patient</span> <span class="o">=</span> <span class="n">patient</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">receptacle</span> <span class="o">=</span> <span class="n">receptacle</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">repositiondate</span> <span class="o">=</span> <span class="n">repositiondate</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">restamount</span> <span class="o">=</span> <span class="n">restamount</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secondprocessing</span> <span class="o">=</span> <span class="n">secondprocessing</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secondprocessingdate</span> <span class="o">=</span> <span class="n">secondprocessingdate</span>        
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stockprocessing</span> <span class="o">=</span> <span class="n">stockprocessing</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stockprocessingdate</span> <span class="o">=</span> <span class="n">stockprocessingdate</span>        
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">samplingdate</span> <span class="o">=</span> <span class="n">samplingdate</span>        
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trial</span> <span class="o">=</span> <span class="n">trial</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xposition</span> <span class="o">=</span> <span class="n">xposition</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">yposition</span> <span class="o">=</span> <span class="n">yposition</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a><span class="sd">         default returns the json dict.</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>        <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="vm">__dict__</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>    <span class="nd">@property</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sampleid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="sd">         sampleid is a shorthand to get the sampleid so it isn&#39;t buried in a</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">         dict when displaying the object as json.</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>        <span class="k">return</span> <span class="s2">&quot;bla&quot;</span> <span class="c1"># self.get_id()</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a><span class="sd">         __getstate__ returns what gets jsonpickled. include sampleid and</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a><span class="sd">         patientid in root level, for quicker access.</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># is this slow?</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>        <span class="n">state</span><span class="p">[</span><span class="n">sampleid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">()</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>        <span class="n">state</span><span class="p">[</span><span class="n">patientid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patient</span><span class="o">.</span><span class="n">id</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">patient</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>        <span class="k">return</span> <span class="n">state</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Patient</span><span class="p">(</span><span class="n">Idable</span><span class="p">):</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>      <span class="n">ids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>      <span class="n">orga</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>      <span class="n">pidc</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>    <span class="p">):</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>        <span class="n">Idable</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="n">pidc</span><span class="p">)</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orga</span> <span class="o">=</span> <span class="n">orga</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a><span class="sd">         __getstate__ returns what gets jsonpickled. include the patientid at the root level, for quicker access.</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># is this slow?</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>        <span class="n">state</span><span class="p">[</span><span class="n">patientid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">()</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>        <span class="k">return</span> <span class="n">state</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Finding</span><span class="p">:</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>    <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>    <span class="n">findingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>    <span class="n">methodname</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>    <span class="n">patient</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>    <span class="n">recs</span><span class="p">:</span><span class="nb">map</span><span class="o">=</span><span class="p">{}</span> <span class="c1"># of Rec, by code</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>    <span class="n">sample</span><span class="p">:</span><span class="n">Idable</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>    <span class="n">sender</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>        <span class="n">findingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>        <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>        <span class="n">methodname</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>        <span class="n">patient</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>        
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>        <span class="n">recs</span><span class="p">:</span><span class="nb">map</span><span class="o">=</span><span class="p">{},</span> <span class="c1"># of Rec, by code</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>        <span class="n">sample</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>        <span class="n">sender</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>    <span class="p">):</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">findingdate</span> <span class="o">=</span> <span class="n">findingdate</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">methodname</span> <span class="o">=</span> <span class="n">methodname</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">patient</span> <span class="o">=</span> <span class="n">patient</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">recs</span> <span class="o">=</span> <span class="n">recs</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sample</span> <span class="o">=</span> <span class="n">sample</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">sender</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Rec</span><span class="p">:</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>    <span class="n">method</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>    <span class="n">labval</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>    <span class="nb">type</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="sd">         __init__ inits a Rec.</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labval</span> <span class="o">=</span> <span class="n">labval</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="k">class</span><span class="w"> </span><span class="nc">BooleanRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>    <span class="n">value</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="sd">         __init__ inits a BooleanRec.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="k">class</span><span class="w"> </span><span class="nc">NumberRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>    <span class="n">value</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>    <span class="n">unit</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a><span class="sd">         __init__ inits a NumberRec.</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="k">class</span><span class="w"> </span><span class="nc">StringRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>    <span class="n">value</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">         __init__ inits a StringRec.</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DateRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>    <span class="n">value</span><span class="p">:</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">         __init__ inits a DateRec.</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CatalogRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>    <span class="n">values</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>    <span class="n">catalog</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">         __init__ inits a CatalogRec.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="n">catalog</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a><span class="k">class</span><span class="w"> </span><span class="nc">MultiRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>    <span class="n">values</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a><span class="sd">         __init__ inits a MultiRec.</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="k">def</span><span class="w"> </span><span class="nf">idable_csv</span><span class="p">(</span><span class="n">idables</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">idcs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">     idable_csv writes a list of Idables to the given csv file. the given</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a><span class="sd">     idcontainers are included as columns. if no idcontainers are given, all</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">     are included.</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>    <span class="k">if</span> <span class="n">idables</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">idables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># todo throw error?</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no idables&quot;</span><span class="p">)</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">idables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iddict</span><span class="p">(</span><span class="o">*</span><span class="n">idcs</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>        <span class="k">for</span> <span class="n">idable</span> <span class="ow">in</span> <span class="n">idables</span><span class="p">:</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="n">idable</span><span class="o">.</span><span class="n">iddict</span><span class="p">()</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>    <span class="k">return</span> <span class="n">filename</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a><span class="k">class</span><span class="w"> </span><span class="nc">traction</span><span class="p">:</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a><span class="sd">         __init__ takes the db target either as string or dbcq object.</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">cnf</span><span class="o">.</span><span class="n">makeload</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;.traction/settings.yaml&quot;</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">cnf</span><span class="o">.</span><span class="n">home</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;yaml&quot;</span><span class="p">,</span> <span class="n">make</span><span class="o">=</span><span class="n">cnftemplate</span><span class="p">)</span>        
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;no settings.&quot;</span><span class="p">)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>            <span class="k">return</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">dbcq</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">dbcq</span><span class="p">):</span> 
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">target</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;target needs to be string or dbcq instance&quot;</span><span class="p">)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idcinit</span><span class="p">()</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>        <span class="c1">#print(f&quot;_idcoids: {self._idcoids}&quot;)</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">jd</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>            <span class="s2">&quot;sample_to_samplekit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;left join centraxx_samplekititem as samplekititem on samplekititem.tubebarcode = idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn&quot;</span><span class="p">,</span> <span class="s2">&quot;left join centraxx_samplekit as samplekit on samplekit.oid = samplekititem.samplekit&quot;</span><span class="p">],</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>            <span class="s2">&quot;sample_to_parentid&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;left join centraxx_sampleidcontainer parentidc on parentidc.sample = sample.parent and parentidc.idcontainertype=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_idcoid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>            <span class="s2">&quot;sample_to_samplelocation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_samplelocation samplelocation on samplelocation.oid = sample.samplelocation&quot;</span><span class="p">],</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>            <span class="s2">&quot;sample_to_sampletype&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_sampletype as sampletype on sampletype.oid = sample.sampletype&quot;</span><span class="p">],</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>            <span class="s2">&quot;sample_to_stockprocessing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_stockprocessing as stockprocessing on sample.stockprocessing = stockprocessing.oid&quot;</span><span class="p">],</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>            <span class="s2">&quot;sample_to_secondprocessing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_stockprocessing as secondprocessing on sample.secondprocessing = secondprocessing.oid&quot;</span><span class="p">],</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>            <span class="s2">&quot;sample_to_project&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_project as project on sample.project = project.oid&quot;</span><span class="p">],</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>            <span class="s2">&quot;sample_to_patient&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_patientcontainer as patientcontainer on sample.patientcontainer = patientcontainer.oid&quot;</span><span class="p">],</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>            <span class="s2">&quot;sample_to_receptacle&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_samplereceptable as receptable on sample.receptable = receptable.oid&quot;</span><span class="p">],</span> <span class="c1"># receptable seems to be a typo in the table naming</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>            <span class="s2">&quot;sample_to_orga&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_organisationunit as organisationunit on sample.orgunit = organisationunit.oid&quot;</span><span class="p">],</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>            <span class="s2">&quot;sample_to_trial&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_flexistudy as flexistudy on sample.flexistudy = flexistudy.oid&quot;</span><span class="p">]</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>            <span class="p">,</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>            <span class="s2">&quot;patient_to_orga&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_patientorgunit patientorgunit on patientcontainer.oid=patientorgunit.patientcontainer_oid&quot;</span><span class="p">,</span> <span class="s2">&quot;left join centraxx_organisationunit organisationunit on patientorgunit.orgunit_oid=organisationunit.oid&quot;</span><span class="p">],</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>            <span class="s2">&quot;patient_to_trial&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_patientstudy as patientstudy on patientstudy.patientcontainer = patientcontainer.oid&quot;</span><span class="p">,</span> <span class="s2">&quot;left join centraxx_flexistudy as flexistudy on flexistudy.oid = patientstudy.flexistudy&quot;</span><span class="p">],</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>            <span class="s2">&quot;patient_to_sample&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_sample sample on sample.patientcontainer = patientcontainer.oid&quot;</span><span class="p">]</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>        <span class="p">}</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampleids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patientids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parentids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parentoids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">locationpaths</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kitids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cxxkitids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">categories</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">samplingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">receiptdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">derivaldates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">first_repositiondates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">repositiondates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stockprocessingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">secondprocessingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">primaryref</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incl_parents</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incl_childs</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incl_tree</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="p">[],</span> <span class="n">missing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_query</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">raw</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="sd">         sample gets sample(s) and returns them as a list of Sample instances.</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a><span class="sd">         </span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">         pass sampleids and other values to filter for as lists of strings,</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">         e.g. `sampleids=[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]`.</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a><span class="sd">         </span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="sd">         use the idc param to filter for idcontainer lists by passing a dict of</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="sd">         lists keyed by idcontainer code, e.g. `idc={&quot;extsampleid&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]}`.</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">         </span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">         put info that should be joined into the result into the verbose array,</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a><span class="sd">         e.g.  `verbose=[tr.locationpath]`. to join in everything, say</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">         `verbose_all=True`. this is slower than non-verbose.</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a><span class="sd">         </span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a><span class="sd">         pass dates as a tuple of from and to datetime, e.g. `samplingdates=(datefrom, None)`.</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a><span class="sd">         </span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">         to check via like as opposed to exact, put the respective fields into</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a><span class="sd">         the like array, e.g. `like=[tr.locationpath]`.</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>        <span class="c1"># print(&quot;try:&quot; + tr.sampleid)</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>        <span class="n">vaa</span> <span class="o">=</span> <span class="p">[</span><span class="n">cxxkitid</span><span class="p">,</span> <span class="n">kitid</span><span class="p">,</span> <span class="n">locationname</span><span class="p">,</span> <span class="n">locationpath</span><span class="p">,</span> <span class="n">orga</span><span class="p">,</span> <span class="n">parentid</span><span class="p">,</span> 
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>               <span class="n">project</span><span class="p">,</span> <span class="n">receptacle</span><span class="p">,</span> <span class="n">sampletype</span><span class="p">,</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>               <span class="n">secondprocessing</span><span class="p">,</span> <span class="n">stockprocessing</span><span class="p">,</span> <span class="n">trial</span><span class="p">]</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="n">vaa</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">())</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="n">vaa</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sampleidcs</span><span class="p">())</span>                
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concrete_idcs</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="k">if</span> <span class="n">trials</span><span class="p">:</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>        <span class="k">if</span> <span class="n">locationpaths</span><span class="p">:</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">locationpath</span><span class="p">)</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>        <span class="k">if</span> <span class="n">kitids</span><span class="p">:</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kitid</span><span class="p">)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>        <span class="k">if</span> <span class="n">cxxkitid</span><span class="p">:</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cxxkitid</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>        <span class="k">if</span> <span class="n">parentids</span><span class="p">:</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parentid</span><span class="p">)</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>        <span class="k">if</span> <span class="n">verbose_all</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>            <span class="n">verbose</span> <span class="o">=</span> <span class="n">vaa</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">_checkverbose</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="n">vaa</span><span class="p">):</span> 
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>            <span class="k">return</span> <span class="kc">None</span> <span class="c1"># throw error?</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>        <span class="k">if</span> <span class="n">incl_parents</span> <span class="ow">or</span> <span class="n">incl_childs</span> <span class="ow">or</span> <span class="n">incl_tree</span> <span class="ow">or</span> <span class="n">primaryref</span><span class="p">:</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>            <span class="n">verbosepass</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>            <span class="k">if</span> <span class="n">primaryref</span><span class="p">:</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>                <span class="n">verbosepass</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sampleids</span><span class="o">=</span><span class="n">sampleids</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">parentids</span><span class="o">=</span><span class="n">parentids</span><span class="p">,</span> <span class="n">parentoids</span><span class="o">=</span><span class="n">parentoids</span><span class="p">,</span> <span class="n">patientids</span><span class="o">=</span><span class="n">patientids</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">,</span> <span class="n">locationpaths</span><span class="o">=</span><span class="n">locationpaths</span><span class="p">,</span> <span class="n">kitids</span><span class="o">=</span><span class="n">kitids</span><span class="p">,</span> <span class="n">cxxkitids</span><span class="o">=</span><span class="n">cxxkitids</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">samplingdates</span><span class="o">=</span><span class="n">samplingdates</span><span class="p">,</span> <span class="n">receiptdates</span><span class="o">=</span><span class="n">receiptdates</span><span class="p">,</span> <span class="n">derivaldates</span><span class="o">=</span><span class="n">derivaldates</span><span class="p">,</span> <span class="n">first_repositiondates</span><span class="o">=</span><span class="n">first_repositiondates</span><span class="p">,</span> <span class="n">repositiondates</span><span class="o">=</span><span class="n">repositiondates</span><span class="p">,</span> <span class="n">stockprocessingdates</span><span class="o">=</span><span class="n">stockprocessingdates</span><span class="p">,</span> <span class="n">secondprocessingdates</span><span class="o">=</span><span class="n">secondprocessingdates</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbosepass</span><span class="p">,</span> <span class="n">verbose_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="n">missing</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="n">order_by</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span> <span class="n">print_query</span><span class="o">=</span><span class="n">print_query</span><span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>            <span class="k">if</span> <span class="n">primaryref</span><span class="p">:</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>                <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_fill_in_primary</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>                <span class="k">return</span> <span class="n">res</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>            
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>            <span class="n">s_oids</span> <span class="o">=</span> <span class="n">get_ids</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>            <span class="n">withincl</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>            <span class="k">for</span> <span class="n">s_oid</span> <span class="ow">in</span> <span class="n">s_oids</span><span class="p">:</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>               <span class="k">if</span> <span class="n">incl_parents</span><span class="p">:</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>                   <span class="n">p_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_parents</span><span class="p">(</span><span class="n">s_oid</span><span class="p">,</span> <span class="n">p_oids</span><span class="p">)</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">p_oids</span><span class="p">)</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_oid</span><span class="p">)</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>               <span class="k">if</span> <span class="n">incl_childs</span><span class="p">:</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>                   <span class="n">c_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_childs</span><span class="p">(</span><span class="n">s_oid</span><span class="p">,</span> <span class="n">c_oids</span><span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_oid</span><span class="p">)</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c_oids</span><span class="p">)</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>               <span class="k">if</span> <span class="n">incl_tree</span><span class="p">:</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>                   <span class="n">p_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_parents</span><span class="p">(</span><span class="n">s_oid</span><span class="p">,</span> <span class="n">p_oids</span><span class="p">)</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>                   <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_oids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>                       <span class="n">root</span> <span class="o">=</span> <span class="n">p_oids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>                   <span class="k">else</span><span class="p">:</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>                       <span class="n">root</span> <span class="o">=</span> <span class="n">s_oid</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>                   <span class="n">c_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_childs</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">c_oids</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c_oids</span><span class="p">)</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>            <span class="n">withincl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">withincl</span><span class="p">))</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">oids</span><span class="o">=</span><span class="n">withincl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">print_query</span><span class="o">=</span><span class="n">print_query</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span> <span class="c1"># todo pass verbose_all?</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>        <span class="c1"># todo check that self.sidc() is not in idc</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>        <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>           <span class="n">idc</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>        <span class="k">if</span> <span class="n">sampleids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">sampleids</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>        <span class="k">if</span> <span class="n">patientids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">patientids</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>        <span class="n">jselects</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">sampleid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">patientid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>                   
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>            <span class="n">cxxkitid</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplekit.cxxkitid as &#39;</span><span class="si">{</span><span class="n">cxxkitid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>            <span class="c1">#sampleid: [f&quot;sidc.psn as &#39;{sampleid}&#39;&quot;],</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>            <span class="n">parentid</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;parentidc.psn as &#39;</span><span class="si">{</span><span class="n">parentid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>            <span class="n">kitid</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplekit.kitid as &#39;</span><span class="si">{</span><span class="n">kitid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>            <span class="n">locationname</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplelocation.locationid as &#39;</span><span class="si">{</span><span class="n">locationname</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span> 
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>            <span class="n">locationpath</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplelocation.locationpath as &#39;</span><span class="si">{</span><span class="n">locationpath</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>            <span class="n">sampletype</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;sampletype.code as &#39;</span><span class="si">{</span><span class="n">sampletype</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>            <span class="n">stockprocessing</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;stockprocessing.code as &#39;</span><span class="si">{</span><span class="n">stockprocessing</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>            <span class="n">secondprocessing</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;secondprocessing.code as &#39;</span><span class="si">{</span><span class="n">secondprocessing</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>            <span class="n">project</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;project.code as &#39;</span><span class="si">{</span><span class="n">project</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>            <span class="c1">#patientid: [f&quot;patidc.psn as &#39;{patientid}&#39;&quot;],</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>            <span class="n">receptacle</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;receptable.code as &#39;</span><span class="si">{</span><span class="n">receptacle</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;organisationunit.code as &#39;</span><span class="si">{</span><span class="n">orga</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;flexistudy.code as &#39;</span><span class="si">{</span><span class="n">trial</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>        <span class="p">}</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>        <span class="n">lselects</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.amountrest as </span><span class="si">{</span><span class="n">restamount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.appointmentnumber as </span><span class="si">{</span><span class="n">appointment</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.dtype as </span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.oid as </span><span class="si">{</span><span class="n">sampleoid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.parent as </span><span class="si">{</span><span class="n">parentoid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>          <span class="s2">&quot;sample.*&quot;</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>        <span class="p">]</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>        <span class="n">joins</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>            <span class="n">cxxkitid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplekit&quot;</span><span class="p">],</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>            <span class="n">parentid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_parentid&quot;</span><span class="p">],</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>            <span class="n">kitid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplekit&quot;</span><span class="p">],</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>            <span class="n">locationname</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplelocation&quot;</span><span class="p">],</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>            <span class="n">locationpath</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplelocation&quot;</span><span class="p">],</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>            <span class="n">sampletype</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_sampletype&quot;</span><span class="p">],</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>            <span class="n">stockprocessing</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_stockprocessing&quot;</span><span class="p">],</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>            <span class="n">secondprocessing</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_secondprocessing&quot;</span><span class="p">],</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>            <span class="n">project</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_project&quot;</span><span class="p">],</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>            <span class="n">receptacle</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_receptacle&quot;</span><span class="p">],</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_orga&quot;</span><span class="p">],</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_trial&quot;</span><span class="p">]</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>        <span class="p">}</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>        <span class="k">for</span> <span class="n">pidc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">():</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>            <span class="n">joins</span><span class="p">[</span><span class="n">pidc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_patient&quot;</span><span class="p">]</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>        <span class="n">selectstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectstr</span><span class="p">(</span><span class="n">jselects</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">lselects</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>        <span class="n">joinstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joinstr</span><span class="p">(</span><span class="n">joins</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">sampleoids</span><span class="o">=</span><span class="n">oids</span><span class="p">,</span> <span class="n">parentids</span><span class="o">=</span><span class="n">parentids</span><span class="p">,</span> <span class="n">parentoids</span><span class="o">=</span><span class="n">parentoids</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">,</span> <span class="n">locationpaths</span><span class="o">=</span><span class="n">locationpaths</span><span class="p">,</span> <span class="n">kitids</span><span class="o">=</span><span class="n">kitids</span><span class="p">,</span> <span class="n">cxxkitids</span><span class="o">=</span><span class="n">cxxkitids</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">samplingdates</span><span class="o">=</span><span class="n">samplingdates</span><span class="p">,</span> <span class="n">receiptdates</span><span class="o">=</span><span class="n">receiptdates</span><span class="p">,</span> <span class="n">derivaldates</span><span class="o">=</span><span class="n">derivaldates</span><span class="p">,</span> <span class="n">first_repositiondates</span><span class="o">=</span><span class="n">first_repositiondates</span><span class="p">,</span> <span class="n">repositiondates</span><span class="o">=</span><span class="n">repositiondates</span><span class="p">,</span> <span class="n">stockprocessingdates</span><span class="o">=</span><span class="n">stockprocessingdates</span><span class="p">,</span> <span class="n">secondprocessingdates</span><span class="o">=</span><span class="n">secondprocessingdates</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">wherearg</span><span class="o">=</span><span class="n">where</span><span class="p">)</span> 
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>        <span class="n">topstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;select </span><span class="si">{</span><span class="n">topstr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">selectstr</span><span class="si">}</span><span class="s2"> from centraxx_sample sample </span><span class="se">\n</span><span class="si">{</span><span class="n">joinstr</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">where </span><span class="si">{</span><span class="n">wherestr</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>        <span class="k">if</span> <span class="n">order_by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; order by </span><span class="si">{</span><span class="n">order_by</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>        <span class="k">if</span> <span class="n">print_query</span><span class="p">:</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>           <span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>           <span class="nb">print</span><span class="p">(</span><span class="n">whereargs</span><span class="p">)</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>        <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>        <span class="n">sarr</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>            <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>            <span class="c1">#if dig(r, sampleid) is not None:</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>            <span class="c1">#    ids.append(Identifier(id=dig(r, sampleid), code=self.sidc()))</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>            <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sampleidcs</span><span class="p">():</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>                <span class="c1">#print(&quot;idc:&quot; + idc)</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>                <span class="c1">#print(&quot;r:&quot; + str(r))</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>                <span class="k">if</span> <span class="n">idc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">r</span> <span class="ow">and</span> <span class="n">r</span><span class="p">[</span><span class="n">idc</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>                    <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">idc</span><span class="o">.</span><span class="n">lower</span><span class="p">()),</span> <span class="n">code</span><span class="o">=</span><span class="n">idc</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="p">)</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>            <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">sampleoid</span><span class="p">)),</span> <span class="n">code</span><span class="o">=</span><span class="s2">&quot;oid&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># todo rename sampleoid?</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>            <span class="n">pids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>            <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="n">parentoid</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>                <span class="n">pids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">parentoid</span><span class="p">]),</span> <span class="n">code</span><span class="o">=</span><span class="s2">&quot;oid&quot;</span><span class="p">))</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>            <span class="k">if</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">parentid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>                <span class="n">pids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">parentid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()))</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>            <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>                <span class="n">parent</span> <span class="o">=</span> <span class="n">Idable</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">pids</span><span class="p">,</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>            <span class="n">patids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>            <span class="k">if</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">patientid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>   <span class="c1"># todo include patient oid?</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>                <span class="n">patids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">patientid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()))</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>            <span class="n">patient</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">patids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>                <span class="n">patient</span> <span class="o">=</span> <span class="n">Idable</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">patids</span><span class="p">,</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">(</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>                <span class="n">appointment</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">appointment</span><span class="p">),</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>                <span class="n">category</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">category</span><span class="p">),</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>                <span class="n">samplingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">samplingdate</span><span class="p">),</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>                <span class="n">concentration</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">concentration</span><span class="p">),</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>                <span class="n">cxxkitid</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">cxxkitid</span><span class="p">),</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>                <span class="n">derivaldate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">derivaldate</span><span class="p">),</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>                <span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>                <span class="n">initialamount</span><span class="o">=</span><span class="n">Amount</span><span class="p">(</span><span class="n">floatornull</span><span class="p">(</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">initialamount</span><span class="p">)),</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">initialunit</span><span class="p">)),</span> <span class="c1"># apparently the cast to float is explicitly needed</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>                <span class="n">kitid</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">kitid</span><span class="p">),</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>                <span class="n">locationpath</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">locationpath</span><span class="p">),</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>                <span class="n">locationname</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">locationname</span><span class="p">),</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>                <span class="n">orga</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">orga</span><span class="p">),</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>                <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>                <span class="n">patient</span><span class="o">=</span><span class="n">patient</span><span class="p">,</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>                <span class="n">project</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">project</span><span class="p">),</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>                <span class="n">receiptdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">receiptdate</span><span class="p">),</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>                <span class="n">receptacle</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">receptacle</span><span class="p">),</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>                <span class="n">repositiondate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">repositiondate</span><span class="p">),</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>                <span class="n">restamount</span><span class="o">=</span><span class="n">Amount</span><span class="p">(</span><span class="n">floatornull</span><span class="p">(</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">restamount</span><span class="p">)),</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">restunit</span><span class="p">)),</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>                <span class="n">secondprocessing</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">secondprocessing</span><span class="p">),</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>                <span class="n">secondprocessingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">secondprocessingdate</span><span class="p">),</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>                <span class="n">sidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">(),</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>                <span class="n">stockprocessing</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">stockprocessing</span><span class="p">),</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>                <span class="n">stockprocessingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">stockprocessingdate</span><span class="p">),</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>                <span class="n">trial</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">trial</span><span class="p">),</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>                <span class="nb">type</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">sampletype</span><span class="p">),</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>                <span class="n">xposition</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">xposition</span><span class="p">),</span> 
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>                <span class="n">yposition</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">yposition</span><span class="p">)</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>            <span class="p">)</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>            <span class="n">sarr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>        <span class="k">return</span> <span class="n">sarr</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a><span class="sd">         _get_parents collects the parent sample oids of a sample in the `out`</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a><span class="sd">         list, in order from root to leaf. take oids to include aliquotgroups,</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="sd">         they don&#39;t necessarily have an idcontainer attached to them.</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="s2">&quot;select parent from centraxx_sample where oid = ?&quot;</span><span class="p">,</span> <span class="n">oid</span><span class="p">)</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>        <span class="n">pid</span> <span class="o">=</span> <span class="n">dig</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;parent&quot;</span><span class="p">)</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>        <span class="k">if</span> <span class="n">pid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>            <span class="n">out</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_get_parents</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_childs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a><span class="sd">         _get_childs collects the oids of the sample&#39;s children in the `out`</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a><span class="sd">         list, in order from root-to-leaf. take oids to include aliquotgroups.</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="s2">&quot;select oid from centraxx_sample where parent = ?&quot;</span><span class="p">,</span> <span class="n">oid</span><span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">[</span><span class="s2">&quot;oid&quot;</span><span class="p">])</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_get_childs</span><span class="p">(</span><span class="n">child</span><span class="p">[</span><span class="s2">&quot;oid&quot;</span><span class="p">],</span> <span class="n">out</span><span class="p">)</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">patient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patientids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sampleids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orgas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="p">[],</span> <span class="n">order_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_query</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">raw</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a><span class="sd">         patient gets patients and returns them as a list of Patient instances.</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="sd">         </span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">         the parameters work analog to the sample method.</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>        <span class="n">vaa</span> <span class="o">=</span> <span class="p">[</span><span class="n">orga</span><span class="p">]</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>        <span class="n">vaa</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">())</span>        
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concrete_idcs</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>        <span class="k">if</span> <span class="n">verbose_all</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>            <span class="n">verbose</span> <span class="o">=</span> <span class="n">vaa</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>        <span class="n">silent</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>        <span class="k">if</span> <span class="n">trials</span><span class="p">:</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>            <span class="n">silent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>        <span class="k">if</span> <span class="n">orgas</span><span class="p">:</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>            <span class="n">silent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orga</span><span class="p">)</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">_checkverbose</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="n">vaa</span><span class="p">):</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>            <span class="k">return</span> <span class="kc">None</span> <span class="c1"># throw error?</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>        <span class="c1"># todo check that self.sidc() is not in idc</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>        <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>           <span class="n">idc</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>        <span class="k">if</span> <span class="n">sampleids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">sampleids</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>        <span class="k">if</span> <span class="n">patientids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">patientids</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>           
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>        <span class="n">selects</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">patientid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;organisationunit.code as &#39;</span><span class="si">{</span><span class="n">orga</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;flexistudy.code as &#39;</span><span class="si">{</span><span class="n">trial</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>        <span class="p">}</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>        <span class="n">joins</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;patient_to_orga&quot;</span><span class="p">],</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;patient_to_trial&quot;</span><span class="p">]</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="p">}</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>        <span class="k">for</span> <span class="n">sidc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sampleidcs</span><span class="p">():</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>            <span class="n">joins</span><span class="p">[</span><span class="n">sidc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;patient_to_sample&quot;</span><span class="p">]</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>        <span class="n">selectstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectstr</span><span class="p">(</span><span class="n">selects</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;patientcontainer.*&quot;</span><span class="p">],</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>        <span class="n">joinstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joinstr</span><span class="p">(</span><span class="n">joins</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">+</span> <span class="n">silent</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">)</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>        <span class="c1">#print(whereargs)</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>        <span class="n">topstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;select distinct </span><span class="si">{</span><span class="n">topstr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">selectstr</span><span class="si">}</span><span class="s2"> from centraxx_patientcontainer patientcontainer </span><span class="se">\n</span><span class="si">{</span><span class="n">joinstr</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">where </span><span class="si">{</span><span class="n">wherestr</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>        <span class="k">if</span> <span class="n">order_by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; order by </span><span class="si">{</span><span class="n">order_by</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>        <span class="k">if</span> <span class="n">print_query</span><span class="p">:</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>           <span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>        <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>            <span class="k">return</span> <span class="n">raw</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>        <span class="n">pats</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>            <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">patientid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span> <span class="p">]</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>            <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">():</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>                <span class="k">if</span> <span class="n">idc</span> <span class="ow">in</span> <span class="n">r</span> <span class="ow">and</span> <span class="n">r</span><span class="p">[</span><span class="n">idc</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>                    <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">idc</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="n">idc</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="p">)</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>            <span class="n">pat</span> <span class="o">=</span> <span class="n">Patient</span><span class="p">(</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>              <span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>              <span class="n">orga</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">orga</span><span class="p">),</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>              <span class="n">pidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>            <span class="p">)</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>            <span class="n">pats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>        <span class="k">return</span> <span class="n">pats</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">trial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">         trial gives trials.</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;select code from centraxx_flexistudy&quot;</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">finding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampleids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patientids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose_all</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">print_query</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">raw</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="sd">         finding gets the laborfindings (&quot;messbefund&quot; / &quot;begleitschein&quot;) for</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a><span class="sd">         sampleids or method.  it returns a list of Finding instances.</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a><span class="sd">         </span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="sd">         you can pass these to verbose: tr.patientid  // maybe also tr.values?</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concrete_idcs</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>        <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>           <span class="n">idc</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>        <span class="c1"># todo check that self.sidc() is not in idc</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>        <span class="k">if</span> <span class="n">sampleids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">sampleids</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>        <span class="k">if</span> <span class="n">patientids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">patientids</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>        <span class="n">selects</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">sampleid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">patientid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>                   
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>        <span class="p">}</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>        <span class="n">idcselectstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectstr</span><span class="p">(</span><span class="n">selects</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="p">[],</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>        <span class="n">joins</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>        <span class="k">for</span> <span class="n">pidc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">():</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>            <span class="n">joins</span><span class="p">[</span><span class="n">pidc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_patient&quot;</span><span class="p">]</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>        <span class="n">idcjoinstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joinstr</span><span class="p">(</span><span class="n">joins</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select laborfinding.oid as &quot;laborfinding_oid&quot;, laborfinding.*, labormethod.code as </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">idcselectstr</span><span class="si">}</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="s2">        from centraxx_laborfinding as laborfinding</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="s2">        -- go from laborfinding to sample</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a><span class="s2">        left join centraxx_labormethod as labormethod on laborfinding.labormethod = labormethod.oid</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a><span class="s2">        left join centraxx_labormapping as labormapping on labormapping.laborfinding = laborfinding.oid</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="s2">        left join centraxx_sample sample on labormapping.relatedoid = sample.oid</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="s2">        </span><span class="si">{</span><span class="n">idcjoinstr</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="n">methods</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">)</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; where &quot;</span> <span class="o">+</span> <span class="n">wherestr</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>        <span class="k">if</span> <span class="n">print_query</span><span class="p">:</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">whereargs</span><span class="p">)</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">finding</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>            <span class="k">if</span> <span class="n">values</span> <span class="o">!=</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># todo put this outside of the loop?</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>                <span class="k">continue</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select recordedvalue.*, laborvalue.code as laborvalue_code, laborvalue.dtype as laborvalue_type, laborvalue.custom_catalog as laborvalue_catalog_oid, unit.code as laborvalue_unit</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a><span class="s2">                from centraxx_laborfinding as laborfinding</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a><span class="s2">                -- go from laborfinding to recorded value</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a><span class="s2">                join centraxx_labfindinglabval as labfindinglabval on labfindinglabval.laborfinding = laborfinding.oid</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a><span class="s2">                join centraxx_recordedvalue as recordedvalue on labfindinglabval.oid = recordedvalue.oid</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="s2">                --go from labfindinglabval to the laborvalue for the messparam</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a><span class="s2">                join centraxx_laborvalue laborvalue on labfindinglabval.laborvalue = laborvalue.oid</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="s2">                --go from laborvalue to unit</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="s2">                left join centraxx_unity unit on laborvalue.unit = unit.oid</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a><span class="s2">                where laborfinding.oid = ?</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a><span class="s2">            &quot;&quot;&quot;</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>            <span class="n">recvals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">finding</span><span class="p">[</span><span class="s1">&#39;laborfinding_oid&#39;</span><span class="p">])</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>            <span class="n">valsbycode</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>            <span class="k">for</span> <span class="n">recval</span> <span class="ow">in</span> <span class="n">recvals</span><span class="p">:</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>              <span class="n">valsbycode</span><span class="p">[</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_rec</span><span class="p">(</span><span class="n">recval</span><span class="p">,</span> <span class="n">finding</span><span class="p">)</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>            <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">valsbycode</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>        <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>            <span class="k">return</span> <span class="n">results</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>        <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>            <span class="n">finding</span> <span class="o">=</span> <span class="n">Finding</span><span class="p">(</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>                <span class="n">findingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;findingdate&quot;</span><span class="p">),</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>                <span class="n">method</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>                <span class="n">methodname</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;shortname&quot;</span><span class="p">],</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>                <span class="n">patient</span><span class="o">=</span><span class="n">Idable</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">patientid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">(),</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span> <span class="k">if</span> <span class="n">dig</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">patientid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> 
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>                <span class="n">recs</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;values&quot;</span> <span class="ow">in</span> <span class="n">res</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="c1"># todo None ok?</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>                <span class="n">sample</span><span class="o">=</span><span class="n">Idable</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="n">sampleid</span><span class="p">],</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">(),</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()),</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>                <span class="n">sender</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>            <span class="p">)</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>            <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>        <span class="k">return</span> <span class="n">findings</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a><span class="sd">         method (messprofil) gets method(s) and their labvals (messparameter).</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select laborvalue.*, labormethod.code as &quot;method&quot;</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a><span class="s2">from centraxx_labormethod labormethod</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a><span class="s2">inner join centraxx_crftemplate crf_t</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a><span class="s2">    on labormethod.crf_template=crf_t.oid</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a><span class="s2">inner join centraxx_crftempsection crf_ts</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a><span class="s2">    on crf_t.oid=crf_ts.crftemplate</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a><span class="s2">inner join centraxx_crftempsection_fields crf_tsf</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="s2">    on crf_ts.oid=crf_tsf.crftempsection_oid</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a><span class="s2">inner join centraxx_crftempfield crf_tf</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a><span class="s2">    on crf_tsf.crftempfield_oid=crf_tf.oid</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="s2">inner join centraxx_laborvalue laborvalue</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="s2">    on crf_tf.laborvalue=laborvalue.oid&quot;&quot;&quot;</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">methods</span><span class="o">=</span><span class="n">methods</span><span class="p">)</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>        <span class="k">if</span> <span class="n">wherestr</span><span class="p">:</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>          <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; where &quot;</span> <span class="o">+</span> <span class="n">wherestr</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>        <span class="c1"># print(query)</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>          <span class="n">mc</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>          <span class="k">if</span> <span class="n">mc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>            <span class="n">out</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>          <span class="k">del</span> <span class="n">row</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>          <span class="n">out</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>        
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lang</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ml_table</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">         name gives the multilingual names for a code or all codes in a table.</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">         </span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a><span class="sd">         the result is keyed by code and language like this:</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">         </span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a><span class="sd">         </span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="sd">         &quot;NUM_NMR_ISOLEUCINE_VALUE&quot;: {  </span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">            &quot;de&quot;: &quot;Isoleucin&quot;,  </span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a><span class="sd">            &quot;en&quot;: &quot;Isoleucine&quot;  </span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">         }</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a><span class="sd">         </span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="sd">         </span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a><span class="sd">         table: the name of the centraxx table without centraxx_ prefix  </span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a><span class="sd">         code: a specific code, if none given, all code - name mappings for table are given  </span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a><span class="sd">         lang: de|en  </span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a><span class="sd">         ml_table: if the name of the table connecting to multilingualentry is not simlpy the queried table name followed by &quot;_ml_name&quot;, give the connecting table&#39;s name here. eg: name(&#39;laborvaluegroup&#39;, ..., ml_name=&#39;labval_grp_ml_name&#39;)  </span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;select [&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;].code, multilingual.value as name, multilingual.lang as lang&quot;</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; from [centraxx_&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;] as [&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>        <span class="n">ml_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>        <span class="k">if</span> <span class="n">ml_table</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># the name is different</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>            <span class="n">ml_name</span> <span class="o">=</span> <span class="s2">&quot;centraxx_&quot;</span> <span class="o">+</span> <span class="n">ml_table</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>        <span class="k">else</span><span class="p">:</span> <span class="c1"># the name is the same</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>            <span class="n">ml_name</span> <span class="o">=</span> <span class="s2">&quot;centraxx_&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;_ml_name&quot;</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; inner join [&quot;</span> <span class="o">+</span> <span class="n">ml_name</span> <span class="o">+</span> <span class="s2">&quot;] mlname on mlname.related_oid = [&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;].oid&quot;</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; inner join centraxx_multilingualentry multilingual on mlname.oid = multilingual.oid&quot;</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>        <span class="n">wherestrings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>        <span class="k">if</span> <span class="n">code</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>            <span class="n">wherestrings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_whereparam</span><span class="p">(</span><span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;].code&quot;</span><span class="p">))</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>        <span class="k">if</span> <span class="n">lang</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>            <span class="n">wherestrings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_whereparam</span><span class="p">(</span><span class="s2">&quot;multilingual.lang&quot;</span><span class="p">))</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wherestrings</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; where &quot;</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>            <span class="c1"># join where clauses by and</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; and &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wherestrings</span><span class="p">)</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>        <span class="c1"># print(query)</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>            <span class="n">lang</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="s2">&quot;lang&quot;</span><span class="p">]</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>               <span class="n">out</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>            <span class="n">out</span><span class="p">[</span><span class="n">code</span><span class="p">][</span><span class="n">lang</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sidc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">         sidc returns the main idc code by which samples are referenced as</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">         specified in the settings. </span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;sampleid&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pidc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;patientid&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_selectstr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selects</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">selecta</span><span class="p">,</span> <span class="n">idc</span><span class="p">):</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a><span class="sd">         _selectstr filters the selects by the verbose array and returns the</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a><span class="sd">         sql select string. selecta is for fields that should be selected</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a><span class="sd">         regardless if they&#39;re in the verbose array or not.</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a><span class="sd">         </span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a><span class="sd">         the idc argument assumes that the sample table is joined it. // todo is this still true?</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>        <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">selects</span><span class="p">:</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>                <span class="k">continue</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">selects</span><span class="p">[</span><span class="n">verb</span><span class="p">]:</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>                <span class="n">selecta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>        <span class="n">selecta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_append_idc_select</span><span class="p">(</span><span class="n">selecta</span><span class="p">,</span> <span class="n">idc</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>        <span class="n">selectstr</span> <span class="o">=</span> <span class="s2">&quot;, </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selecta</span><span class="p">)</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>        <span class="k">return</span> <span class="n">selectstr</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_joinstr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">idc</span><span class="p">):</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a><span class="sd">         _joinstr puts together the joins needed by verbose array and idc keys</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a><span class="sd">         and returns the sql join string.</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>        <span class="n">joina</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>        <span class="n">joina</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_append_idc_join</span><span class="p">(</span><span class="n">joina</span><span class="p">,</span> <span class="n">idc</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">joins</span><span class="p">)</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>        <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span> 
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">:</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>                <span class="k">continue</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">[</span><span class="n">verb</span><span class="p">]:</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">joina</span><span class="p">:</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>                    <span class="n">joina</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>        <span class="n">joinstr</span> <span class="o">=</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">joina</span><span class="p">)</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>        <span class="k">return</span> <span class="n">joinstr</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_append_idc_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selecta</span><span class="p">,</span> <span class="n">idc</span><span class="p">,</span> <span class="n">verbose</span><span class="p">):</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a><span class="sd">         _append_idc_select adds the sql select statements for an idc dict.</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>        <span class="n">idca</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>        <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>          <span class="k">if</span> <span class="n">verb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;idc&quot;</span><span class="p">]:</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>            <span class="n">idca</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">verb</span><span class="p">)</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">idca</span><span class="p">:</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>          <span class="n">selectstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>          <span class="k">if</span> <span class="ow">not</span> <span class="n">selectstr</span> <span class="ow">in</span> <span class="n">selecta</span><span class="p">:</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>            <span class="n">selecta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selectstr</span><span class="p">)</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>        <span class="k">return</span> <span class="n">selecta</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_append_idc_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joina</span><span class="p">,</span> <span class="n">idc</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">joins</span><span class="p">):</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a><span class="sd">         _append_idc_join adds the sql join statements for an idc dict.</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>        <span class="n">idca</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>        <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>          <span class="k">if</span> <span class="n">verb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;idc&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">verb</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span> <span class="ow">or</span> <span class="n">verb</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">():</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>            <span class="n">idca</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">verb</span><span class="p">)</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>        <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>          <span class="n">idca</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">idc</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">idca</span><span class="p">:</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>          <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">:</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>              <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">joina</span><span class="p">:</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>                <span class="n">joina</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>          <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SAMPLE&quot;</span><span class="p">:</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>            <span class="n">joinstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;left join centraxx_sampleidcontainer as idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> on idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.sample = sample.oid and idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.idcontainertype = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_idcoid</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>    
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">joinstr</span> <span class="ow">in</span> <span class="n">joina</span><span class="p">:</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>              <span class="n">joina</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">joinstr</span><span class="p">)</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>          <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;PATIENT&quot;</span><span class="p">:</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>            <span class="n">joinstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;left join centraxx_idcontainer as idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> on idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.patientcontainer = patientcontainer.oid and idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.idcontainertype = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_idcoid</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">joinstr</span> <span class="ow">in</span> <span class="n">joina</span><span class="p">:</span> <span class="c1"># neccessary?</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>              <span class="n">joina</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">joinstr</span><span class="p">)</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>          <span class="k">else</span><span class="p">:</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error: idcontainer kind </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="si">}</span><span class="s2"> not supported.&quot;</span><span class="p">)</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>        <span class="k">return</span> <span class="n">joina</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_where</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="p">{},</span> <span class="n">sampleoids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parentids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parentoids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patientids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">locationpaths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kitids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cxxkitids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">samplingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">receiptdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">derivaldates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">first_repositiondates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">repositiondates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stockprocessingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">secondprocessingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span> <span class="n">wherearg</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> <span class="c1"># -&gt; (str, [])</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="sd">         _where returns the wherestring and args array for the provided</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a><span class="sd">         arguments (that are not None).</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a><span class="sd">         </span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a><span class="sd">         the user needs to make sure that whatever is referenced here is joined</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="sd">         into the query before.</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a><span class="sd">         </span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a><span class="sd">         the names are assumed to be the tr constants, like</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a><span class="sd">         e.g. tr.sampleid. like is an array of tr constants of the arguments</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a><span class="sd">         for which it checks likeness. we only check likeness for the first</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="sd">         passed string of an argument array. if for example</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a><span class="sd">         like=[tr.locationpath], it checks likeness of locationpaths[0].</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a><span class="sd">         </span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a><span class="sd">         make sure only one of sampleids or extsampleids is passed?</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>        <span class="n">wheredict</span> <span class="o">=</span> <span class="p">{</span> 
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>          <span class="n">trial</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">trials</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;flexistudy.code&quot;</span> <span class="p">},</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>          <span class="n">locationpath</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">locationpaths</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;samplelocation.locationpath&quot;</span> <span class="p">},</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>          <span class="n">method</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">methods</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;labormethod.code&quot;</span> <span class="p">},</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>          <span class="n">kitid</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">kitids</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;samplekit.kitid&quot;</span> <span class="p">},</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>          <span class="n">cxxkitid</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">cxxkitids</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;samplekit.cxxkitid&quot;</span> <span class="p">},</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>          <span class="n">category</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">categories</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.dtype&quot;</span> <span class="p">},</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>          <span class="n">parentid</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">parentids</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;parentidc.psn&quot;</span> <span class="p">},</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>          <span class="n">parentoid</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">parentoids</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.parent&quot;</span> <span class="p">},</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>          <span class="n">sampleoid</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">sampleoids</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.oid&quot;</span> <span class="p">},</span>          
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>          <span class="n">samplingdate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">samplingdates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.samplingdate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>          <span class="n">receiptdate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">receiptdates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.receiptdate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>          <span class="n">derivaldate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">derivaldates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.derivaldate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>          <span class="n">first_repositiondate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">first_repositiondates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.first_repositiondate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>          <span class="n">repositiondate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">repositiondates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.repositiondate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>          <span class="n">stockprocessingdate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">stockprocessingdates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.stockprocessingdate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>          <span class="n">secondprocessingdate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">secondprocessingdates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.secondprocessingdate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">}</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>        <span class="p">}</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>        <span class="n">idckeys</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">idc</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>        <span class="n">idca</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">idckeys</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;idc&quot;</span><span class="p">]))</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">idca</span><span class="p">:</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>            <span class="n">wheredict</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>                                <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">idc</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">idc</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>                                <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.psn&quot;</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>                             <span class="p">}</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>        <span class="p">(</span><span class="n">wherearr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wherebuild</span><span class="p">(</span><span class="n">wheredict</span><span class="p">,</span> <span class="n">like</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>        <span class="n">wherestr</span> <span class="o">=</span> <span class="s2">&quot; and &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wherearr</span><span class="p">)</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>        <span class="k">if</span> <span class="n">wherearg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>           <span class="n">wherestr</span> <span class="o">+=</span> <span class="s2">&quot; and (&quot;</span> <span class="o">+</span> <span class="n">wherearg</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_wherebuild</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wheredict</span><span class="p">,</span> <span class="n">likearr</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[]):</span> <span class="c1"># ([]string, [])</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="sd">         _wherebuild builds wherestrings and fills whereargs.</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>        <span class="n">wherestrs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>        <span class="n">whereargs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span> <span class="ow">in</span> <span class="n">wheredict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>            <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>                <span class="k">continue</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>            <span class="k">if</span> <span class="n">likearr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">likearr</span><span class="p">:</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>                <span class="c1"># put in an or-chain of like checks over all elements</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>                <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wherelikes</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]))</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>                <span class="n">wherestrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>                <span class="n">whereargs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">])</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>            <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">row</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>                <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NULL&#39;</span><span class="p">:</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>                    <span class="n">wherestrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; is NULL)&quot;</span><span class="p">)</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>                    <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(CAST(&quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; as date) between ISNULL(?, &quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;) and ISNULL(?, &quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;))&quot;</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>                    <span class="n">wherestrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>                    <span class="n">whereargs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">])</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>                <span class="n">wherestr</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>                <span class="n">needsor</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>                <span class="k">if</span> <span class="s1">&#39;NULL&#39;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]:</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>                    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;NULL&quot;</span><span class="p">)</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>                    <span class="n">wherestr</span> <span class="o">+=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; is NULL&quot;</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>                    <span class="n">needsor</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>                    <span class="k">if</span> <span class="n">needsor</span><span class="p">:</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>                        <span class="n">wherestr</span> <span class="o">+=</span> <span class="s2">&quot; or &quot;</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>                    <span class="n">placeholder</span> <span class="o">=</span> <span class="n">traction</span><span class="o">.</span><span class="n">_sqlinplaceholder</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]))</span> <span class="c1"># todo put in package? tr._sqlinplaceholder</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>                    <span class="n">wherestr</span> <span class="o">+=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; in &quot;</span> <span class="o">+</span> <span class="n">placeholder</span> <span class="c1"># e.g. samplelocation.locationpath in (?, ?, ?)</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>                <span class="n">wherestr</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>                <span class="n">wherestrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wherestr</span><span class="p">)</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>                <span class="n">whereargs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">])</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">wherestrs</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_sqlinplaceholder</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="sd">         _sqlinplaceholder returns a string like (?, ?, ?, ? ...) with n question marks for sql in.</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>        <span class="c1"># put this in a package sqlutil?</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>            <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;?&quot;</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>                <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>        <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_whereparam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">like</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a><span class="sd">         _whereparam gives a ?-parameterized sql where expression for name</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a><span class="sd">         equal or like parameter for use in queries.</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>        <span class="k">if</span> <span class="n">like</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">like</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>            <span class="k">return</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; = ?&quot;</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>            <span class="k">return</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; like &#39;%&#39; + ? + &#39;%&#39;&quot;</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_wherelike</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">         _wherelike gives a ?-parameterized sql where like expression.</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>        <span class="k">return</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; like &#39;%&#39; + ? + &#39;%&#39;&quot;</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_wherelikes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">         _wherelikes gives a ?-parameterized sql of or-joined where-like</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a><span class="sd">         expressions, as many as given n.</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>            <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span> <span class="o">+</span> <span class="s2">&quot; like &#39;%&#39; + ? + &#39;%&#39;&quot;</span><span class="p">)</span> <span class="c1"># the sql takes literal plusses like here</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>        <span class="k">return</span> <span class="s2">&quot; or &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_top</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">):</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a><span class="sd">         _top returns the top string, for, e.g. `select top 100 * from table`, if</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a><span class="sd">         top is None return an empty string.</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>        <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>           <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;top </span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_idcinit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a><span class="sd">         _idcinit makes a mapping of idcontainers from their code (lower-case) to respective oid and kind.</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;select code, oid, kind from centraxx_idcontainertype&quot;</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idcoid</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">_idcoid</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;oid&quot;</span><span class="p">]</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_rec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recval</span><span class="p">,</span> <span class="n">finding</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rec</span><span class="p">:</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">         _make_rec makes a recorded value instance from db results.</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>        <span class="n">out</span><span class="p">:</span><span class="n">Rec</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>        <span class="k">if</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;BOOLEAN&quot;</span><span class="p">:</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>            <span class="n">val</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;boolvalue&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">BooleanRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">val</span><span class="p">)</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;DECIMAL&quot;</span><span class="p">:</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>            <span class="c1">#print(recval[&quot;laborvalue_code&quot;])</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>            <span class="c1">#print(recval)</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;numericvalue&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;numericvalue&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">NumberRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_unit&quot;</span><span class="p">])</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;STRING&quot;</span> <span class="ow">or</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;LONGSTRING&quot;</span><span class="p">:</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">StringRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;stringvalue&quot;</span><span class="p">])</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;DATE&quot;</span><span class="p">:</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">DateRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;datevalue&quot;</span><span class="p">])</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;LONGDATE&quot;</span><span class="p">:</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">DateRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;datevalueprecision&quot;</span><span class="p">])</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CATALOG&quot;</span><span class="p">:</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>            <span class="c1"># get the catalog code</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select catalog.code as &#39;catalog_code&#39; from centraxx_catalog as catalog</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a><span class="s2">            where catalog.oid = ?&quot;&quot;&quot;</span> <span class="c1"># do this once for all catalogs on startup or finding() call?</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">recval</span><span class="p">[</span><span class="s1">&#39;laborvalue_catalog_oid&#39;</span><span class="p">])</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>            <span class="n">catalog_code</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;catalog_code&quot;</span><span class="p">]</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>            <span class="c1"># get the catalog entries</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select catalogentry.code as &#39;catalogentry_code&#39; from centraxx_recordedvalue as recordedvalue</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a><span class="s2">            join centraxx_recordedval_catentry as recordedval_catentry on recordedval_catentry.recordedvalue_oid = recordedvalue.oid</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a><span class="s2">            join centraxx_catalogentry as catalogentry on catalogentry.oid = recordedval_catentry.catalogentry_oid</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a><span class="s2">            where recordedvalue.oid = ?&quot;&quot;&quot;</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">recval</span><span class="p">[</span><span class="s1">&#39;oid&#39;</span><span class="p">])</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>            <span class="n">entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;catalogentry_code&quot;</span><span class="p">])</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>            
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">CatalogRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">catalog</span><span class="o">=</span><span class="n">catalog_code</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">entries</span><span class="p">)</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ENUMERATION&quot;</span> <span class="ow">or</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OPTIONGROUP&quot;</span><span class="p">:</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select usageentry.code as &#39;usageentry_code&#39; from centraxx_recordedvalue as recordedvalue</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="s2">            join centraxx_recordedval_usagentry as recordedval_usagentry on recordedval_usagentry.recordedvalue_oid = recordedvalue.oid</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="s2">            join centraxx_usageentry as usageentry on usageentry.oid = recordedval_usagentry.usageentry_oid</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a><span class="s2">            where recordedvalue.oid = ?&quot;&quot;&quot;</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">recval</span><span class="p">[</span><span class="s1">&#39;oid&#39;</span><span class="p">])</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>            <span class="n">entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;usageentry_code&quot;</span><span class="p">])</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>            
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">MultiRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="n">entries</span><span class="p">)</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no record class for laborvalue of type </span><span class="si">{</span><span class="n">recval</span><span class="p">[</span><span class="s1">&#39;laborvalue_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_sampleidcs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a><span class="sd">         _sampleidcs returns the idcs from settings that are specific for sample.</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">         </span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">         rather make this a section in conf?</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="sd">         </span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a><span class="sd">         # idc holds idcontainer codes that should be queryable as command line flags </span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">         idc:</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a><span class="sd">           sample:</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a><span class="sd">             - extsampleid</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a><span class="sd">             - modul</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a><span class="sd">             - tier</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="sd">           patient:</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a><span class="sd">             - mpi</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>        <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;idc&quot;</span><span class="p">]:</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>            <span class="k">if</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">idc</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SAMPLE&quot;</span><span class="p">:</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idc</span><span class="p">)</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>        <span class="c1"># include the main sample idcontainer</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_patientidcs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>        <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;idc&quot;</span><span class="p">]:</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>            <span class="k">if</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">idc</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;PATIENT&quot;</span><span class="p">:</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idc</span><span class="p">)</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>        <span class="c1"># include the main patient idcontainer</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_concrete_idcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="p">):</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>        <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>            <span class="k">if</span> <span class="n">verb</span> <span class="o">==</span> <span class="n">patientid</span><span class="p">:</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>            <span class="k">elif</span> <span class="n">verb</span> <span class="o">==</span> <span class="n">sampleid</span><span class="p">:</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">verb</span><span class="p">)</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>    
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_fill_in_primary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">:</span><span class="n">Sample</span><span class="p">):</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a><span class="sd">         _fill_in_primary adds a reference to the given sample&#39;s primary sample,</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a><span class="sd">         if there is one.</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>        <span class="n">poids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_get_parents</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="s2">&quot;oid&quot;</span><span class="p">),</span> <span class="n">poids</span><span class="p">)</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">poids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>            <span class="n">primary_oid</span> <span class="o">=</span> <span class="n">poids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>            <span class="n">primary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">oids</span><span class="o">=</span><span class="p">[</span><span class="n">primary_oid</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>            <span class="n">sample</span><span class="o">.</span><span class="n">primary</span> <span class="o">=</span> <span class="n">Idable</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">primary</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span> <span class="n">mainidc</span><span class="o">=</span><span class="n">primary</span><span class="o">.</span><span class="n">mainidc</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="appointment">
                    <div class="attr variable">
            <span class="name">appointment</span>        =
<span class="default_value">&#39;appointment&#39;</span>

        
    </div>
    <a class="headerlink" href="#appointment"></a>
    
    

                </section>
                <section id="cxxkitid">
                    <div class="attr variable">
            <span class="name">cxxkitid</span>        =
<span class="default_value">&#39;cxxkitid&#39;</span>

        
    </div>
    <a class="headerlink" href="#cxxkitid"></a>
    
    

                </section>
                <section id="samplingdate">
                    <div class="attr variable">
            <span class="name">samplingdate</span>        =
<span class="default_value">&#39;samplingdate&#39;</span>

        
    </div>
    <a class="headerlink" href="#samplingdate"></a>
    
    

                </section>
                <section id="concentration">
                    <div class="attr variable">
            <span class="name">concentration</span>        =
<span class="default_value">&#39;concentration&#39;</span>

        
    </div>
    <a class="headerlink" href="#concentration"></a>
    
    

                </section>
                <section id="derivaldate">
                    <div class="attr variable">
            <span class="name">derivaldate</span>        =
<span class="default_value">&#39;derivaldate&#39;</span>

        
    </div>
    <a class="headerlink" href="#derivaldate"></a>
    
    

                </section>
                <section id="category">
                    <div class="attr variable">
            <span class="name">category</span>        =
<span class="default_value">&#39;category&#39;</span>

        
    </div>
    <a class="headerlink" href="#category"></a>
    
    

                </section>
                <section id="initialamount">
                    <div class="attr variable">
            <span class="name">initialamount</span>        =
<span class="default_value">&#39;initialamount&#39;</span>

        
    </div>
    <a class="headerlink" href="#initialamount"></a>
    
    

                </section>
                <section id="initialunit">
                    <div class="attr variable">
            <span class="name">initialunit</span>        =
<span class="default_value">&#39;initialunit&#39;</span>

        
    </div>
    <a class="headerlink" href="#initialunit"></a>
    
    

                </section>
                <section id="first_repositiondate">
                    <div class="attr variable">
            <span class="name">first_repositiondate</span>        =
<span class="default_value">&#39;first_repositiondate&#39;</span>

        
    </div>
    <a class="headerlink" href="#first_repositiondate"></a>
    
    

                </section>
                <section id="method">
                    <div class="attr variable">
            <span class="name">method</span>        =
<span class="default_value">&#39;method&#39;</span>

        
    </div>
    <a class="headerlink" href="#method"></a>
    
    

                </section>
                <section id="kitid">
                    <div class="attr variable">
            <span class="name">kitid</span>        =
<span class="default_value">&#39;kitid&#39;</span>

        
    </div>
    <a class="headerlink" href="#kitid"></a>
    
    

                </section>
                <section id="locationname">
                    <div class="attr variable">
            <span class="name">locationname</span>        =
<span class="default_value">&#39;locationname&#39;</span>

        
    </div>
    <a class="headerlink" href="#locationname"></a>
    
    

                </section>
                <section id="locationpath">
                    <div class="attr variable">
            <span class="name">locationpath</span>        =
<span class="default_value">&#39;locationpath&#39;</span>

        
    </div>
    <a class="headerlink" href="#locationpath"></a>
    
    

                </section>
                <section id="orga">
                    <div class="attr variable">
            <span class="name">orga</span>        =
<span class="default_value">&#39;orga&#39;</span>

        
    </div>
    <a class="headerlink" href="#orga"></a>
    
    

                </section>
                <section id="parentid">
                    <div class="attr variable">
            <span class="name">parentid</span>        =
<span class="default_value">&#39;parentid&#39;</span>

        
    </div>
    <a class="headerlink" href="#parentid"></a>
    
    

                </section>
                <section id="parentoid">
                    <div class="attr variable">
            <span class="name">parentoid</span>        =
<span class="default_value">&#39;parentoid&#39;</span>

        
    </div>
    <a class="headerlink" href="#parentoid"></a>
    
    

                </section>
                <section id="patientid">
                    <div class="attr variable">
            <span class="name">patientid</span>        =
<span class="default_value">&#39;patientid&#39;</span>

        
    </div>
    <a class="headerlink" href="#patientid"></a>
    
    

                </section>
                <section id="project">
                    <div class="attr variable">
            <span class="name">project</span>        =
<span class="default_value">&#39;project&#39;</span>

        
    </div>
    <a class="headerlink" href="#project"></a>
    
    

                </section>
                <section id="receiptdate">
                    <div class="attr variable">
            <span class="name">receiptdate</span>        =
<span class="default_value">&#39;receiptdate&#39;</span>

        
    </div>
    <a class="headerlink" href="#receiptdate"></a>
    
    

                </section>
                <section id="receptacle">
                    <div class="attr variable">
            <span class="name">receptacle</span>        =
<span class="default_value">&#39;receptacle&#39;</span>

        
    </div>
    <a class="headerlink" href="#receptacle"></a>
    
    

                </section>
                <section id="repositiondate">
                    <div class="attr variable">
            <span class="name">repositiondate</span>        =
<span class="default_value">&#39;repositiondate&#39;</span>

        
    </div>
    <a class="headerlink" href="#repositiondate"></a>
    
    

                </section>
                <section id="restamount">
                    <div class="attr variable">
            <span class="name">restamount</span>        =
<span class="default_value">&#39;restamount&#39;</span>

        
    </div>
    <a class="headerlink" href="#restamount"></a>
    
    

                </section>
                <section id="restunit">
                    <div class="attr variable">
            <span class="name">restunit</span>        =
<span class="default_value">&#39;restunit&#39;</span>

        
    </div>
    <a class="headerlink" href="#restunit"></a>
    
    

                </section>
                <section id="sampleid">
                    <div class="attr variable">
            <span class="name">sampleid</span>        =
<span class="default_value">&#39;sampleid&#39;</span>

        
    </div>
    <a class="headerlink" href="#sampleid"></a>
    
    

                </section>
                <section id="sampleoid">
                    <div class="attr variable">
            <span class="name">sampleoid</span>        =
<span class="default_value">&#39;sampleoid&#39;</span>

        
    </div>
    <a class="headerlink" href="#sampleoid"></a>
    
    

                </section>
                <section id="sampletype">
                    <div class="attr variable">
            <span class="name">sampletype</span>        =
<span class="default_value">&#39;sampletype&#39;</span>

        
    </div>
    <a class="headerlink" href="#sampletype"></a>
    
    

                </section>
                <section id="secondprocessing">
                    <div class="attr variable">
            <span class="name">secondprocessing</span>        =
<span class="default_value">&#39;secondprocessing&#39;</span>

        
    </div>
    <a class="headerlink" href="#secondprocessing"></a>
    
    

                </section>
                <section id="secondprocessingdate">
                    <div class="attr variable">
            <span class="name">secondprocessingdate</span>        =
<span class="default_value">&#39;secondprocessingdate&#39;</span>

        
    </div>
    <a class="headerlink" href="#secondprocessingdate"></a>
    
    

                </section>
                <section id="stockprocessing">
                    <div class="attr variable">
            <span class="name">stockprocessing</span>        =
<span class="default_value">&#39;stockprocessing&#39;</span>

        
    </div>
    <a class="headerlink" href="#stockprocessing"></a>
    
    

                </section>
                <section id="stockprocessingdate">
                    <div class="attr variable">
            <span class="name">stockprocessingdate</span>        =
<span class="default_value">&#39;stockprocessingdate&#39;</span>

        
    </div>
    <a class="headerlink" href="#stockprocessingdate"></a>
    
    

                </section>
                <section id="trial">
                    <div class="attr variable">
            <span class="name">trial</span>        =
<span class="default_value">&#39;trial&#39;</span>

        
    </div>
    <a class="headerlink" href="#trial"></a>
    
    

                </section>
                <section id="type">
                    <div class="attr variable">
            <span class="name">type</span>        =
<span class="default_value">&#39;type&#39;</span>

        
    </div>
    <a class="headerlink" href="#type"></a>
    
    

                </section>
                <section id="values">
                    <div class="attr variable">
            <span class="name">values</span>        =
<span class="default_value">&#39;values&#39;</span>

        
    </div>
    <a class="headerlink" href="#values"></a>
    
    

                </section>
                <section id="xposition">
                    <div class="attr variable">
            <span class="name">xposition</span>        =
<span class="default_value">&#39;xposition&#39;</span>

        
    </div>
    <a class="headerlink" href="#xposition"></a>
    
    

                </section>
                <section id="yposition">
                    <div class="attr variable">
            <span class="name">yposition</span>        =
<span class="default_value">&#39;yposition&#39;</span>

        
    </div>
    <a class="headerlink" href="#yposition"></a>
    
    

                </section>
                <section id="cnftemplate">
                    <div class="attr variable">
            <span class="name">cnftemplate</span>        =
<input id="cnftemplate-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="cnftemplate-view-value"></label><span class="default_value">&#39;\n# settings for traction.\n\n# sampleid sets the idcontainertype code that is used when searching for sampleid.\n# put in a code per db target.\nsampleid: \n  &lt;db target&gt;: &lt;an idcontainertype code, e.g. SAMPLEID&gt;\n# patientid sets the idcontainertype code that is used when searching for patientid.\n# put in a code per db target.\npatientid: \n  &lt;db target&gt;: &lt;an idcontainertype code, e.g. LIMSPSN&gt;\n\n# idc holds additional idcontainertype codes that will be queryable as command line flags.\nidc:\n - &lt;an idcontainertype code&gt;\n - &lt;another idcontainertype code&gt;\n&#39;</span>

        
    </div>
    <a class="headerlink" href="#cnftemplate"></a>
    
    

                </section>
                <section id="floatornull">
                            <input id="floatornull-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">floatornull</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="floatornull-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#floatornull"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="floatornull-72"><a href="#floatornull-72"><span class="linenos">72</span></a><span class="k">def</span><span class="w"> </span><span class="nf">floatornull</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="floatornull-73"><a href="#floatornull-73"><span class="linenos">73</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="floatornull-74"><a href="#floatornull-74"><span class="linenos">74</span></a><span class="sd">     floatornull casts to float or returns None. somehow the values passed</span>
</span><span id="floatornull-75"><a href="#floatornull-75"><span class="linenos">75</span></a><span class="sd">     to Amount need float casts, and float casts don&#39;t accept None.</span>
</span><span id="floatornull-76"><a href="#floatornull-76"><span class="linenos">76</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="floatornull-77"><a href="#floatornull-77"><span class="linenos">77</span></a>    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="floatornull-78"><a href="#floatornull-78"><span class="linenos">78</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="floatornull-79"><a href="#floatornull-79"><span class="linenos">79</span></a>    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>floatornull casts to float or returns None. somehow the values passed
to Amount need float casts, and float casts don't accept None.</p>
</div>


                </section>
                <section id="get_ids">
                            <input id="get_ids-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_ids</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">idables</span><span class="p">:</span> <span class="nb">list</span>, </span><span class="param"><span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="get_ids-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_ids"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_ids-80"><a href="#get_ids-80"><span class="linenos">80</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_ids</span><span class="p">(</span><span class="n">idables</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="get_ids-81"><a href="#get_ids-81"><span class="linenos">81</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_ids-82"><a href="#get_ids-82"><span class="linenos">82</span></a><span class="sd">     get_ids returns a list of string ids from a list of Idables (Sample or</span>
</span><span id="get_ids-83"><a href="#get_ids-83"><span class="linenos">83</span></a><span class="sd">     Patient).</span>
</span><span id="get_ids-84"><a href="#get_ids-84"><span class="linenos">84</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_ids-85"><a href="#get_ids-85"><span class="linenos">85</span></a>    <span class="k">return</span> <span class="p">[</span> <span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">idables</span> <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>get_ids returns a list of string ids from a list of Idables (Sample or
Patient).</p>
</div>


                </section>
                <section id="Identifier">
                            <input id="Identifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Identifier</span>:

                <label class="view-source-button" for="Identifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Identifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Identifier-87"><a href="#Identifier-87"><span class="linenos">87</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Identifier</span><span class="p">:</span>
</span><span id="Identifier-88"><a href="#Identifier-88"><span class="linenos">88</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Identifier-89"><a href="#Identifier-89"><span class="linenos">89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Identifier-90"><a href="#Identifier-90"><span class="linenos">90</span></a><span class="sd">         __init__ initializes an identifier.</span>
</span><span id="Identifier-91"><a href="#Identifier-91"><span class="linenos">91</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Identifier-92"><a href="#Identifier-92"><span class="linenos">92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="Identifier-93"><a href="#Identifier-93"><span class="linenos">93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
</span></pre></div>


    

                            <div id="Identifier.__init__" class="classattr">
                                        <input id="Identifier.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Identifier</span><span class="signature pdoc-code condensed">(<span class="param"><span class="nb">id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Identifier.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Identifier.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Identifier.__init__-88"><a href="#Identifier.__init__-88"><span class="linenos">88</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Identifier.__init__-89"><a href="#Identifier.__init__-89"><span class="linenos">89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Identifier.__init__-90"><a href="#Identifier.__init__-90"><span class="linenos">90</span></a><span class="sd">         __init__ initializes an identifier.</span>
</span><span id="Identifier.__init__-91"><a href="#Identifier.__init__-91"><span class="linenos">91</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Identifier.__init__-92"><a href="#Identifier.__init__-92"><span class="linenos">92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="Identifier.__init__-93"><a href="#Identifier.__init__-93"><span class="linenos">93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
</span></pre></div>


            <div class="docstring"><p>__init__ initializes an identifier.</p>
</div>


                            </div>
                            <div id="Identifier.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span>

        
    </div>
    <a class="headerlink" href="#Identifier.id"></a>
    
    

                            </div>
                            <div id="Identifier.code" class="classattr">
                                <div class="attr variable">
            <span class="name">code</span>

        
    </div>
    <a class="headerlink" href="#Identifier.code"></a>
    
    

                            </div>
                </section>
                <section id="Amount">
                            <input id="Amount-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Amount</span>:

                <label class="view-source-button" for="Amount-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Amount"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Amount-94"><a href="#Amount-94"><span class="linenos"> 94</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Amount</span><span class="p">:</span>
</span><span id="Amount-95"><a href="#Amount-95"><span class="linenos"> 95</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Amount-96"><a href="#Amount-96"><span class="linenos"> 96</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Amount-97"><a href="#Amount-97"><span class="linenos"> 97</span></a><span class="sd">         __init__ initializes an amount.</span>
</span><span id="Amount-98"><a href="#Amount-98"><span class="linenos"> 98</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Amount-99"><a href="#Amount-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="Amount-100"><a href="#Amount-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>
</span><span id="Amount-101"><a href="#Amount-101"><span class="linenos">101</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Amount-102"><a href="#Amount-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Amount-103"><a href="#Amount-103"><span class="linenos">103</span></a><span class="sd">         __str__ gives the value and unit in human-readable format.</span>
</span><span id="Amount-104"><a href="#Amount-104"><span class="linenos">104</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Amount-105"><a href="#Amount-105"><span class="linenos">105</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span>
</span></pre></div>


    

                            <div id="Amount.__init__" class="classattr">
                                        <input id="Amount.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Amount</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Amount.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Amount.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Amount.__init__-95"><a href="#Amount.__init__-95"><span class="linenos"> 95</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Amount.__init__-96"><a href="#Amount.__init__-96"><span class="linenos"> 96</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Amount.__init__-97"><a href="#Amount.__init__-97"><span class="linenos"> 97</span></a><span class="sd">         __init__ initializes an amount.</span>
</span><span id="Amount.__init__-98"><a href="#Amount.__init__-98"><span class="linenos"> 98</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Amount.__init__-99"><a href="#Amount.__init__-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="Amount.__init__-100"><a href="#Amount.__init__-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>
</span></pre></div>


            <div class="docstring"><p>__init__ initializes an amount.</p>
</div>


                            </div>
                            <div id="Amount.value" class="classattr">
                                <div class="attr variable">
            <span class="name">value</span>

        
    </div>
    <a class="headerlink" href="#Amount.value"></a>
    
    

                            </div>
                            <div id="Amount.unit" class="classattr">
                                <div class="attr variable">
            <span class="name">unit</span>

        
    </div>
    <a class="headerlink" href="#Amount.unit"></a>
    
    

                            </div>
                </section>
                <section id="Idable">
                            <input id="Idable-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Idable</span>:

                <label class="view-source-button" for="Idable-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Idable"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Idable-106"><a href="#Idable-106"><span class="linenos">106</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Idable</span><span class="p">:</span>
</span><span id="Idable-107"><a href="#Idable-107"><span class="linenos">107</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mainidc</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Idable-108"><a href="#Idable-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Idable-109"><a href="#Idable-109"><span class="linenos">109</span></a><span class="sd">         __init__ initializes an Idable from a list of Identifiers and a</span>
</span><span id="Idable-110"><a href="#Idable-110"><span class="linenos">110</span></a><span class="sd">         mainidc string.</span>
</span><span id="Idable-111"><a href="#Idable-111"><span class="linenos">111</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Idable-112"><a href="#Idable-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ids</span> <span class="o">=</span> <span class="n">ids</span>
</span><span id="Idable-113"><a href="#Idable-113"><span class="linenos">113</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Idable-114"><a href="#Idable-114"><span class="linenos">114</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Idable-115"><a href="#Idable-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mainidc</span> <span class="o">=</span> <span class="n">mainidc</span>
</span><span id="Idable-116"><a href="#Idable-116"><span class="linenos">116</span></a>        <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Idable-117"><a href="#Idable-117"><span class="linenos">117</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">))</span>
</span><span id="Idable-118"><a href="#Idable-118"><span class="linenos">118</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Identifier</span><span class="p">:</span>
</span><span id="Idable-119"><a href="#Idable-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Idable-120"><a href="#Idable-120"><span class="linenos">120</span></a><span class="sd">         identifier returns the Identifier for the given code, if no code</span>
</span><span id="Idable-121"><a href="#Idable-121"><span class="linenos">121</span></a><span class="sd">         given, the Identifier for the main idc returned.</span>
</span><span id="Idable-122"><a href="#Idable-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Idable-123"><a href="#Idable-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Idable-124"><a href="#Idable-124"><span class="linenos">124</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainidc</span>
</span><span id="Idable-125"><a href="#Idable-125"><span class="linenos">125</span></a>        <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">:</span>
</span><span id="Idable-126"><a href="#Idable-126"><span class="linenos">126</span></a>            <span class="k">if</span> <span class="n">identifier</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="n">code</span><span class="p">:</span>
</span><span id="Idable-127"><a href="#Idable-127"><span class="linenos">127</span></a>                <span class="k">return</span> <span class="n">identifier</span>
</span><span id="Idable-128"><a href="#Idable-128"><span class="linenos">128</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Idable-129"><a href="#Idable-129"><span class="linenos">129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Idable-130"><a href="#Idable-130"><span class="linenos">130</span></a><span class="sd">         id returns the id value for the given code, if no code</span>
</span><span id="Idable-131"><a href="#Idable-131"><span class="linenos">131</span></a><span class="sd">         given, the id value for the main idc is returned.</span>
</span><span id="Idable-132"><a href="#Idable-132"><span class="linenos">132</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Idable-133"><a href="#Idable-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Idable-134"><a href="#Idable-134"><span class="linenos">134</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="o">.</span><span class="n">id</span>
</span><span id="Idable-135"><a href="#Idable-135"><span class="linenos">135</span></a>        <span class="k">return</span> <span class="kc">None</span> 
</span><span id="Idable-136"><a href="#Idable-136"><span class="linenos">136</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">iddict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">idcs</span><span class="p">):</span>
</span><span id="Idable-137"><a href="#Idable-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Idable-138"><a href="#Idable-138"><span class="linenos">138</span></a><span class="sd">         iddict returns a copy of the __dict__ holding the given ids at the</span>
</span><span id="Idable-139"><a href="#Idable-139"><span class="linenos">139</span></a><span class="sd">         root level of the dict in addition to the classes attributes.  if no</span>
</span><span id="Idable-140"><a href="#Idable-140"><span class="linenos">140</span></a><span class="sd">         ids are given, all ids taken.  the ids and mainidc fields are cleared,</span>
</span><span id="Idable-141"><a href="#Idable-141"><span class="linenos">141</span></a><span class="sd">         exept when keep is true. if iddict is called on an inheriting class</span>
</span><span id="Idable-142"><a href="#Idable-142"><span class="linenos">142</span></a><span class="sd">         (e.g. Sample) the dict gives the inheriting classes attributes.</span>
</span><span id="Idable-143"><a href="#Idable-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Idable-144"><a href="#Idable-144"><span class="linenos">144</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Idable-145"><a href="#Idable-145"><span class="linenos">145</span></a>        <span class="k">if</span> <span class="n">idcs</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">idcs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Idable-146"><a href="#Idable-146"><span class="linenos">146</span></a>            <span class="n">idcs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">id</span><span class="o">.</span><span class="n">code</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">]</span>
</span><span id="Idable-147"><a href="#Idable-147"><span class="linenos">147</span></a>        <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="n">idcs</span><span class="p">:</span>
</span><span id="Idable-148"><a href="#Idable-148"><span class="linenos">148</span></a>            <span class="n">d</span><span class="p">[</span><span class="n">idc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">idc</span><span class="p">)</span>
</span><span id="Idable-149"><a href="#Idable-149"><span class="linenos">149</span></a>        <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">]</span>
</span><span id="Idable-150"><a href="#Idable-150"><span class="linenos">150</span></a>        <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;mainidc&quot;</span><span class="p">]</span>
</span><span id="Idable-151"><a href="#Idable-151"><span class="linenos">151</span></a>        <span class="k">return</span> <span class="n">d</span>
</span><span id="Idable-152"><a href="#Idable-152"><span class="linenos">152</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Idable-153"><a href="#Idable-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Idable-154"><a href="#Idable-154"><span class="linenos">154</span></a><span class="sd">         __str__ gives a human readable representation of Idable, here the</span>
</span><span id="Idable-155"><a href="#Idable-155"><span class="linenos">155</span></a><span class="sd">         id string.</span>
</span><span id="Idable-156"><a href="#Idable-156"><span class="linenos">156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Idable-157"><a href="#Idable-157"><span class="linenos">157</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Idable-158"><a href="#Idable-158"><span class="linenos">158</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">()</span>
</span><span id="Idable-159"><a href="#Idable-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span></pre></div>


    

                            <div id="Idable.__init__" class="classattr">
                                        <input id="Idable.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Idable</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">mainidc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="nb">id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Idable.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Idable.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Idable.__init__-107"><a href="#Idable.__init__-107"><span class="linenos">107</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mainidc</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Idable.__init__-108"><a href="#Idable.__init__-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Idable.__init__-109"><a href="#Idable.__init__-109"><span class="linenos">109</span></a><span class="sd">         __init__ initializes an Idable from a list of Identifiers and a</span>
</span><span id="Idable.__init__-110"><a href="#Idable.__init__-110"><span class="linenos">110</span></a><span class="sd">         mainidc string.</span>
</span><span id="Idable.__init__-111"><a href="#Idable.__init__-111"><span class="linenos">111</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Idable.__init__-112"><a href="#Idable.__init__-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ids</span> <span class="o">=</span> <span class="n">ids</span>
</span><span id="Idable.__init__-113"><a href="#Idable.__init__-113"><span class="linenos">113</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Idable.__init__-114"><a href="#Idable.__init__-114"><span class="linenos">114</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Idable.__init__-115"><a href="#Idable.__init__-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mainidc</span> <span class="o">=</span> <span class="n">mainidc</span>
</span><span id="Idable.__init__-116"><a href="#Idable.__init__-116"><span class="linenos">116</span></a>        <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Idable.__init__-117"><a href="#Idable.__init__-117"><span class="linenos">117</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>__init__ initializes an Idable from a list of Identifiers and a
mainidc string.</p>
</div>


                            </div>
                            <div id="Idable.ids" class="classattr">
                                <div class="attr variable">
            <span class="name">ids</span>

        
    </div>
    <a class="headerlink" href="#Idable.ids"></a>
    
    

                            </div>
                            <div id="Idable.mainidc" class="classattr">
                                <div class="attr variable">
            <span class="name">mainidc</span>

        
    </div>
    <a class="headerlink" href="#Idable.mainidc"></a>
    
    

                            </div>
                            <div id="Idable.identifier" class="classattr">
                                        <input id="Idable.identifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">identifier</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Identifier">Identifier</a></span>:</span></span>

                <label class="view-source-button" for="Idable.identifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Idable.identifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Idable.identifier-118"><a href="#Idable.identifier-118"><span class="linenos">118</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Identifier</span><span class="p">:</span>
</span><span id="Idable.identifier-119"><a href="#Idable.identifier-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Idable.identifier-120"><a href="#Idable.identifier-120"><span class="linenos">120</span></a><span class="sd">         identifier returns the Identifier for the given code, if no code</span>
</span><span id="Idable.identifier-121"><a href="#Idable.identifier-121"><span class="linenos">121</span></a><span class="sd">         given, the Identifier for the main idc returned.</span>
</span><span id="Idable.identifier-122"><a href="#Idable.identifier-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Idable.identifier-123"><a href="#Idable.identifier-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Idable.identifier-124"><a href="#Idable.identifier-124"><span class="linenos">124</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainidc</span>
</span><span id="Idable.identifier-125"><a href="#Idable.identifier-125"><span class="linenos">125</span></a>        <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">:</span>
</span><span id="Idable.identifier-126"><a href="#Idable.identifier-126"><span class="linenos">126</span></a>            <span class="k">if</span> <span class="n">identifier</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="n">code</span><span class="p">:</span>
</span><span id="Idable.identifier-127"><a href="#Idable.identifier-127"><span class="linenos">127</span></a>                <span class="k">return</span> <span class="n">identifier</span>
</span></pre></div>


            <div class="docstring"><p>identifier returns the Identifier for the given code, if no code
given, the Identifier for the main idc returned.</p>
</div>


                            </div>
                            <div id="Idable.id" class="classattr">
                                        <input id="Idable.id-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">id</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="Idable.id-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Idable.id"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Idable.id-128"><a href="#Idable.id-128"><span class="linenos">128</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Idable.id-129"><a href="#Idable.id-129"><span class="linenos">129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Idable.id-130"><a href="#Idable.id-130"><span class="linenos">130</span></a><span class="sd">         id returns the id value for the given code, if no code</span>
</span><span id="Idable.id-131"><a href="#Idable.id-131"><span class="linenos">131</span></a><span class="sd">         given, the id value for the main idc is returned.</span>
</span><span id="Idable.id-132"><a href="#Idable.id-132"><span class="linenos">132</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Idable.id-133"><a href="#Idable.id-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Idable.id-134"><a href="#Idable.id-134"><span class="linenos">134</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="o">.</span><span class="n">id</span>
</span><span id="Idable.id-135"><a href="#Idable.id-135"><span class="linenos">135</span></a>        <span class="k">return</span> <span class="kc">None</span> 
</span></pre></div>


            <div class="docstring"><p>id returns the id value for the given code, if no code
given, the id value for the main idc is returned.</p>
</div>


                            </div>
                            <div id="Idable.iddict" class="classattr">
                                        <input id="Idable.iddict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">iddict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">idcs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Idable.iddict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Idable.iddict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Idable.iddict-136"><a href="#Idable.iddict-136"><span class="linenos">136</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">iddict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">idcs</span><span class="p">):</span>
</span><span id="Idable.iddict-137"><a href="#Idable.iddict-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Idable.iddict-138"><a href="#Idable.iddict-138"><span class="linenos">138</span></a><span class="sd">         iddict returns a copy of the __dict__ holding the given ids at the</span>
</span><span id="Idable.iddict-139"><a href="#Idable.iddict-139"><span class="linenos">139</span></a><span class="sd">         root level of the dict in addition to the classes attributes.  if no</span>
</span><span id="Idable.iddict-140"><a href="#Idable.iddict-140"><span class="linenos">140</span></a><span class="sd">         ids are given, all ids taken.  the ids and mainidc fields are cleared,</span>
</span><span id="Idable.iddict-141"><a href="#Idable.iddict-141"><span class="linenos">141</span></a><span class="sd">         exept when keep is true. if iddict is called on an inheriting class</span>
</span><span id="Idable.iddict-142"><a href="#Idable.iddict-142"><span class="linenos">142</span></a><span class="sd">         (e.g. Sample) the dict gives the inheriting classes attributes.</span>
</span><span id="Idable.iddict-143"><a href="#Idable.iddict-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Idable.iddict-144"><a href="#Idable.iddict-144"><span class="linenos">144</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Idable.iddict-145"><a href="#Idable.iddict-145"><span class="linenos">145</span></a>        <span class="k">if</span> <span class="n">idcs</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">idcs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Idable.iddict-146"><a href="#Idable.iddict-146"><span class="linenos">146</span></a>            <span class="n">idcs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">id</span><span class="o">.</span><span class="n">code</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">]</span>
</span><span id="Idable.iddict-147"><a href="#Idable.iddict-147"><span class="linenos">147</span></a>        <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="n">idcs</span><span class="p">:</span>
</span><span id="Idable.iddict-148"><a href="#Idable.iddict-148"><span class="linenos">148</span></a>            <span class="n">d</span><span class="p">[</span><span class="n">idc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">idc</span><span class="p">)</span>
</span><span id="Idable.iddict-149"><a href="#Idable.iddict-149"><span class="linenos">149</span></a>        <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">]</span>
</span><span id="Idable.iddict-150"><a href="#Idable.iddict-150"><span class="linenos">150</span></a>        <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;mainidc&quot;</span><span class="p">]</span>
</span><span id="Idable.iddict-151"><a href="#Idable.iddict-151"><span class="linenos">151</span></a>        <span class="k">return</span> <span class="n">d</span>
</span></pre></div>


            <div class="docstring"><p>iddict returns a copy of the __dict__ holding the given ids at the
root level of the dict in addition to the classes attributes.  if no
ids are given, all ids taken.  the ids and mainidc fields are cleared,
exept when keep is true. if iddict is called on an inheriting class
(e.g. Sample) the dict gives the inheriting classes attributes.</p>
</div>


                            </div>
                </section>
                <section id="Sample">
                            <input id="Sample-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Sample</span><wbr>(<span class="base"><a href="#Idable">Idable</a></span>):

                <label class="view-source-button" for="Sample-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sample"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sample-160"><a href="#Sample-160"><span class="linenos">160</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Sample</span><span class="p">(</span><span class="n">Idable</span><span class="p">):</span>
</span><span id="Sample-161"><a href="#Sample-161"><span class="linenos">161</span></a>    <span class="n">appointment</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sample-162"><a href="#Sample-162"><span class="linenos">162</span></a>    <span class="n">category</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sample-163"><a href="#Sample-163"><span class="linenos">163</span></a>    <span class="n">concentration</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-164"><a href="#Sample-164"><span class="linenos">164</span></a>    <span class="n">derivaldate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-165"><a href="#Sample-165"><span class="linenos">165</span></a>    <span class="n">receiptdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-166"><a href="#Sample-166"><span class="linenos">166</span></a>    <span class="n">first_repositiondate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-167"><a href="#Sample-167"><span class="linenos">167</span></a>    <span class="n">initialamount</span><span class="p">:</span><span class="n">Amount</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-168"><a href="#Sample-168"><span class="linenos">168</span></a>    <span class="n">locationname</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-169"><a href="#Sample-169"><span class="linenos">169</span></a>    <span class="n">locationpath</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-170"><a href="#Sample-170"><span class="linenos">170</span></a>    <span class="n">orga</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sample-171"><a href="#Sample-171"><span class="linenos">171</span></a>    <span class="n">parent</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span> 
</span><span id="Sample-172"><a href="#Sample-172"><span class="linenos">172</span></a>    <span class="n">patient</span><span class="p">:</span><span class="n">Idable</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sample-173"><a href="#Sample-173"><span class="linenos">173</span></a>    <span class="n">project</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sample-174"><a href="#Sample-174"><span class="linenos">174</span></a>    <span class="n">receptacle</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-175"><a href="#Sample-175"><span class="linenos">175</span></a>    <span class="n">restamount</span><span class="p">:</span><span class="n">Amount</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-176"><a href="#Sample-176"><span class="linenos">176</span></a>    <span class="n">samplingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-177"><a href="#Sample-177"><span class="linenos">177</span></a>    <span class="n">secondprocessing</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-178"><a href="#Sample-178"><span class="linenos">178</span></a>    <span class="n">secondprocessingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-179"><a href="#Sample-179"><span class="linenos">179</span></a>    <span class="n">stockprocessing</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-180"><a href="#Sample-180"><span class="linenos">180</span></a>    <span class="n">stockprocessingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-181"><a href="#Sample-181"><span class="linenos">181</span></a>    <span class="n">repositiondate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-182"><a href="#Sample-182"><span class="linenos">182</span></a>    <span class="n">trial</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-183"><a href="#Sample-183"><span class="linenos">183</span></a>    <span class="nb">type</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-184"><a href="#Sample-184"><span class="linenos">184</span></a>    <span class="n">xposition</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-185"><a href="#Sample-185"><span class="linenos">185</span></a>    <span class="n">yposition</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-186"><a href="#Sample-186"><span class="linenos">186</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Sample-187"><a href="#Sample-187"><span class="linenos">187</span></a>         <span class="bp">self</span><span class="p">,</span>
</span><span id="Sample-188"><a href="#Sample-188"><span class="linenos">188</span></a>         <span class="n">appointment</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-189"><a href="#Sample-189"><span class="linenos">189</span></a>         <span class="n">category</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-190"><a href="#Sample-190"><span class="linenos">190</span></a>         <span class="n">cxxkitid</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-191"><a href="#Sample-191"><span class="linenos">191</span></a>         <span class="n">concentration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># str?</span>
</span><span id="Sample-192"><a href="#Sample-192"><span class="linenos">192</span></a>         <span class="n">derivaldate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-193"><a href="#Sample-193"><span class="linenos">193</span></a>         <span class="n">first_repositiondate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-194"><a href="#Sample-194"><span class="linenos">194</span></a>         <span class="n">ids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># of Identifier         </span>
</span><span id="Sample-195"><a href="#Sample-195"><span class="linenos">195</span></a>         <span class="n">initialamount</span><span class="p">:</span><span class="n">Amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-196"><a href="#Sample-196"><span class="linenos">196</span></a>         <span class="n">kitid</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-197"><a href="#Sample-197"><span class="linenos">197</span></a>         <span class="n">locationpath</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-198"><a href="#Sample-198"><span class="linenos">198</span></a>         <span class="n">locationname</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-199"><a href="#Sample-199"><span class="linenos">199</span></a>         <span class="n">orga</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-200"><a href="#Sample-200"><span class="linenos">200</span></a>         <span class="n">parent</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-201"><a href="#Sample-201"><span class="linenos">201</span></a>         <span class="n">patient</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-202"><a href="#Sample-202"><span class="linenos">202</span></a>         <span class="n">project</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-203"><a href="#Sample-203"><span class="linenos">203</span></a>         <span class="n">receptacle</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Sample-204"><a href="#Sample-204"><span class="linenos">204</span></a>         <span class="n">restamount</span><span class="p">:</span><span class="n">Amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-205"><a href="#Sample-205"><span class="linenos">205</span></a>         <span class="n">samplingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-206"><a href="#Sample-206"><span class="linenos">206</span></a>         <span class="n">secondprocessing</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-207"><a href="#Sample-207"><span class="linenos">207</span></a>         <span class="n">secondprocessingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>         
</span><span id="Sample-208"><a href="#Sample-208"><span class="linenos">208</span></a>         <span class="n">stockprocessing</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-209"><a href="#Sample-209"><span class="linenos">209</span></a>         <span class="n">stockprocessingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>         
</span><span id="Sample-210"><a href="#Sample-210"><span class="linenos">210</span></a>         <span class="n">receiptdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>         
</span><span id="Sample-211"><a href="#Sample-211"><span class="linenos">211</span></a>         <span class="n">repositiondate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-212"><a href="#Sample-212"><span class="linenos">212</span></a>         <span class="n">sidc</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-213"><a href="#Sample-213"><span class="linenos">213</span></a>         <span class="n">trial</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-214"><a href="#Sample-214"><span class="linenos">214</span></a>         <span class="nb">type</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample-215"><a href="#Sample-215"><span class="linenos">215</span></a>         <span class="n">xposition</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Sample-216"><a href="#Sample-216"><span class="linenos">216</span></a>         <span class="n">yposition</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample-217"><a href="#Sample-217"><span class="linenos">217</span></a>         <span class="p">):</span>
</span><span id="Sample-218"><a href="#Sample-218"><span class="linenos">218</span></a>        <span class="n">Idable</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="n">sidc</span><span class="p">)</span>
</span><span id="Sample-219"><a href="#Sample-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">appointment</span> <span class="o">=</span> <span class="n">appointment</span>
</span><span id="Sample-220"><a href="#Sample-220"><span class="linenos">220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">category</span>
</span><span id="Sample-221"><a href="#Sample-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cxxkitid</span> <span class="o">=</span> <span class="n">cxxkitid</span>
</span><span id="Sample-222"><a href="#Sample-222"><span class="linenos">222</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">concentration</span> <span class="o">=</span> <span class="n">concentration</span>
</span><span id="Sample-223"><a href="#Sample-223"><span class="linenos">223</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">derivaldate</span> <span class="o">=</span> <span class="n">derivaldate</span>
</span><span id="Sample-224"><a href="#Sample-224"><span class="linenos">224</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">receiptdate</span> <span class="o">=</span> <span class="n">receiptdate</span>
</span><span id="Sample-225"><a href="#Sample-225"><span class="linenos">225</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">first_repositiondate</span> <span class="o">=</span> <span class="n">first_repositiondate</span>
</span><span id="Sample-226"><a href="#Sample-226"><span class="linenos">226</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialamount</span> <span class="o">=</span> <span class="n">initialamount</span>
</span><span id="Sample-227"><a href="#Sample-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kitid</span> <span class="o">=</span> <span class="n">kitid</span>
</span><span id="Sample-228"><a href="#Sample-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locationpath</span> <span class="o">=</span> <span class="n">locationpath</span>
</span><span id="Sample-229"><a href="#Sample-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locationname</span> <span class="o">=</span> <span class="n">locationname</span>
</span><span id="Sample-230"><a href="#Sample-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orga</span> <span class="o">=</span> <span class="n">orga</span>
</span><span id="Sample-231"><a href="#Sample-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="Sample-232"><a href="#Sample-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">patient</span> <span class="o">=</span> <span class="n">patient</span>
</span><span id="Sample-233"><a href="#Sample-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
</span><span id="Sample-234"><a href="#Sample-234"><span class="linenos">234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">receptacle</span> <span class="o">=</span> <span class="n">receptacle</span>
</span><span id="Sample-235"><a href="#Sample-235"><span class="linenos">235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">repositiondate</span> <span class="o">=</span> <span class="n">repositiondate</span>
</span><span id="Sample-236"><a href="#Sample-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">restamount</span> <span class="o">=</span> <span class="n">restamount</span>
</span><span id="Sample-237"><a href="#Sample-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secondprocessing</span> <span class="o">=</span> <span class="n">secondprocessing</span>
</span><span id="Sample-238"><a href="#Sample-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secondprocessingdate</span> <span class="o">=</span> <span class="n">secondprocessingdate</span>        
</span><span id="Sample-239"><a href="#Sample-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stockprocessing</span> <span class="o">=</span> <span class="n">stockprocessing</span>
</span><span id="Sample-240"><a href="#Sample-240"><span class="linenos">240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stockprocessingdate</span> <span class="o">=</span> <span class="n">stockprocessingdate</span>        
</span><span id="Sample-241"><a href="#Sample-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">samplingdate</span> <span class="o">=</span> <span class="n">samplingdate</span>        
</span><span id="Sample-242"><a href="#Sample-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trial</span> <span class="o">=</span> <span class="n">trial</span>
</span><span id="Sample-243"><a href="#Sample-243"><span class="linenos">243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
</span><span id="Sample-244"><a href="#Sample-244"><span class="linenos">244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xposition</span> <span class="o">=</span> <span class="n">xposition</span>
</span><span id="Sample-245"><a href="#Sample-245"><span class="linenos">245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">yposition</span> <span class="o">=</span> <span class="n">yposition</span>
</span><span id="Sample-246"><a href="#Sample-246"><span class="linenos">246</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
</span><span id="Sample-247"><a href="#Sample-247"><span class="linenos">247</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sample-248"><a href="#Sample-248"><span class="linenos">248</span></a><span class="sd">         default returns the json dict.</span>
</span><span id="Sample-249"><a href="#Sample-249"><span class="linenos">249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sample-250"><a href="#Sample-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="vm">__dict__</span>
</span><span id="Sample-251"><a href="#Sample-251"><span class="linenos">251</span></a>    <span class="nd">@property</span>
</span><span id="Sample-252"><a href="#Sample-252"><span class="linenos">252</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sampleid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sample-253"><a href="#Sample-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sample-254"><a href="#Sample-254"><span class="linenos">254</span></a><span class="sd">         sampleid is a shorthand to get the sampleid so it isn&#39;t buried in a</span>
</span><span id="Sample-255"><a href="#Sample-255"><span class="linenos">255</span></a><span class="sd">         dict when displaying the object as json.</span>
</span><span id="Sample-256"><a href="#Sample-256"><span class="linenos">256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sample-257"><a href="#Sample-257"><span class="linenos">257</span></a>        <span class="k">return</span> <span class="s2">&quot;bla&quot;</span> <span class="c1"># self.get_id()</span>
</span><span id="Sample-258"><a href="#Sample-258"><span class="linenos">258</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sample-259"><a href="#Sample-259"><span class="linenos">259</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sample-260"><a href="#Sample-260"><span class="linenos">260</span></a><span class="sd">         __getstate__ returns what gets jsonpickled. include sampleid and</span>
</span><span id="Sample-261"><a href="#Sample-261"><span class="linenos">261</span></a><span class="sd">         patientid in root level, for quicker access.</span>
</span><span id="Sample-262"><a href="#Sample-262"><span class="linenos">262</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sample-263"><a href="#Sample-263"><span class="linenos">263</span></a>        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># is this slow?</span>
</span><span id="Sample-264"><a href="#Sample-264"><span class="linenos">264</span></a>        <span class="n">state</span><span class="p">[</span><span class="n">sampleid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">()</span>
</span><span id="Sample-265"><a href="#Sample-265"><span class="linenos">265</span></a>        <span class="n">state</span><span class="p">[</span><span class="n">patientid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patient</span><span class="o">.</span><span class="n">id</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">patient</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Sample-266"><a href="#Sample-266"><span class="linenos">266</span></a>        <span class="k">return</span> <span class="n">state</span>
</span></pre></div>


    

                            <div id="Sample.__init__" class="classattr">
                                        <input id="Sample.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Sample</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">appointment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">category</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">cxxkitid</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">concentration</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">derivaldate</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">first_repositiondate</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">initialamount</span><span class="p">:</span> <span class="n"><a href="#Amount">Amount</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">kitid</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">locationpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">locationname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">orga</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">parent</span><span class="p">:</span> <span class="n"><a href="#Idable">Idable</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">patient</span><span class="p">:</span> <span class="n"><a href="#Idable">Idable</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">project</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">receptacle</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">restamount</span><span class="p">:</span> <span class="n"><a href="#Amount">Amount</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">samplingdate</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">secondprocessing</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">secondprocessingdate</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">stockprocessing</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">stockprocessingdate</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">receiptdate</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">repositiondate</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sidc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">trial</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">xposition</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">yposition</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Sample.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sample.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sample.__init__-186"><a href="#Sample.__init__-186"><span class="linenos">186</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Sample.__init__-187"><a href="#Sample.__init__-187"><span class="linenos">187</span></a>         <span class="bp">self</span><span class="p">,</span>
</span><span id="Sample.__init__-188"><a href="#Sample.__init__-188"><span class="linenos">188</span></a>         <span class="n">appointment</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-189"><a href="#Sample.__init__-189"><span class="linenos">189</span></a>         <span class="n">category</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-190"><a href="#Sample.__init__-190"><span class="linenos">190</span></a>         <span class="n">cxxkitid</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-191"><a href="#Sample.__init__-191"><span class="linenos">191</span></a>         <span class="n">concentration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># str?</span>
</span><span id="Sample.__init__-192"><a href="#Sample.__init__-192"><span class="linenos">192</span></a>         <span class="n">derivaldate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-193"><a href="#Sample.__init__-193"><span class="linenos">193</span></a>         <span class="n">first_repositiondate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-194"><a href="#Sample.__init__-194"><span class="linenos">194</span></a>         <span class="n">ids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># of Identifier         </span>
</span><span id="Sample.__init__-195"><a href="#Sample.__init__-195"><span class="linenos">195</span></a>         <span class="n">initialamount</span><span class="p">:</span><span class="n">Amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-196"><a href="#Sample.__init__-196"><span class="linenos">196</span></a>         <span class="n">kitid</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-197"><a href="#Sample.__init__-197"><span class="linenos">197</span></a>         <span class="n">locationpath</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-198"><a href="#Sample.__init__-198"><span class="linenos">198</span></a>         <span class="n">locationname</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-199"><a href="#Sample.__init__-199"><span class="linenos">199</span></a>         <span class="n">orga</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-200"><a href="#Sample.__init__-200"><span class="linenos">200</span></a>         <span class="n">parent</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-201"><a href="#Sample.__init__-201"><span class="linenos">201</span></a>         <span class="n">patient</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-202"><a href="#Sample.__init__-202"><span class="linenos">202</span></a>         <span class="n">project</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-203"><a href="#Sample.__init__-203"><span class="linenos">203</span></a>         <span class="n">receptacle</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Sample.__init__-204"><a href="#Sample.__init__-204"><span class="linenos">204</span></a>         <span class="n">restamount</span><span class="p">:</span><span class="n">Amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-205"><a href="#Sample.__init__-205"><span class="linenos">205</span></a>         <span class="n">samplingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-206"><a href="#Sample.__init__-206"><span class="linenos">206</span></a>         <span class="n">secondprocessing</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-207"><a href="#Sample.__init__-207"><span class="linenos">207</span></a>         <span class="n">secondprocessingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>         
</span><span id="Sample.__init__-208"><a href="#Sample.__init__-208"><span class="linenos">208</span></a>         <span class="n">stockprocessing</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-209"><a href="#Sample.__init__-209"><span class="linenos">209</span></a>         <span class="n">stockprocessingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>         
</span><span id="Sample.__init__-210"><a href="#Sample.__init__-210"><span class="linenos">210</span></a>         <span class="n">receiptdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>         
</span><span id="Sample.__init__-211"><a href="#Sample.__init__-211"><span class="linenos">211</span></a>         <span class="n">repositiondate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-212"><a href="#Sample.__init__-212"><span class="linenos">212</span></a>         <span class="n">sidc</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-213"><a href="#Sample.__init__-213"><span class="linenos">213</span></a>         <span class="n">trial</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-214"><a href="#Sample.__init__-214"><span class="linenos">214</span></a>         <span class="nb">type</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Sample.__init__-215"><a href="#Sample.__init__-215"><span class="linenos">215</span></a>         <span class="n">xposition</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
</span><span id="Sample.__init__-216"><a href="#Sample.__init__-216"><span class="linenos">216</span></a>         <span class="n">yposition</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Sample.__init__-217"><a href="#Sample.__init__-217"><span class="linenos">217</span></a>         <span class="p">):</span>
</span><span id="Sample.__init__-218"><a href="#Sample.__init__-218"><span class="linenos">218</span></a>        <span class="n">Idable</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="n">sidc</span><span class="p">)</span>
</span><span id="Sample.__init__-219"><a href="#Sample.__init__-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">appointment</span> <span class="o">=</span> <span class="n">appointment</span>
</span><span id="Sample.__init__-220"><a href="#Sample.__init__-220"><span class="linenos">220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">category</span>
</span><span id="Sample.__init__-221"><a href="#Sample.__init__-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cxxkitid</span> <span class="o">=</span> <span class="n">cxxkitid</span>
</span><span id="Sample.__init__-222"><a href="#Sample.__init__-222"><span class="linenos">222</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">concentration</span> <span class="o">=</span> <span class="n">concentration</span>
</span><span id="Sample.__init__-223"><a href="#Sample.__init__-223"><span class="linenos">223</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">derivaldate</span> <span class="o">=</span> <span class="n">derivaldate</span>
</span><span id="Sample.__init__-224"><a href="#Sample.__init__-224"><span class="linenos">224</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">receiptdate</span> <span class="o">=</span> <span class="n">receiptdate</span>
</span><span id="Sample.__init__-225"><a href="#Sample.__init__-225"><span class="linenos">225</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">first_repositiondate</span> <span class="o">=</span> <span class="n">first_repositiondate</span>
</span><span id="Sample.__init__-226"><a href="#Sample.__init__-226"><span class="linenos">226</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialamount</span> <span class="o">=</span> <span class="n">initialamount</span>
</span><span id="Sample.__init__-227"><a href="#Sample.__init__-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kitid</span> <span class="o">=</span> <span class="n">kitid</span>
</span><span id="Sample.__init__-228"><a href="#Sample.__init__-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locationpath</span> <span class="o">=</span> <span class="n">locationpath</span>
</span><span id="Sample.__init__-229"><a href="#Sample.__init__-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locationname</span> <span class="o">=</span> <span class="n">locationname</span>
</span><span id="Sample.__init__-230"><a href="#Sample.__init__-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orga</span> <span class="o">=</span> <span class="n">orga</span>
</span><span id="Sample.__init__-231"><a href="#Sample.__init__-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
</span><span id="Sample.__init__-232"><a href="#Sample.__init__-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">patient</span> <span class="o">=</span> <span class="n">patient</span>
</span><span id="Sample.__init__-233"><a href="#Sample.__init__-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
</span><span id="Sample.__init__-234"><a href="#Sample.__init__-234"><span class="linenos">234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">receptacle</span> <span class="o">=</span> <span class="n">receptacle</span>
</span><span id="Sample.__init__-235"><a href="#Sample.__init__-235"><span class="linenos">235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">repositiondate</span> <span class="o">=</span> <span class="n">repositiondate</span>
</span><span id="Sample.__init__-236"><a href="#Sample.__init__-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">restamount</span> <span class="o">=</span> <span class="n">restamount</span>
</span><span id="Sample.__init__-237"><a href="#Sample.__init__-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secondprocessing</span> <span class="o">=</span> <span class="n">secondprocessing</span>
</span><span id="Sample.__init__-238"><a href="#Sample.__init__-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secondprocessingdate</span> <span class="o">=</span> <span class="n">secondprocessingdate</span>        
</span><span id="Sample.__init__-239"><a href="#Sample.__init__-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stockprocessing</span> <span class="o">=</span> <span class="n">stockprocessing</span>
</span><span id="Sample.__init__-240"><a href="#Sample.__init__-240"><span class="linenos">240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stockprocessingdate</span> <span class="o">=</span> <span class="n">stockprocessingdate</span>        
</span><span id="Sample.__init__-241"><a href="#Sample.__init__-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">samplingdate</span> <span class="o">=</span> <span class="n">samplingdate</span>        
</span><span id="Sample.__init__-242"><a href="#Sample.__init__-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trial</span> <span class="o">=</span> <span class="n">trial</span>
</span><span id="Sample.__init__-243"><a href="#Sample.__init__-243"><span class="linenos">243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
</span><span id="Sample.__init__-244"><a href="#Sample.__init__-244"><span class="linenos">244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xposition</span> <span class="o">=</span> <span class="n">xposition</span>
</span><span id="Sample.__init__-245"><a href="#Sample.__init__-245"><span class="linenos">245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">yposition</span> <span class="o">=</span> <span class="n">yposition</span>
</span></pre></div>


            <div class="docstring"><p>__init__ initializes an Idable from a list of Identifiers and a
mainidc string.</p>
</div>


                            </div>
                            <div id="Sample.appointment" class="classattr">
                                <div class="attr variable">
            <span class="name">appointment</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.appointment"></a>
    
    

                            </div>
                            <div id="Sample.category" class="classattr">
                                <div class="attr variable">
            <span class="name">category</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.category"></a>
    
    

                            </div>
                            <div id="Sample.concentration" class="classattr">
                                <div class="attr variable">
            <span class="name">concentration</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.concentration"></a>
    
    

                            </div>
                            <div id="Sample.derivaldate" class="classattr">
                                <div class="attr variable">
            <span class="name">derivaldate</span><span class="annotation">: datetime.datetime</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.derivaldate"></a>
    
    

                            </div>
                            <div id="Sample.receiptdate" class="classattr">
                                <div class="attr variable">
            <span class="name">receiptdate</span><span class="annotation">: datetime.datetime</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.receiptdate"></a>
    
    

                            </div>
                            <div id="Sample.first_repositiondate" class="classattr">
                                <div class="attr variable">
            <span class="name">first_repositiondate</span><span class="annotation">: datetime.datetime</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.first_repositiondate"></a>
    
    

                            </div>
                            <div id="Sample.initialamount" class="classattr">
                                <div class="attr variable">
            <span class="name">initialamount</span><span class="annotation">: <a href="#Amount">Amount</a></span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.initialamount"></a>
    
    

                            </div>
                            <div id="Sample.locationname" class="classattr">
                                <div class="attr variable">
            <span class="name">locationname</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.locationname"></a>
    
    

                            </div>
                            <div id="Sample.locationpath" class="classattr">
                                <div class="attr variable">
            <span class="name">locationpath</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.locationpath"></a>
    
    

                            </div>
                            <div id="Sample.orga" class="classattr">
                                <div class="attr variable">
            <span class="name">orga</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.orga"></a>
    
    

                            </div>
                            <div id="Sample.parent" class="classattr">
                                <div class="attr variable">
            <span class="name">parent</span><span class="annotation">: <a href="#Idable">Idable</a></span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.parent"></a>
    
    

                            </div>
                            <div id="Sample.patient" class="classattr">
                                <div class="attr variable">
            <span class="name">patient</span><span class="annotation">: <a href="#Idable">Idable</a></span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.patient"></a>
    
    

                            </div>
                            <div id="Sample.project" class="classattr">
                                <div class="attr variable">
            <span class="name">project</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.project"></a>
    
    

                            </div>
                            <div id="Sample.receptacle" class="classattr">
                                <div class="attr variable">
            <span class="name">receptacle</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.receptacle"></a>
    
    

                            </div>
                            <div id="Sample.restamount" class="classattr">
                                <div class="attr variable">
            <span class="name">restamount</span><span class="annotation">: <a href="#Amount">Amount</a></span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.restamount"></a>
    
    

                            </div>
                            <div id="Sample.samplingdate" class="classattr">
                                <div class="attr variable">
            <span class="name">samplingdate</span><span class="annotation">: datetime.datetime</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.samplingdate"></a>
    
    

                            </div>
                            <div id="Sample.secondprocessing" class="classattr">
                                <div class="attr variable">
            <span class="name">secondprocessing</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.secondprocessing"></a>
    
    

                            </div>
                            <div id="Sample.secondprocessingdate" class="classattr">
                                <div class="attr variable">
            <span class="name">secondprocessingdate</span><span class="annotation">: datetime.datetime</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.secondprocessingdate"></a>
    
    

                            </div>
                            <div id="Sample.stockprocessing" class="classattr">
                                <div class="attr variable">
            <span class="name">stockprocessing</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.stockprocessing"></a>
    
    

                            </div>
                            <div id="Sample.stockprocessingdate" class="classattr">
                                <div class="attr variable">
            <span class="name">stockprocessingdate</span><span class="annotation">: datetime.datetime</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.stockprocessingdate"></a>
    
    

                            </div>
                            <div id="Sample.repositiondate" class="classattr">
                                <div class="attr variable">
            <span class="name">repositiondate</span><span class="annotation">: datetime.datetime</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.repositiondate"></a>
    
    

                            </div>
                            <div id="Sample.trial" class="classattr">
                                <div class="attr variable">
            <span class="name">trial</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.trial"></a>
    
    

                            </div>
                            <div id="Sample.type" class="classattr">
                                <div class="attr variable">
            <span class="name">type</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.type"></a>
    
    

                            </div>
                            <div id="Sample.xposition" class="classattr">
                                <div class="attr variable">
            <span class="name">xposition</span><span class="annotation">: int</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.xposition"></a>
    
    

                            </div>
                            <div id="Sample.yposition" class="classattr">
                                <div class="attr variable">
            <span class="name">yposition</span><span class="annotation">: int</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Sample.yposition"></a>
    
    

                            </div>
                            <div id="Sample.cxxkitid" class="classattr">
                                <div class="attr variable">
            <span class="name">cxxkitid</span>

        
    </div>
    <a class="headerlink" href="#Sample.cxxkitid"></a>
    
    

                            </div>
                            <div id="Sample.kitid" class="classattr">
                                <div class="attr variable">
            <span class="name">kitid</span>

        
    </div>
    <a class="headerlink" href="#Sample.kitid"></a>
    
    

                            </div>
                            <div id="Sample.default" class="classattr">
                                        <input id="Sample.default-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">default</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">o</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Sample.default-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sample.default"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sample.default-246"><a href="#Sample.default-246"><span class="linenos">246</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
</span><span id="Sample.default-247"><a href="#Sample.default-247"><span class="linenos">247</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sample.default-248"><a href="#Sample.default-248"><span class="linenos">248</span></a><span class="sd">         default returns the json dict.</span>
</span><span id="Sample.default-249"><a href="#Sample.default-249"><span class="linenos">249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sample.default-250"><a href="#Sample.default-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="vm">__dict__</span>
</span></pre></div>


            <div class="docstring"><p>default returns the json dict.</p>
</div>


                            </div>
                            <div id="Sample.sampleid" class="classattr">
                                        <input id="Sample.sampleid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">sampleid</span>

                <label class="view-source-button" for="Sample.sampleid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sample.sampleid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sample.sampleid-251"><a href="#Sample.sampleid-251"><span class="linenos">251</span></a>    <span class="nd">@property</span>
</span><span id="Sample.sampleid-252"><a href="#Sample.sampleid-252"><span class="linenos">252</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sampleid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sample.sampleid-253"><a href="#Sample.sampleid-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sample.sampleid-254"><a href="#Sample.sampleid-254"><span class="linenos">254</span></a><span class="sd">         sampleid is a shorthand to get the sampleid so it isn&#39;t buried in a</span>
</span><span id="Sample.sampleid-255"><a href="#Sample.sampleid-255"><span class="linenos">255</span></a><span class="sd">         dict when displaying the object as json.</span>
</span><span id="Sample.sampleid-256"><a href="#Sample.sampleid-256"><span class="linenos">256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sample.sampleid-257"><a href="#Sample.sampleid-257"><span class="linenos">257</span></a>        <span class="k">return</span> <span class="s2">&quot;bla&quot;</span> <span class="c1"># self.get_id()</span>
</span></pre></div>


            <div class="docstring"><p>sampleid is a shorthand to get the sampleid so it isn't buried in a
dict when displaying the object as json.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Idable">Idable</a></dt>
                                <dd id="Sample.ids" class="variable"><a href="#Idable.ids">ids</a></dd>
                <dd id="Sample.mainidc" class="variable"><a href="#Idable.mainidc">mainidc</a></dd>
                <dd id="Sample.identifier" class="function"><a href="#Idable.identifier">identifier</a></dd>
                <dd id="Sample.id" class="function"><a href="#Idable.id">id</a></dd>
                <dd id="Sample.iddict" class="function"><a href="#Idable.iddict">iddict</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Patient">
                            <input id="Patient-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Patient</span><wbr>(<span class="base"><a href="#Idable">Idable</a></span>):

                <label class="view-source-button" for="Patient-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Patient"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Patient-267"><a href="#Patient-267"><span class="linenos">267</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Patient</span><span class="p">(</span><span class="n">Idable</span><span class="p">):</span>
</span><span id="Patient-268"><a href="#Patient-268"><span class="linenos">268</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Patient-269"><a href="#Patient-269"><span class="linenos">269</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Patient-270"><a href="#Patient-270"><span class="linenos">270</span></a>      <span class="n">ids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Patient-271"><a href="#Patient-271"><span class="linenos">271</span></a>      <span class="n">orga</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Patient-272"><a href="#Patient-272"><span class="linenos">272</span></a>      <span class="n">pidc</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Patient-273"><a href="#Patient-273"><span class="linenos">273</span></a>    <span class="p">):</span>
</span><span id="Patient-274"><a href="#Patient-274"><span class="linenos">274</span></a>        <span class="n">Idable</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="n">pidc</span><span class="p">)</span>
</span><span id="Patient-275"><a href="#Patient-275"><span class="linenos">275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orga</span> <span class="o">=</span> <span class="n">orga</span>
</span><span id="Patient-276"><a href="#Patient-276"><span class="linenos">276</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Patient-277"><a href="#Patient-277"><span class="linenos">277</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Patient-278"><a href="#Patient-278"><span class="linenos">278</span></a><span class="sd">         __getstate__ returns what gets jsonpickled. include the patientid at the root level, for quicker access.</span>
</span><span id="Patient-279"><a href="#Patient-279"><span class="linenos">279</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Patient-280"><a href="#Patient-280"><span class="linenos">280</span></a>        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># is this slow?</span>
</span><span id="Patient-281"><a href="#Patient-281"><span class="linenos">281</span></a>        <span class="n">state</span><span class="p">[</span><span class="n">patientid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">()</span>
</span><span id="Patient-282"><a href="#Patient-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="n">state</span>
</span></pre></div>


    

                            <div id="Patient.__init__" class="classattr">
                                        <input id="Patient.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Patient</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">orga</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">pidc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Patient.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Patient.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Patient.__init__-268"><a href="#Patient.__init__-268"><span class="linenos">268</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Patient.__init__-269"><a href="#Patient.__init__-269"><span class="linenos">269</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="Patient.__init__-270"><a href="#Patient.__init__-270"><span class="linenos">270</span></a>      <span class="n">ids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Patient.__init__-271"><a href="#Patient.__init__-271"><span class="linenos">271</span></a>      <span class="n">orga</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Patient.__init__-272"><a href="#Patient.__init__-272"><span class="linenos">272</span></a>      <span class="n">pidc</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Patient.__init__-273"><a href="#Patient.__init__-273"><span class="linenos">273</span></a>    <span class="p">):</span>
</span><span id="Patient.__init__-274"><a href="#Patient.__init__-274"><span class="linenos">274</span></a>        <span class="n">Idable</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="n">pidc</span><span class="p">)</span>
</span><span id="Patient.__init__-275"><a href="#Patient.__init__-275"><span class="linenos">275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">orga</span> <span class="o">=</span> <span class="n">orga</span>
</span></pre></div>


            <div class="docstring"><p>__init__ initializes an Idable from a list of Identifiers and a
mainidc string.</p>
</div>


                            </div>
                            <div id="Patient.orga" class="classattr">
                                <div class="attr variable">
            <span class="name">orga</span>

        
    </div>
    <a class="headerlink" href="#Patient.orga"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Idable">Idable</a></dt>
                                <dd id="Patient.ids" class="variable"><a href="#Idable.ids">ids</a></dd>
                <dd id="Patient.mainidc" class="variable"><a href="#Idable.mainidc">mainidc</a></dd>
                <dd id="Patient.identifier" class="function"><a href="#Idable.identifier">identifier</a></dd>
                <dd id="Patient.id" class="function"><a href="#Idable.id">id</a></dd>
                <dd id="Patient.iddict" class="function"><a href="#Idable.iddict">iddict</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Finding">
                            <input id="Finding-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Finding</span>:

                <label class="view-source-button" for="Finding-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Finding"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Finding-283"><a href="#Finding-283"><span class="linenos">283</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Finding</span><span class="p">:</span>
</span><span id="Finding-284"><a href="#Finding-284"><span class="linenos">284</span></a>    <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Finding-285"><a href="#Finding-285"><span class="linenos">285</span></a>    <span class="n">findingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Finding-286"><a href="#Finding-286"><span class="linenos">286</span></a>    <span class="n">methodname</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Finding-287"><a href="#Finding-287"><span class="linenos">287</span></a>    <span class="n">patient</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Finding-288"><a href="#Finding-288"><span class="linenos">288</span></a>    <span class="n">recs</span><span class="p">:</span><span class="nb">map</span><span class="o">=</span><span class="p">{}</span> <span class="c1"># of Rec, by code</span>
</span><span id="Finding-289"><a href="#Finding-289"><span class="linenos">289</span></a>    <span class="n">sample</span><span class="p">:</span><span class="n">Idable</span>
</span><span id="Finding-290"><a href="#Finding-290"><span class="linenos">290</span></a>    <span class="n">sender</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Finding-291"><a href="#Finding-291"><span class="linenos">291</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Finding-292"><a href="#Finding-292"><span class="linenos">292</span></a>        <span class="n">findingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Finding-293"><a href="#Finding-293"><span class="linenos">293</span></a>        <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Finding-294"><a href="#Finding-294"><span class="linenos">294</span></a>        <span class="n">methodname</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Finding-295"><a href="#Finding-295"><span class="linenos">295</span></a>        <span class="n">patient</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>        
</span><span id="Finding-296"><a href="#Finding-296"><span class="linenos">296</span></a>        <span class="n">recs</span><span class="p">:</span><span class="nb">map</span><span class="o">=</span><span class="p">{},</span> <span class="c1"># of Rec, by code</span>
</span><span id="Finding-297"><a href="#Finding-297"><span class="linenos">297</span></a>        <span class="n">sample</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Finding-298"><a href="#Finding-298"><span class="linenos">298</span></a>        <span class="n">sender</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Finding-299"><a href="#Finding-299"><span class="linenos">299</span></a>    <span class="p">):</span>
</span><span id="Finding-300"><a href="#Finding-300"><span class="linenos">300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">findingdate</span> <span class="o">=</span> <span class="n">findingdate</span>
</span><span id="Finding-301"><a href="#Finding-301"><span class="linenos">301</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
</span><span id="Finding-302"><a href="#Finding-302"><span class="linenos">302</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">methodname</span> <span class="o">=</span> <span class="n">methodname</span>
</span><span id="Finding-303"><a href="#Finding-303"><span class="linenos">303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">patient</span> <span class="o">=</span> <span class="n">patient</span>
</span><span id="Finding-304"><a href="#Finding-304"><span class="linenos">304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">recs</span> <span class="o">=</span> <span class="n">recs</span>
</span><span id="Finding-305"><a href="#Finding-305"><span class="linenos">305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sample</span> <span class="o">=</span> <span class="n">sample</span>
</span><span id="Finding-306"><a href="#Finding-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">sender</span>
</span></pre></div>


    

                            <div id="Finding.__init__" class="classattr">
                                        <input id="Finding.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Finding</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">findingdate</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">methodname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">patient</span><span class="p">:</span> <span class="n"><a href="#Idable">Idable</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">recs</span><span class="p">:</span> <span class="nb">map</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">sample</span><span class="p">:</span> <span class="n"><a href="#Idable">Idable</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sender</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Finding.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Finding.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Finding.__init__-291"><a href="#Finding.__init__-291"><span class="linenos">291</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Finding.__init__-292"><a href="#Finding.__init__-292"><span class="linenos">292</span></a>        <span class="n">findingdate</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Finding.__init__-293"><a href="#Finding.__init__-293"><span class="linenos">293</span></a>        <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Finding.__init__-294"><a href="#Finding.__init__-294"><span class="linenos">294</span></a>        <span class="n">methodname</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Finding.__init__-295"><a href="#Finding.__init__-295"><span class="linenos">295</span></a>        <span class="n">patient</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>        
</span><span id="Finding.__init__-296"><a href="#Finding.__init__-296"><span class="linenos">296</span></a>        <span class="n">recs</span><span class="p">:</span><span class="nb">map</span><span class="o">=</span><span class="p">{},</span> <span class="c1"># of Rec, by code</span>
</span><span id="Finding.__init__-297"><a href="#Finding.__init__-297"><span class="linenos">297</span></a>        <span class="n">sample</span><span class="p">:</span><span class="n">Idable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Finding.__init__-298"><a href="#Finding.__init__-298"><span class="linenos">298</span></a>        <span class="n">sender</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Finding.__init__-299"><a href="#Finding.__init__-299"><span class="linenos">299</span></a>    <span class="p">):</span>
</span><span id="Finding.__init__-300"><a href="#Finding.__init__-300"><span class="linenos">300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">findingdate</span> <span class="o">=</span> <span class="n">findingdate</span>
</span><span id="Finding.__init__-301"><a href="#Finding.__init__-301"><span class="linenos">301</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
</span><span id="Finding.__init__-302"><a href="#Finding.__init__-302"><span class="linenos">302</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">methodname</span> <span class="o">=</span> <span class="n">methodname</span>
</span><span id="Finding.__init__-303"><a href="#Finding.__init__-303"><span class="linenos">303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">patient</span> <span class="o">=</span> <span class="n">patient</span>
</span><span id="Finding.__init__-304"><a href="#Finding.__init__-304"><span class="linenos">304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">recs</span> <span class="o">=</span> <span class="n">recs</span>
</span><span id="Finding.__init__-305"><a href="#Finding.__init__-305"><span class="linenos">305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sample</span> <span class="o">=</span> <span class="n">sample</span>
</span><span id="Finding.__init__-306"><a href="#Finding.__init__-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">sender</span>
</span></pre></div>


    

                            </div>
                            <div id="Finding.method" class="classattr">
                                <div class="attr variable">
            <span class="name">method</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Finding.method"></a>
    
    

                            </div>
                            <div id="Finding.findingdate" class="classattr">
                                <div class="attr variable">
            <span class="name">findingdate</span><span class="annotation">: datetime.datetime</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Finding.findingdate"></a>
    
    

                            </div>
                            <div id="Finding.methodname" class="classattr">
                                <div class="attr variable">
            <span class="name">methodname</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Finding.methodname"></a>
    
    

                            </div>
                            <div id="Finding.patient" class="classattr">
                                <div class="attr variable">
            <span class="name">patient</span><span class="annotation">: <a href="#Idable">Idable</a></span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Finding.patient"></a>
    
    

                            </div>
                            <div id="Finding.recs" class="classattr">
                                <div class="attr variable">
            <span class="name">recs</span><span class="annotation">: map</span>        =
<span class="default_value">{}</span>

        
    </div>
    <a class="headerlink" href="#Finding.recs"></a>
    
    

                            </div>
                            <div id="Finding.sample" class="classattr">
                                <div class="attr variable">
            <span class="name">sample</span><span class="annotation">: <a href="#Idable">Idable</a></span>

        
    </div>
    <a class="headerlink" href="#Finding.sample"></a>
    
    

                            </div>
                            <div id="Finding.sender" class="classattr">
                                <div class="attr variable">
            <span class="name">sender</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Finding.sender"></a>
    
    

                            </div>
                </section>
                <section id="Rec">
                            <input id="Rec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Rec</span>:

                <label class="view-source-button" for="Rec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Rec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Rec-308"><a href="#Rec-308"><span class="linenos">308</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Rec</span><span class="p">:</span>
</span><span id="Rec-309"><a href="#Rec-309"><span class="linenos">309</span></a>    <span class="n">method</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Rec-310"><a href="#Rec-310"><span class="linenos">310</span></a>    <span class="n">labval</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Rec-311"><a href="#Rec-311"><span class="linenos">311</span></a>    <span class="nb">type</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Rec-312"><a href="#Rec-312"><span class="linenos">312</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Rec-313"><a href="#Rec-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Rec-314"><a href="#Rec-314"><span class="linenos">314</span></a><span class="sd">         __init__ inits a Rec.</span>
</span><span id="Rec-315"><a href="#Rec-315"><span class="linenos">315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rec-316"><a href="#Rec-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labval</span> <span class="o">=</span> <span class="n">labval</span>
</span></pre></div>


    

                            <div id="Rec.__init__" class="classattr">
                                        <input id="Rec.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Rec</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">labval</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Rec.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Rec.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Rec.__init__-312"><a href="#Rec.__init__-312"><span class="linenos">312</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Rec.__init__-313"><a href="#Rec.__init__-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Rec.__init__-314"><a href="#Rec.__init__-314"><span class="linenos">314</span></a><span class="sd">         __init__ inits a Rec.</span>
</span><span id="Rec.__init__-315"><a href="#Rec.__init__-315"><span class="linenos">315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rec.__init__-316"><a href="#Rec.__init__-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">labval</span> <span class="o">=</span> <span class="n">labval</span>
</span></pre></div>


            <div class="docstring"><p>__init__ inits a Rec.</p>
</div>


                            </div>
                            <div id="Rec.method" class="classattr">
                                <div class="attr variable">
            <span class="name">method</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Rec.method"></a>
    
    

                            </div>
                            <div id="Rec.labval" class="classattr">
                                <div class="attr variable">
            <span class="name">labval</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Rec.labval"></a>
    
    

                            </div>
                            <div id="Rec.type" class="classattr">
                                <div class="attr variable">
            <span class="name">type</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#Rec.type"></a>
    
    

                            </div>
                </section>
                <section id="BooleanRec">
                            <input id="BooleanRec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">BooleanRec</span><wbr>(<span class="base"><a href="#Rec">Rec</a></span>):

                <label class="view-source-button" for="BooleanRec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BooleanRec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BooleanRec-317"><a href="#BooleanRec-317"><span class="linenos">317</span></a><span class="k">class</span><span class="w"> </span><span class="nc">BooleanRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="BooleanRec-318"><a href="#BooleanRec-318"><span class="linenos">318</span></a>    <span class="n">value</span><span class="p">:</span><span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BooleanRec-319"><a href="#BooleanRec-319"><span class="linenos">319</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BooleanRec-320"><a href="#BooleanRec-320"><span class="linenos">320</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BooleanRec-321"><a href="#BooleanRec-321"><span class="linenos">321</span></a><span class="sd">         __init__ inits a BooleanRec.</span>
</span><span id="BooleanRec-322"><a href="#BooleanRec-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BooleanRec-323"><a href="#BooleanRec-323"><span class="linenos">323</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="BooleanRec-324"><a href="#BooleanRec-324"><span class="linenos">324</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span></pre></div>


    

                            <div id="BooleanRec.__init__" class="classattr">
                                        <input id="BooleanRec.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">BooleanRec</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">labval</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="BooleanRec.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BooleanRec.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BooleanRec.__init__-319"><a href="#BooleanRec.__init__-319"><span class="linenos">319</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BooleanRec.__init__-320"><a href="#BooleanRec.__init__-320"><span class="linenos">320</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BooleanRec.__init__-321"><a href="#BooleanRec.__init__-321"><span class="linenos">321</span></a><span class="sd">         __init__ inits a BooleanRec.</span>
</span><span id="BooleanRec.__init__-322"><a href="#BooleanRec.__init__-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BooleanRec.__init__-323"><a href="#BooleanRec.__init__-323"><span class="linenos">323</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="BooleanRec.__init__-324"><a href="#BooleanRec.__init__-324"><span class="linenos">324</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>__init__ inits a BooleanRec.</p>
</div>


                            </div>
                            <div id="BooleanRec.value" class="classattr">
                                <div class="attr variable">
            <span class="name">value</span><span class="annotation">: bool</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BooleanRec.value"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Rec">Rec</a></dt>
                                <dd id="BooleanRec.method" class="variable"><a href="#Rec.method">method</a></dd>
                <dd id="BooleanRec.labval" class="variable"><a href="#Rec.labval">labval</a></dd>
                <dd id="BooleanRec.type" class="variable"><a href="#Rec.type">type</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="NumberRec">
                            <input id="NumberRec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">NumberRec</span><wbr>(<span class="base"><a href="#Rec">Rec</a></span>):

                <label class="view-source-button" for="NumberRec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NumberRec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NumberRec-325"><a href="#NumberRec-325"><span class="linenos">325</span></a><span class="k">class</span><span class="w"> </span><span class="nc">NumberRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="NumberRec-326"><a href="#NumberRec-326"><span class="linenos">326</span></a>    <span class="n">value</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="NumberRec-327"><a href="#NumberRec-327"><span class="linenos">327</span></a>    <span class="n">unit</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="NumberRec-328"><a href="#NumberRec-328"><span class="linenos">328</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="NumberRec-329"><a href="#NumberRec-329"><span class="linenos">329</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NumberRec-330"><a href="#NumberRec-330"><span class="linenos">330</span></a><span class="sd">         __init__ inits a NumberRec.</span>
</span><span id="NumberRec-331"><a href="#NumberRec-331"><span class="linenos">331</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NumberRec-332"><a href="#NumberRec-332"><span class="linenos">332</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="NumberRec-333"><a href="#NumberRec-333"><span class="linenos">333</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="NumberRec-334"><a href="#NumberRec-334"><span class="linenos">334</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>
</span></pre></div>


    

                            <div id="NumberRec.__init__" class="classattr">
                                        <input id="NumberRec.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">NumberRec</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">labval</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="NumberRec.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NumberRec.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NumberRec.__init__-328"><a href="#NumberRec.__init__-328"><span class="linenos">328</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="NumberRec.__init__-329"><a href="#NumberRec.__init__-329"><span class="linenos">329</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NumberRec.__init__-330"><a href="#NumberRec.__init__-330"><span class="linenos">330</span></a><span class="sd">         __init__ inits a NumberRec.</span>
</span><span id="NumberRec.__init__-331"><a href="#NumberRec.__init__-331"><span class="linenos">331</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NumberRec.__init__-332"><a href="#NumberRec.__init__-332"><span class="linenos">332</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="NumberRec.__init__-333"><a href="#NumberRec.__init__-333"><span class="linenos">333</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="NumberRec.__init__-334"><a href="#NumberRec.__init__-334"><span class="linenos">334</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>
</span></pre></div>


            <div class="docstring"><p>__init__ inits a NumberRec.</p>
</div>


                            </div>
                            <div id="NumberRec.value" class="classattr">
                                <div class="attr variable">
            <span class="name">value</span><span class="annotation">: float</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#NumberRec.value"></a>
    
    

                            </div>
                            <div id="NumberRec.unit" class="classattr">
                                <div class="attr variable">
            <span class="name">unit</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#NumberRec.unit"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Rec">Rec</a></dt>
                                <dd id="NumberRec.method" class="variable"><a href="#Rec.method">method</a></dd>
                <dd id="NumberRec.labval" class="variable"><a href="#Rec.labval">labval</a></dd>
                <dd id="NumberRec.type" class="variable"><a href="#Rec.type">type</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StringRec">
                            <input id="StringRec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">StringRec</span><wbr>(<span class="base"><a href="#Rec">Rec</a></span>):

                <label class="view-source-button" for="StringRec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StringRec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StringRec-335"><a href="#StringRec-335"><span class="linenos">335</span></a><span class="k">class</span><span class="w"> </span><span class="nc">StringRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="StringRec-336"><a href="#StringRec-336"><span class="linenos">336</span></a>    <span class="n">value</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="StringRec-337"><a href="#StringRec-337"><span class="linenos">337</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="StringRec-338"><a href="#StringRec-338"><span class="linenos">338</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StringRec-339"><a href="#StringRec-339"><span class="linenos">339</span></a><span class="sd">         __init__ inits a StringRec.</span>
</span><span id="StringRec-340"><a href="#StringRec-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StringRec-341"><a href="#StringRec-341"><span class="linenos">341</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="StringRec-342"><a href="#StringRec-342"><span class="linenos">342</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span></pre></div>


    

                            <div id="StringRec.__init__" class="classattr">
                                        <input id="StringRec.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">StringRec</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">labval</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="StringRec.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StringRec.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StringRec.__init__-337"><a href="#StringRec.__init__-337"><span class="linenos">337</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="StringRec.__init__-338"><a href="#StringRec.__init__-338"><span class="linenos">338</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StringRec.__init__-339"><a href="#StringRec.__init__-339"><span class="linenos">339</span></a><span class="sd">         __init__ inits a StringRec.</span>
</span><span id="StringRec.__init__-340"><a href="#StringRec.__init__-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StringRec.__init__-341"><a href="#StringRec.__init__-341"><span class="linenos">341</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="StringRec.__init__-342"><a href="#StringRec.__init__-342"><span class="linenos">342</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>__init__ inits a StringRec.</p>
</div>


                            </div>
                            <div id="StringRec.value" class="classattr">
                                <div class="attr variable">
            <span class="name">value</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#StringRec.value"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Rec">Rec</a></dt>
                                <dd id="StringRec.method" class="variable"><a href="#Rec.method">method</a></dd>
                <dd id="StringRec.labval" class="variable"><a href="#Rec.labval">labval</a></dd>
                <dd id="StringRec.type" class="variable"><a href="#Rec.type">type</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="DateRec">
                            <input id="DateRec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DateRec</span><wbr>(<span class="base"><a href="#Rec">Rec</a></span>):

                <label class="view-source-button" for="DateRec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DateRec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DateRec-343"><a href="#DateRec-343"><span class="linenos">343</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DateRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="DateRec-344"><a href="#DateRec-344"><span class="linenos">344</span></a>    <span class="n">value</span><span class="p">:</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DateRec-345"><a href="#DateRec-345"><span class="linenos">345</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DateRec-346"><a href="#DateRec-346"><span class="linenos">346</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DateRec-347"><a href="#DateRec-347"><span class="linenos">347</span></a><span class="sd">         __init__ inits a DateRec.</span>
</span><span id="DateRec-348"><a href="#DateRec-348"><span class="linenos">348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DateRec-349"><a href="#DateRec-349"><span class="linenos">349</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="DateRec-350"><a href="#DateRec-350"><span class="linenos">350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span></pre></div>


    

                            <div id="DateRec.__init__" class="classattr">
                                        <input id="DateRec.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DateRec</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">labval</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">value</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="DateRec.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DateRec.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DateRec.__init__-345"><a href="#DateRec.__init__-345"><span class="linenos">345</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span><span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DateRec.__init__-346"><a href="#DateRec.__init__-346"><span class="linenos">346</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DateRec.__init__-347"><a href="#DateRec.__init__-347"><span class="linenos">347</span></a><span class="sd">         __init__ inits a DateRec.</span>
</span><span id="DateRec.__init__-348"><a href="#DateRec.__init__-348"><span class="linenos">348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DateRec.__init__-349"><a href="#DateRec.__init__-349"><span class="linenos">349</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="DateRec.__init__-350"><a href="#DateRec.__init__-350"><span class="linenos">350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>__init__ inits a DateRec.</p>
</div>


                            </div>
                            <div id="DateRec.value" class="classattr">
                                <div class="attr variable">
            <span class="name">value</span><span class="annotation">: datetime.datetime</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#DateRec.value"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Rec">Rec</a></dt>
                                <dd id="DateRec.method" class="variable"><a href="#Rec.method">method</a></dd>
                <dd id="DateRec.labval" class="variable"><a href="#Rec.labval">labval</a></dd>
                <dd id="DateRec.type" class="variable"><a href="#Rec.type">type</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="CatalogRec">
                            <input id="CatalogRec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CatalogRec</span><wbr>(<span class="base"><a href="#Rec">Rec</a></span>):

                <label class="view-source-button" for="CatalogRec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CatalogRec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CatalogRec-351"><a href="#CatalogRec-351"><span class="linenos">351</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CatalogRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="CatalogRec-352"><a href="#CatalogRec-352"><span class="linenos">352</span></a>    <span class="n">values</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CatalogRec-353"><a href="#CatalogRec-353"><span class="linenos">353</span></a>    <span class="n">catalog</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CatalogRec-354"><a href="#CatalogRec-354"><span class="linenos">354</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="CatalogRec-355"><a href="#CatalogRec-355"><span class="linenos">355</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CatalogRec-356"><a href="#CatalogRec-356"><span class="linenos">356</span></a><span class="sd">         __init__ inits a CatalogRec.</span>
</span><span id="CatalogRec-357"><a href="#CatalogRec-357"><span class="linenos">357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CatalogRec-358"><a href="#CatalogRec-358"><span class="linenos">358</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="CatalogRec-359"><a href="#CatalogRec-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
</span><span id="CatalogRec-360"><a href="#CatalogRec-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="n">catalog</span>
</span></pre></div>


    

                            <div id="CatalogRec.__init__" class="classattr">
                                        <input id="CatalogRec.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CatalogRec</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">labval</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">values</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="CatalogRec.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CatalogRec.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CatalogRec.__init__-354"><a href="#CatalogRec.__init__-354"><span class="linenos">354</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="CatalogRec.__init__-355"><a href="#CatalogRec.__init__-355"><span class="linenos">355</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CatalogRec.__init__-356"><a href="#CatalogRec.__init__-356"><span class="linenos">356</span></a><span class="sd">         __init__ inits a CatalogRec.</span>
</span><span id="CatalogRec.__init__-357"><a href="#CatalogRec.__init__-357"><span class="linenos">357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CatalogRec.__init__-358"><a href="#CatalogRec.__init__-358"><span class="linenos">358</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="CatalogRec.__init__-359"><a href="#CatalogRec.__init__-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
</span><span id="CatalogRec.__init__-360"><a href="#CatalogRec.__init__-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="n">catalog</span>
</span></pre></div>


            <div class="docstring"><p>__init__ inits a CatalogRec.</p>
</div>


                            </div>
                            <div id="CatalogRec.values" class="classattr">
                                <div class="attr variable">
            <span class="name">values</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#CatalogRec.values"></a>
    
    

                            </div>
                            <div id="CatalogRec.catalog" class="classattr">
                                <div class="attr variable">
            <span class="name">catalog</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#CatalogRec.catalog"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Rec">Rec</a></dt>
                                <dd id="CatalogRec.method" class="variable"><a href="#Rec.method">method</a></dd>
                <dd id="CatalogRec.labval" class="variable"><a href="#Rec.labval">labval</a></dd>
                <dd id="CatalogRec.type" class="variable"><a href="#Rec.type">type</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MultiRec">
                            <input id="MultiRec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MultiRec</span><wbr>(<span class="base"><a href="#Rec">Rec</a></span>):

                <label class="view-source-button" for="MultiRec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MultiRec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MultiRec-361"><a href="#MultiRec-361"><span class="linenos">361</span></a><span class="k">class</span><span class="w"> </span><span class="nc">MultiRec</span><span class="p">(</span><span class="n">Rec</span><span class="p">):</span>
</span><span id="MultiRec-362"><a href="#MultiRec-362"><span class="linenos">362</span></a>    <span class="n">values</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MultiRec-363"><a href="#MultiRec-363"><span class="linenos">363</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="MultiRec-364"><a href="#MultiRec-364"><span class="linenos">364</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MultiRec-365"><a href="#MultiRec-365"><span class="linenos">365</span></a><span class="sd">         __init__ inits a MultiRec.</span>
</span><span id="MultiRec-366"><a href="#MultiRec-366"><span class="linenos">366</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MultiRec-367"><a href="#MultiRec-367"><span class="linenos">367</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="MultiRec-368"><a href="#MultiRec-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
</span></pre></div>


    

                            <div id="MultiRec.__init__" class="classattr">
                                        <input id="MultiRec.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MultiRec</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">labval</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">values</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="MultiRec.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MultiRec.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MultiRec.__init__-363"><a href="#MultiRec.__init__-363"><span class="linenos">363</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labval</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="MultiRec.__init__-364"><a href="#MultiRec.__init__-364"><span class="linenos">364</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MultiRec.__init__-365"><a href="#MultiRec.__init__-365"><span class="linenos">365</span></a><span class="sd">         __init__ inits a MultiRec.</span>
</span><span id="MultiRec.__init__-366"><a href="#MultiRec.__init__-366"><span class="linenos">366</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MultiRec.__init__-367"><a href="#MultiRec.__init__-367"><span class="linenos">367</span></a>        <span class="n">Rec</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labval</span><span class="o">=</span><span class="n">labval</span><span class="p">)</span>
</span><span id="MultiRec.__init__-368"><a href="#MultiRec.__init__-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
</span></pre></div>


            <div class="docstring"><p>__init__ inits a MultiRec.</p>
</div>


                            </div>
                            <div id="MultiRec.values" class="classattr">
                                <div class="attr variable">
            <span class="name">values</span><span class="annotation">: str</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#MultiRec.values"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Rec">Rec</a></dt>
                                <dd id="MultiRec.method" class="variable"><a href="#Rec.method">method</a></dd>
                <dd id="MultiRec.labval" class="variable"><a href="#Rec.labval">labval</a></dd>
                <dd id="MultiRec.type" class="variable"><a href="#Rec.type">type</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="idable_csv">
                            <input id="idable_csv-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">idable_csv</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">idables</span><span class="p">:</span> <span class="nb">list</span>, </span><span class="param"><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="o">*</span><span class="n">idcs</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="idable_csv-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#idable_csv"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="idable_csv-370"><a href="#idable_csv-370"><span class="linenos">370</span></a><span class="k">def</span><span class="w"> </span><span class="nf">idable_csv</span><span class="p">(</span><span class="n">idables</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">idcs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="idable_csv-371"><a href="#idable_csv-371"><span class="linenos">371</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="idable_csv-372"><a href="#idable_csv-372"><span class="linenos">372</span></a><span class="sd">     idable_csv writes a list of Idables to the given csv file. the given</span>
</span><span id="idable_csv-373"><a href="#idable_csv-373"><span class="linenos">373</span></a><span class="sd">     idcontainers are included as columns. if no idcontainers are given, all</span>
</span><span id="idable_csv-374"><a href="#idable_csv-374"><span class="linenos">374</span></a><span class="sd">     are included.</span>
</span><span id="idable_csv-375"><a href="#idable_csv-375"><span class="linenos">375</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="idable_csv-376"><a href="#idable_csv-376"><span class="linenos">376</span></a>    <span class="k">if</span> <span class="n">idables</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">idables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># todo throw error?</span>
</span><span id="idable_csv-377"><a href="#idable_csv-377"><span class="linenos">377</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no idables&quot;</span><span class="p">)</span>
</span><span id="idable_csv-378"><a href="#idable_csv-378"><span class="linenos">378</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="idable_csv-379"><a href="#idable_csv-379"><span class="linenos">379</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="idable_csv-380"><a href="#idable_csv-380"><span class="linenos">380</span></a>        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="idable_csv-381"><a href="#idable_csv-381"><span class="linenos">381</span></a>        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">idables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iddict</span><span class="p">(</span><span class="o">*</span><span class="n">idcs</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="idable_csv-382"><a href="#idable_csv-382"><span class="linenos">382</span></a>        <span class="k">for</span> <span class="n">idable</span> <span class="ow">in</span> <span class="n">idables</span><span class="p">:</span>
</span><span id="idable_csv-383"><a href="#idable_csv-383"><span class="linenos">383</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="n">idable</span><span class="o">.</span><span class="n">iddict</span><span class="p">()</span>
</span><span id="idable_csv-384"><a href="#idable_csv-384"><span class="linenos">384</span></a>            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</span><span id="idable_csv-385"><a href="#idable_csv-385"><span class="linenos">385</span></a>    <span class="k">return</span> <span class="n">filename</span>
</span></pre></div>


            <div class="docstring"><p>idable_csv writes a list of Idables to the given csv file. the given
idcontainers are included as columns. if no idcontainers are given, all
are included.</p>
</div>


                </section>
                <section id="traction">
                            <input id="traction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">traction</span>:

                <label class="view-source-button" for="traction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#traction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="traction-387"><a href="#traction-387"><span class="linenos"> 387</span></a><span class="k">class</span><span class="w"> </span><span class="nc">traction</span><span class="p">:</span>
</span><span id="traction-388"><a href="#traction-388"><span class="linenos"> 388</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
</span><span id="traction-389"><a href="#traction-389"><span class="linenos"> 389</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-390"><a href="#traction-390"><span class="linenos"> 390</span></a><span class="sd">         __init__ takes the db target either as string or dbcq object.</span>
</span><span id="traction-391"><a href="#traction-391"><span class="linenos"> 391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-392"><a href="#traction-392"><span class="linenos"> 392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">cnf</span><span class="o">.</span><span class="n">makeload</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;.traction/settings.yaml&quot;</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">cnf</span><span class="o">.</span><span class="n">home</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;yaml&quot;</span><span class="p">,</span> <span class="n">make</span><span class="o">=</span><span class="n">cnftemplate</span><span class="p">)</span>        
</span><span id="traction-393"><a href="#traction-393"><span class="linenos"> 393</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-394"><a href="#traction-394"><span class="linenos"> 394</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;no settings.&quot;</span><span class="p">)</span>
</span><span id="traction-395"><a href="#traction-395"><span class="linenos"> 395</span></a>            <span class="k">return</span>
</span><span id="traction-396"><a href="#traction-396"><span class="linenos"> 396</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="traction-397"><a href="#traction-397"><span class="linenos"> 397</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">dbcq</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="traction-398"><a href="#traction-398"><span class="linenos"> 398</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">dbcq</span><span class="p">):</span> 
</span><span id="traction-399"><a href="#traction-399"><span class="linenos"> 399</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">target</span>
</span><span id="traction-400"><a href="#traction-400"><span class="linenos"> 400</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="traction-401"><a href="#traction-401"><span class="linenos"> 401</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;target needs to be string or dbcq instance&quot;</span><span class="p">)</span>
</span><span id="traction-402"><a href="#traction-402"><span class="linenos"> 402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idcinit</span><span class="p">()</span>
</span><span id="traction-403"><a href="#traction-403"><span class="linenos"> 403</span></a>        <span class="c1">#print(f&quot;_idcoids: {self._idcoids}&quot;)</span>
</span><span id="traction-404"><a href="#traction-404"><span class="linenos"> 404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">jd</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction-405"><a href="#traction-405"><span class="linenos"> 405</span></a>            <span class="s2">&quot;sample_to_samplekit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;left join centraxx_samplekititem as samplekititem on samplekititem.tubebarcode = idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn&quot;</span><span class="p">,</span> <span class="s2">&quot;left join centraxx_samplekit as samplekit on samplekit.oid = samplekititem.samplekit&quot;</span><span class="p">],</span>
</span><span id="traction-406"><a href="#traction-406"><span class="linenos"> 406</span></a>            <span class="s2">&quot;sample_to_parentid&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;left join centraxx_sampleidcontainer parentidc on parentidc.sample = sample.parent and parentidc.idcontainertype=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_idcoid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span>
</span><span id="traction-407"><a href="#traction-407"><span class="linenos"> 407</span></a>            <span class="s2">&quot;sample_to_samplelocation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_samplelocation samplelocation on samplelocation.oid = sample.samplelocation&quot;</span><span class="p">],</span>
</span><span id="traction-408"><a href="#traction-408"><span class="linenos"> 408</span></a>            <span class="s2">&quot;sample_to_sampletype&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_sampletype as sampletype on sampletype.oid = sample.sampletype&quot;</span><span class="p">],</span>
</span><span id="traction-409"><a href="#traction-409"><span class="linenos"> 409</span></a>            <span class="s2">&quot;sample_to_stockprocessing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_stockprocessing as stockprocessing on sample.stockprocessing = stockprocessing.oid&quot;</span><span class="p">],</span>
</span><span id="traction-410"><a href="#traction-410"><span class="linenos"> 410</span></a>            <span class="s2">&quot;sample_to_secondprocessing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_stockprocessing as secondprocessing on sample.secondprocessing = secondprocessing.oid&quot;</span><span class="p">],</span>
</span><span id="traction-411"><a href="#traction-411"><span class="linenos"> 411</span></a>            <span class="s2">&quot;sample_to_project&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_project as project on sample.project = project.oid&quot;</span><span class="p">],</span>
</span><span id="traction-412"><a href="#traction-412"><span class="linenos"> 412</span></a>            <span class="s2">&quot;sample_to_patient&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_patientcontainer as patientcontainer on sample.patientcontainer = patientcontainer.oid&quot;</span><span class="p">],</span>
</span><span id="traction-413"><a href="#traction-413"><span class="linenos"> 413</span></a>            <span class="s2">&quot;sample_to_receptacle&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_samplereceptable as receptable on sample.receptable = receptable.oid&quot;</span><span class="p">],</span> <span class="c1"># receptable seems to be a typo in the table naming</span>
</span><span id="traction-414"><a href="#traction-414"><span class="linenos"> 414</span></a>            <span class="s2">&quot;sample_to_orga&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_organisationunit as organisationunit on sample.orgunit = organisationunit.oid&quot;</span><span class="p">],</span>
</span><span id="traction-415"><a href="#traction-415"><span class="linenos"> 415</span></a>            <span class="s2">&quot;sample_to_trial&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_flexistudy as flexistudy on sample.flexistudy = flexistudy.oid&quot;</span><span class="p">]</span>
</span><span id="traction-416"><a href="#traction-416"><span class="linenos"> 416</span></a>            <span class="p">,</span>
</span><span id="traction-417"><a href="#traction-417"><span class="linenos"> 417</span></a>            <span class="s2">&quot;patient_to_orga&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_patientorgunit patientorgunit on patientcontainer.oid=patientorgunit.patientcontainer_oid&quot;</span><span class="p">,</span> <span class="s2">&quot;left join centraxx_organisationunit organisationunit on patientorgunit.orgunit_oid=organisationunit.oid&quot;</span><span class="p">],</span>
</span><span id="traction-418"><a href="#traction-418"><span class="linenos"> 418</span></a>            <span class="s2">&quot;patient_to_trial&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_patientstudy as patientstudy on patientstudy.patientcontainer = patientcontainer.oid&quot;</span><span class="p">,</span> <span class="s2">&quot;left join centraxx_flexistudy as flexistudy on flexistudy.oid = patientstudy.flexistudy&quot;</span><span class="p">],</span>
</span><span id="traction-419"><a href="#traction-419"><span class="linenos"> 419</span></a>            <span class="s2">&quot;patient_to_sample&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_sample sample on sample.patientcontainer = patientcontainer.oid&quot;</span><span class="p">]</span>
</span><span id="traction-420"><a href="#traction-420"><span class="linenos"> 420</span></a>        <span class="p">}</span>
</span><span id="traction-421"><a href="#traction-421"><span class="linenos"> 421</span></a>
</span><span id="traction-422"><a href="#traction-422"><span class="linenos"> 422</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampleids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patientids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parentids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parentoids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">locationpaths</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kitids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cxxkitids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">categories</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">samplingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">receiptdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">derivaldates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">first_repositiondates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">repositiondates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stockprocessingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">secondprocessingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">primaryref</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incl_parents</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incl_childs</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incl_tree</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="p">[],</span> <span class="n">missing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_query</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">raw</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="traction-423"><a href="#traction-423"><span class="linenos"> 423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-424"><a href="#traction-424"><span class="linenos"> 424</span></a><span class="sd">         sample gets sample(s) and returns them as a list of Sample instances.</span>
</span><span id="traction-425"><a href="#traction-425"><span class="linenos"> 425</span></a><span class="sd">         </span>
</span><span id="traction-426"><a href="#traction-426"><span class="linenos"> 426</span></a><span class="sd">         pass sampleids and other values to filter for as lists of strings,</span>
</span><span id="traction-427"><a href="#traction-427"><span class="linenos"> 427</span></a><span class="sd">         e.g. `sampleids=[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]`.</span>
</span><span id="traction-428"><a href="#traction-428"><span class="linenos"> 428</span></a><span class="sd">         </span>
</span><span id="traction-429"><a href="#traction-429"><span class="linenos"> 429</span></a><span class="sd">         use the idc param to filter for idcontainer lists by passing a dict of</span>
</span><span id="traction-430"><a href="#traction-430"><span class="linenos"> 430</span></a><span class="sd">         lists keyed by idcontainer code, e.g. `idc={&quot;extsampleid&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]}`.</span>
</span><span id="traction-431"><a href="#traction-431"><span class="linenos"> 431</span></a><span class="sd">         </span>
</span><span id="traction-432"><a href="#traction-432"><span class="linenos"> 432</span></a><span class="sd">         put info that should be joined into the result into the verbose array,</span>
</span><span id="traction-433"><a href="#traction-433"><span class="linenos"> 433</span></a><span class="sd">         e.g.  `verbose=[tr.locationpath]`. to join in everything, say</span>
</span><span id="traction-434"><a href="#traction-434"><span class="linenos"> 434</span></a><span class="sd">         `verbose_all=True`. this is slower than non-verbose.</span>
</span><span id="traction-435"><a href="#traction-435"><span class="linenos"> 435</span></a><span class="sd">         </span>
</span><span id="traction-436"><a href="#traction-436"><span class="linenos"> 436</span></a><span class="sd">         pass dates as a tuple of from and to datetime, e.g. `samplingdates=(datefrom, None)`.</span>
</span><span id="traction-437"><a href="#traction-437"><span class="linenos"> 437</span></a><span class="sd">         </span>
</span><span id="traction-438"><a href="#traction-438"><span class="linenos"> 438</span></a><span class="sd">         to check via like as opposed to exact, put the respective fields into</span>
</span><span id="traction-439"><a href="#traction-439"><span class="linenos"> 439</span></a><span class="sd">         the like array, e.g. `like=[tr.locationpath]`.</span>
</span><span id="traction-440"><a href="#traction-440"><span class="linenos"> 440</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-441"><a href="#traction-441"><span class="linenos"> 441</span></a>        <span class="c1"># print(&quot;try:&quot; + tr.sampleid)</span>
</span><span id="traction-442"><a href="#traction-442"><span class="linenos"> 442</span></a>        <span class="n">vaa</span> <span class="o">=</span> <span class="p">[</span><span class="n">cxxkitid</span><span class="p">,</span> <span class="n">kitid</span><span class="p">,</span> <span class="n">locationname</span><span class="p">,</span> <span class="n">locationpath</span><span class="p">,</span> <span class="n">orga</span><span class="p">,</span> <span class="n">parentid</span><span class="p">,</span> 
</span><span id="traction-443"><a href="#traction-443"><span class="linenos"> 443</span></a>               <span class="n">project</span><span class="p">,</span> <span class="n">receptacle</span><span class="p">,</span> <span class="n">sampletype</span><span class="p">,</span>
</span><span id="traction-444"><a href="#traction-444"><span class="linenos"> 444</span></a>               <span class="n">secondprocessing</span><span class="p">,</span> <span class="n">stockprocessing</span><span class="p">,</span> <span class="n">trial</span><span class="p">]</span>
</span><span id="traction-445"><a href="#traction-445"><span class="linenos"> 445</span></a>        <span class="n">vaa</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">())</span>
</span><span id="traction-446"><a href="#traction-446"><span class="linenos"> 446</span></a>        <span class="n">vaa</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sampleidcs</span><span class="p">())</span>                
</span><span id="traction-447"><a href="#traction-447"><span class="linenos"> 447</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="traction-448"><a href="#traction-448"><span class="linenos"> 448</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="traction-449"><a href="#traction-449"><span class="linenos"> 449</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concrete_idcs</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="traction-450"><a href="#traction-450"><span class="linenos"> 450</span></a>        <span class="k">if</span> <span class="n">trials</span><span class="p">:</span>
</span><span id="traction-451"><a href="#traction-451"><span class="linenos"> 451</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span>
</span><span id="traction-452"><a href="#traction-452"><span class="linenos"> 452</span></a>        <span class="k">if</span> <span class="n">locationpaths</span><span class="p">:</span>
</span><span id="traction-453"><a href="#traction-453"><span class="linenos"> 453</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">locationpath</span><span class="p">)</span>
</span><span id="traction-454"><a href="#traction-454"><span class="linenos"> 454</span></a>        <span class="k">if</span> <span class="n">kitids</span><span class="p">:</span>
</span><span id="traction-455"><a href="#traction-455"><span class="linenos"> 455</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kitid</span><span class="p">)</span>
</span><span id="traction-456"><a href="#traction-456"><span class="linenos"> 456</span></a>        <span class="k">if</span> <span class="n">cxxkitid</span><span class="p">:</span>
</span><span id="traction-457"><a href="#traction-457"><span class="linenos"> 457</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cxxkitid</span><span class="p">)</span>
</span><span id="traction-458"><a href="#traction-458"><span class="linenos"> 458</span></a>        <span class="k">if</span> <span class="n">parentids</span><span class="p">:</span>
</span><span id="traction-459"><a href="#traction-459"><span class="linenos"> 459</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parentid</span><span class="p">)</span>
</span><span id="traction-460"><a href="#traction-460"><span class="linenos"> 460</span></a>        <span class="k">if</span> <span class="n">verbose_all</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="traction-461"><a href="#traction-461"><span class="linenos"> 461</span></a>            <span class="n">verbose</span> <span class="o">=</span> <span class="n">vaa</span>
</span><span id="traction-462"><a href="#traction-462"><span class="linenos"> 462</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">_checkverbose</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="n">vaa</span><span class="p">):</span> 
</span><span id="traction-463"><a href="#traction-463"><span class="linenos"> 463</span></a>            <span class="k">return</span> <span class="kc">None</span> <span class="c1"># throw error?</span>
</span><span id="traction-464"><a href="#traction-464"><span class="linenos"> 464</span></a>        <span class="k">if</span> <span class="n">incl_parents</span> <span class="ow">or</span> <span class="n">incl_childs</span> <span class="ow">or</span> <span class="n">incl_tree</span> <span class="ow">or</span> <span class="n">primaryref</span><span class="p">:</span>
</span><span id="traction-465"><a href="#traction-465"><span class="linenos"> 465</span></a>            <span class="n">verbosepass</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-466"><a href="#traction-466"><span class="linenos"> 466</span></a>            <span class="k">if</span> <span class="n">primaryref</span><span class="p">:</span>
</span><span id="traction-467"><a href="#traction-467"><span class="linenos"> 467</span></a>                <span class="n">verbosepass</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="traction-468"><a href="#traction-468"><span class="linenos"> 468</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sampleids</span><span class="o">=</span><span class="n">sampleids</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">parentids</span><span class="o">=</span><span class="n">parentids</span><span class="p">,</span> <span class="n">parentoids</span><span class="o">=</span><span class="n">parentoids</span><span class="p">,</span> <span class="n">patientids</span><span class="o">=</span><span class="n">patientids</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">,</span> <span class="n">locationpaths</span><span class="o">=</span><span class="n">locationpaths</span><span class="p">,</span> <span class="n">kitids</span><span class="o">=</span><span class="n">kitids</span><span class="p">,</span> <span class="n">cxxkitids</span><span class="o">=</span><span class="n">cxxkitids</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">samplingdates</span><span class="o">=</span><span class="n">samplingdates</span><span class="p">,</span> <span class="n">receiptdates</span><span class="o">=</span><span class="n">receiptdates</span><span class="p">,</span> <span class="n">derivaldates</span><span class="o">=</span><span class="n">derivaldates</span><span class="p">,</span> <span class="n">first_repositiondates</span><span class="o">=</span><span class="n">first_repositiondates</span><span class="p">,</span> <span class="n">repositiondates</span><span class="o">=</span><span class="n">repositiondates</span><span class="p">,</span> <span class="n">stockprocessingdates</span><span class="o">=</span><span class="n">stockprocessingdates</span><span class="p">,</span> <span class="n">secondprocessingdates</span><span class="o">=</span><span class="n">secondprocessingdates</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbosepass</span><span class="p">,</span> <span class="n">verbose_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="n">missing</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="n">order_by</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span> <span class="n">print_query</span><span class="o">=</span><span class="n">print_query</span><span class="p">)</span>
</span><span id="traction-469"><a href="#traction-469"><span class="linenos"> 469</span></a>            <span class="k">if</span> <span class="n">primaryref</span><span class="p">:</span>
</span><span id="traction-470"><a href="#traction-470"><span class="linenos"> 470</span></a>                <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction-471"><a href="#traction-471"><span class="linenos"> 471</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_fill_in_primary</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="traction-472"><a href="#traction-472"><span class="linenos"> 472</span></a>                <span class="k">return</span> <span class="n">res</span>
</span><span id="traction-473"><a href="#traction-473"><span class="linenos"> 473</span></a>            
</span><span id="traction-474"><a href="#traction-474"><span class="linenos"> 474</span></a>            <span class="n">s_oids</span> <span class="o">=</span> <span class="n">get_ids</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">)</span>
</span><span id="traction-475"><a href="#traction-475"><span class="linenos"> 475</span></a>            <span class="n">withincl</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-476"><a href="#traction-476"><span class="linenos"> 476</span></a>            <span class="k">for</span> <span class="n">s_oid</span> <span class="ow">in</span> <span class="n">s_oids</span><span class="p">:</span>
</span><span id="traction-477"><a href="#traction-477"><span class="linenos"> 477</span></a>               <span class="k">if</span> <span class="n">incl_parents</span><span class="p">:</span>
</span><span id="traction-478"><a href="#traction-478"><span class="linenos"> 478</span></a>                   <span class="n">p_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-479"><a href="#traction-479"><span class="linenos"> 479</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_parents</span><span class="p">(</span><span class="n">s_oid</span><span class="p">,</span> <span class="n">p_oids</span><span class="p">)</span>
</span><span id="traction-480"><a href="#traction-480"><span class="linenos"> 480</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">p_oids</span><span class="p">)</span>
</span><span id="traction-481"><a href="#traction-481"><span class="linenos"> 481</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_oid</span><span class="p">)</span>
</span><span id="traction-482"><a href="#traction-482"><span class="linenos"> 482</span></a>               <span class="k">if</span> <span class="n">incl_childs</span><span class="p">:</span>
</span><span id="traction-483"><a href="#traction-483"><span class="linenos"> 483</span></a>                   <span class="n">c_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-484"><a href="#traction-484"><span class="linenos"> 484</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_childs</span><span class="p">(</span><span class="n">s_oid</span><span class="p">,</span> <span class="n">c_oids</span><span class="p">)</span>
</span><span id="traction-485"><a href="#traction-485"><span class="linenos"> 485</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_oid</span><span class="p">)</span>
</span><span id="traction-486"><a href="#traction-486"><span class="linenos"> 486</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c_oids</span><span class="p">)</span>
</span><span id="traction-487"><a href="#traction-487"><span class="linenos"> 487</span></a>               <span class="k">if</span> <span class="n">incl_tree</span><span class="p">:</span>
</span><span id="traction-488"><a href="#traction-488"><span class="linenos"> 488</span></a>                   <span class="n">p_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-489"><a href="#traction-489"><span class="linenos"> 489</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_parents</span><span class="p">(</span><span class="n">s_oid</span><span class="p">,</span> <span class="n">p_oids</span><span class="p">)</span>
</span><span id="traction-490"><a href="#traction-490"><span class="linenos"> 490</span></a>                   <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_oids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="traction-491"><a href="#traction-491"><span class="linenos"> 491</span></a>                       <span class="n">root</span> <span class="o">=</span> <span class="n">p_oids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="traction-492"><a href="#traction-492"><span class="linenos"> 492</span></a>                   <span class="k">else</span><span class="p">:</span>
</span><span id="traction-493"><a href="#traction-493"><span class="linenos"> 493</span></a>                       <span class="n">root</span> <span class="o">=</span> <span class="n">s_oid</span>
</span><span id="traction-494"><a href="#traction-494"><span class="linenos"> 494</span></a>                   <span class="n">c_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-495"><a href="#traction-495"><span class="linenos"> 495</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_childs</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">c_oids</span><span class="p">)</span>
</span><span id="traction-496"><a href="#traction-496"><span class="linenos"> 496</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="traction-497"><a href="#traction-497"><span class="linenos"> 497</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c_oids</span><span class="p">)</span>
</span><span id="traction-498"><a href="#traction-498"><span class="linenos"> 498</span></a>            <span class="n">withincl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">withincl</span><span class="p">))</span>
</span><span id="traction-499"><a href="#traction-499"><span class="linenos"> 499</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">oids</span><span class="o">=</span><span class="n">withincl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">print_query</span><span class="o">=</span><span class="n">print_query</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span> <span class="c1"># todo pass verbose_all?</span>
</span><span id="traction-500"><a href="#traction-500"><span class="linenos"> 500</span></a>        <span class="c1"># todo check that self.sidc() is not in idc</span>
</span><span id="traction-501"><a href="#traction-501"><span class="linenos"> 501</span></a>        <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-502"><a href="#traction-502"><span class="linenos"> 502</span></a>           <span class="n">idc</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction-503"><a href="#traction-503"><span class="linenos"> 503</span></a>        <span class="k">if</span> <span class="n">sampleids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-504"><a href="#traction-504"><span class="linenos"> 504</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">sampleids</span>
</span><span id="traction-505"><a href="#traction-505"><span class="linenos"> 505</span></a>        <span class="k">if</span> <span class="n">patientids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-506"><a href="#traction-506"><span class="linenos"> 506</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">patientids</span>
</span><span id="traction-507"><a href="#traction-507"><span class="linenos"> 507</span></a>        <span class="n">jselects</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction-508"><a href="#traction-508"><span class="linenos"> 508</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">sampleid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-509"><a href="#traction-509"><span class="linenos"> 509</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">patientid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>                   
</span><span id="traction-510"><a href="#traction-510"><span class="linenos"> 510</span></a>            <span class="n">cxxkitid</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplekit.cxxkitid as &#39;</span><span class="si">{</span><span class="n">cxxkitid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-511"><a href="#traction-511"><span class="linenos"> 511</span></a>            <span class="c1">#sampleid: [f&quot;sidc.psn as &#39;{sampleid}&#39;&quot;],</span>
</span><span id="traction-512"><a href="#traction-512"><span class="linenos"> 512</span></a>            <span class="n">parentid</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;parentidc.psn as &#39;</span><span class="si">{</span><span class="n">parentid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-513"><a href="#traction-513"><span class="linenos"> 513</span></a>            <span class="n">kitid</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplekit.kitid as &#39;</span><span class="si">{</span><span class="n">kitid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-514"><a href="#traction-514"><span class="linenos"> 514</span></a>            <span class="n">locationname</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplelocation.locationid as &#39;</span><span class="si">{</span><span class="n">locationname</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span> 
</span><span id="traction-515"><a href="#traction-515"><span class="linenos"> 515</span></a>            <span class="n">locationpath</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplelocation.locationpath as &#39;</span><span class="si">{</span><span class="n">locationpath</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-516"><a href="#traction-516"><span class="linenos"> 516</span></a>            <span class="n">sampletype</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;sampletype.code as &#39;</span><span class="si">{</span><span class="n">sampletype</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-517"><a href="#traction-517"><span class="linenos"> 517</span></a>            <span class="n">stockprocessing</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;stockprocessing.code as &#39;</span><span class="si">{</span><span class="n">stockprocessing</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-518"><a href="#traction-518"><span class="linenos"> 518</span></a>            <span class="n">secondprocessing</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;secondprocessing.code as &#39;</span><span class="si">{</span><span class="n">secondprocessing</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-519"><a href="#traction-519"><span class="linenos"> 519</span></a>            <span class="n">project</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;project.code as &#39;</span><span class="si">{</span><span class="n">project</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-520"><a href="#traction-520"><span class="linenos"> 520</span></a>            <span class="c1">#patientid: [f&quot;patidc.psn as &#39;{patientid}&#39;&quot;],</span>
</span><span id="traction-521"><a href="#traction-521"><span class="linenos"> 521</span></a>            <span class="n">receptacle</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;receptable.code as &#39;</span><span class="si">{</span><span class="n">receptacle</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-522"><a href="#traction-522"><span class="linenos"> 522</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;organisationunit.code as &#39;</span><span class="si">{</span><span class="n">orga</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-523"><a href="#traction-523"><span class="linenos"> 523</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;flexistudy.code as &#39;</span><span class="si">{</span><span class="n">trial</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-524"><a href="#traction-524"><span class="linenos"> 524</span></a>        <span class="p">}</span>
</span><span id="traction-525"><a href="#traction-525"><span class="linenos"> 525</span></a>        <span class="n">lselects</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="traction-526"><a href="#traction-526"><span class="linenos"> 526</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.amountrest as </span><span class="si">{</span><span class="n">restamount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="traction-527"><a href="#traction-527"><span class="linenos"> 527</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.appointmentnumber as </span><span class="si">{</span><span class="n">appointment</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="traction-528"><a href="#traction-528"><span class="linenos"> 528</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.dtype as </span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="traction-529"><a href="#traction-529"><span class="linenos"> 529</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.oid as </span><span class="si">{</span><span class="n">sampleoid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="traction-530"><a href="#traction-530"><span class="linenos"> 530</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.parent as </span><span class="si">{</span><span class="n">parentoid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="traction-531"><a href="#traction-531"><span class="linenos"> 531</span></a>          <span class="s2">&quot;sample.*&quot;</span>
</span><span id="traction-532"><a href="#traction-532"><span class="linenos"> 532</span></a>        <span class="p">]</span>
</span><span id="traction-533"><a href="#traction-533"><span class="linenos"> 533</span></a>        <span class="n">joins</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction-534"><a href="#traction-534"><span class="linenos"> 534</span></a>            <span class="n">cxxkitid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplekit&quot;</span><span class="p">],</span>
</span><span id="traction-535"><a href="#traction-535"><span class="linenos"> 535</span></a>            <span class="n">parentid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_parentid&quot;</span><span class="p">],</span>
</span><span id="traction-536"><a href="#traction-536"><span class="linenos"> 536</span></a>            <span class="n">kitid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplekit&quot;</span><span class="p">],</span>
</span><span id="traction-537"><a href="#traction-537"><span class="linenos"> 537</span></a>            <span class="n">locationname</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplelocation&quot;</span><span class="p">],</span>
</span><span id="traction-538"><a href="#traction-538"><span class="linenos"> 538</span></a>            <span class="n">locationpath</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplelocation&quot;</span><span class="p">],</span>
</span><span id="traction-539"><a href="#traction-539"><span class="linenos"> 539</span></a>            <span class="n">sampletype</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_sampletype&quot;</span><span class="p">],</span>
</span><span id="traction-540"><a href="#traction-540"><span class="linenos"> 540</span></a>            <span class="n">stockprocessing</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_stockprocessing&quot;</span><span class="p">],</span>
</span><span id="traction-541"><a href="#traction-541"><span class="linenos"> 541</span></a>            <span class="n">secondprocessing</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_secondprocessing&quot;</span><span class="p">],</span>
</span><span id="traction-542"><a href="#traction-542"><span class="linenos"> 542</span></a>            <span class="n">project</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_project&quot;</span><span class="p">],</span>
</span><span id="traction-543"><a href="#traction-543"><span class="linenos"> 543</span></a>            <span class="n">receptacle</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_receptacle&quot;</span><span class="p">],</span>
</span><span id="traction-544"><a href="#traction-544"><span class="linenos"> 544</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_orga&quot;</span><span class="p">],</span>
</span><span id="traction-545"><a href="#traction-545"><span class="linenos"> 545</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_trial&quot;</span><span class="p">]</span>
</span><span id="traction-546"><a href="#traction-546"><span class="linenos"> 546</span></a>        <span class="p">}</span>
</span><span id="traction-547"><a href="#traction-547"><span class="linenos"> 547</span></a>        <span class="k">for</span> <span class="n">pidc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">():</span>
</span><span id="traction-548"><a href="#traction-548"><span class="linenos"> 548</span></a>            <span class="n">joins</span><span class="p">[</span><span class="n">pidc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_patient&quot;</span><span class="p">]</span>
</span><span id="traction-549"><a href="#traction-549"><span class="linenos"> 549</span></a>        <span class="n">selectstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectstr</span><span class="p">(</span><span class="n">jselects</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">lselects</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="traction-550"><a href="#traction-550"><span class="linenos"> 550</span></a>        <span class="n">joinstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joinstr</span><span class="p">(</span><span class="n">joins</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="traction-551"><a href="#traction-551"><span class="linenos"> 551</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">sampleoids</span><span class="o">=</span><span class="n">oids</span><span class="p">,</span> <span class="n">parentids</span><span class="o">=</span><span class="n">parentids</span><span class="p">,</span> <span class="n">parentoids</span><span class="o">=</span><span class="n">parentoids</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">,</span> <span class="n">locationpaths</span><span class="o">=</span><span class="n">locationpaths</span><span class="p">,</span> <span class="n">kitids</span><span class="o">=</span><span class="n">kitids</span><span class="p">,</span> <span class="n">cxxkitids</span><span class="o">=</span><span class="n">cxxkitids</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">samplingdates</span><span class="o">=</span><span class="n">samplingdates</span><span class="p">,</span> <span class="n">receiptdates</span><span class="o">=</span><span class="n">receiptdates</span><span class="p">,</span> <span class="n">derivaldates</span><span class="o">=</span><span class="n">derivaldates</span><span class="p">,</span> <span class="n">first_repositiondates</span><span class="o">=</span><span class="n">first_repositiondates</span><span class="p">,</span> <span class="n">repositiondates</span><span class="o">=</span><span class="n">repositiondates</span><span class="p">,</span> <span class="n">stockprocessingdates</span><span class="o">=</span><span class="n">stockprocessingdates</span><span class="p">,</span> <span class="n">secondprocessingdates</span><span class="o">=</span><span class="n">secondprocessingdates</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">wherearg</span><span class="o">=</span><span class="n">where</span><span class="p">)</span> 
</span><span id="traction-552"><a href="#traction-552"><span class="linenos"> 552</span></a>        <span class="n">topstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
</span><span id="traction-553"><a href="#traction-553"><span class="linenos"> 553</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;select </span><span class="si">{</span><span class="n">topstr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">selectstr</span><span class="si">}</span><span class="s2"> from centraxx_sample sample </span><span class="se">\n</span><span class="si">{</span><span class="n">joinstr</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">where </span><span class="si">{</span><span class="n">wherestr</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="traction-554"><a href="#traction-554"><span class="linenos"> 554</span></a>        <span class="k">if</span> <span class="n">order_by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-555"><a href="#traction-555"><span class="linenos"> 555</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; order by </span><span class="si">{</span><span class="n">order_by</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="traction-556"><a href="#traction-556"><span class="linenos"> 556</span></a>        <span class="k">if</span> <span class="n">print_query</span><span class="p">:</span>
</span><span id="traction-557"><a href="#traction-557"><span class="linenos"> 557</span></a>           <span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="traction-558"><a href="#traction-558"><span class="linenos"> 558</span></a>           <span class="nb">print</span><span class="p">(</span><span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction-559"><a href="#traction-559"><span class="linenos"> 559</span></a>
</span><span id="traction-560"><a href="#traction-560"><span class="linenos"> 560</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction-561"><a href="#traction-561"><span class="linenos"> 561</span></a>        <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
</span><span id="traction-562"><a href="#traction-562"><span class="linenos"> 562</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="traction-563"><a href="#traction-563"><span class="linenos"> 563</span></a>        <span class="n">sarr</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-564"><a href="#traction-564"><span class="linenos"> 564</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction-565"><a href="#traction-565"><span class="linenos"> 565</span></a>            <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-566"><a href="#traction-566"><span class="linenos"> 566</span></a>            <span class="c1">#if dig(r, sampleid) is not None:</span>
</span><span id="traction-567"><a href="#traction-567"><span class="linenos"> 567</span></a>            <span class="c1">#    ids.append(Identifier(id=dig(r, sampleid), code=self.sidc()))</span>
</span><span id="traction-568"><a href="#traction-568"><span class="linenos"> 568</span></a>            <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sampleidcs</span><span class="p">():</span>
</span><span id="traction-569"><a href="#traction-569"><span class="linenos"> 569</span></a>                <span class="c1">#print(&quot;idc:&quot; + idc)</span>
</span><span id="traction-570"><a href="#traction-570"><span class="linenos"> 570</span></a>                <span class="c1">#print(&quot;r:&quot; + str(r))</span>
</span><span id="traction-571"><a href="#traction-571"><span class="linenos"> 571</span></a>                <span class="k">if</span> <span class="n">idc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">r</span> <span class="ow">and</span> <span class="n">r</span><span class="p">[</span><span class="n">idc</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-572"><a href="#traction-572"><span class="linenos"> 572</span></a>                    <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">idc</span><span class="o">.</span><span class="n">lower</span><span class="p">()),</span> <span class="n">code</span><span class="o">=</span><span class="n">idc</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="p">)</span>
</span><span id="traction-573"><a href="#traction-573"><span class="linenos"> 573</span></a>            <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">sampleoid</span><span class="p">)),</span> <span class="n">code</span><span class="o">=</span><span class="s2">&quot;oid&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># todo rename sampleoid?</span>
</span><span id="traction-574"><a href="#traction-574"><span class="linenos"> 574</span></a>            <span class="n">pids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-575"><a href="#traction-575"><span class="linenos"> 575</span></a>            <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="n">parentoid</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-576"><a href="#traction-576"><span class="linenos"> 576</span></a>                <span class="n">pids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">parentoid</span><span class="p">]),</span> <span class="n">code</span><span class="o">=</span><span class="s2">&quot;oid&quot;</span><span class="p">))</span>
</span><span id="traction-577"><a href="#traction-577"><span class="linenos"> 577</span></a>            <span class="k">if</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">parentid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-578"><a href="#traction-578"><span class="linenos"> 578</span></a>                <span class="n">pids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">parentid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()))</span>
</span><span id="traction-579"><a href="#traction-579"><span class="linenos"> 579</span></a>            <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="traction-580"><a href="#traction-580"><span class="linenos"> 580</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="traction-581"><a href="#traction-581"><span class="linenos"> 581</span></a>                <span class="n">parent</span> <span class="o">=</span> <span class="n">Idable</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">pids</span><span class="p">,</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="traction-582"><a href="#traction-582"><span class="linenos"> 582</span></a>            <span class="n">patids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-583"><a href="#traction-583"><span class="linenos"> 583</span></a>            <span class="k">if</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">patientid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>   <span class="c1"># todo include patient oid?</span>
</span><span id="traction-584"><a href="#traction-584"><span class="linenos"> 584</span></a>                <span class="n">patids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">patientid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()))</span>
</span><span id="traction-585"><a href="#traction-585"><span class="linenos"> 585</span></a>            <span class="n">patient</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="traction-586"><a href="#traction-586"><span class="linenos"> 586</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">patids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="traction-587"><a href="#traction-587"><span class="linenos"> 587</span></a>                <span class="n">patient</span> <span class="o">=</span> <span class="n">Idable</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">patids</span><span class="p">,</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span>
</span><span id="traction-588"><a href="#traction-588"><span class="linenos"> 588</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">(</span>
</span><span id="traction-589"><a href="#traction-589"><span class="linenos"> 589</span></a>                <span class="n">appointment</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">appointment</span><span class="p">),</span>
</span><span id="traction-590"><a href="#traction-590"><span class="linenos"> 590</span></a>                <span class="n">category</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">category</span><span class="p">),</span>
</span><span id="traction-591"><a href="#traction-591"><span class="linenos"> 591</span></a>                <span class="n">samplingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">samplingdate</span><span class="p">),</span>
</span><span id="traction-592"><a href="#traction-592"><span class="linenos"> 592</span></a>                <span class="n">concentration</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">concentration</span><span class="p">),</span>
</span><span id="traction-593"><a href="#traction-593"><span class="linenos"> 593</span></a>                <span class="n">cxxkitid</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">cxxkitid</span><span class="p">),</span>
</span><span id="traction-594"><a href="#traction-594"><span class="linenos"> 594</span></a>                <span class="n">derivaldate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">derivaldate</span><span class="p">),</span>
</span><span id="traction-595"><a href="#traction-595"><span class="linenos"> 595</span></a>                <span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span>
</span><span id="traction-596"><a href="#traction-596"><span class="linenos"> 596</span></a>                <span class="n">initialamount</span><span class="o">=</span><span class="n">Amount</span><span class="p">(</span><span class="n">floatornull</span><span class="p">(</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">initialamount</span><span class="p">)),</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">initialunit</span><span class="p">)),</span> <span class="c1"># apparently the cast to float is explicitly needed</span>
</span><span id="traction-597"><a href="#traction-597"><span class="linenos"> 597</span></a>                <span class="n">kitid</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">kitid</span><span class="p">),</span>
</span><span id="traction-598"><a href="#traction-598"><span class="linenos"> 598</span></a>                <span class="n">locationpath</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">locationpath</span><span class="p">),</span>
</span><span id="traction-599"><a href="#traction-599"><span class="linenos"> 599</span></a>                <span class="n">locationname</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">locationname</span><span class="p">),</span>
</span><span id="traction-600"><a href="#traction-600"><span class="linenos"> 600</span></a>                <span class="n">orga</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">orga</span><span class="p">),</span>
</span><span id="traction-601"><a href="#traction-601"><span class="linenos"> 601</span></a>                <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
</span><span id="traction-602"><a href="#traction-602"><span class="linenos"> 602</span></a>                <span class="n">patient</span><span class="o">=</span><span class="n">patient</span><span class="p">,</span>
</span><span id="traction-603"><a href="#traction-603"><span class="linenos"> 603</span></a>                <span class="n">project</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">project</span><span class="p">),</span>
</span><span id="traction-604"><a href="#traction-604"><span class="linenos"> 604</span></a>                <span class="n">receiptdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">receiptdate</span><span class="p">),</span>
</span><span id="traction-605"><a href="#traction-605"><span class="linenos"> 605</span></a>                <span class="n">receptacle</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">receptacle</span><span class="p">),</span>
</span><span id="traction-606"><a href="#traction-606"><span class="linenos"> 606</span></a>                <span class="n">repositiondate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">repositiondate</span><span class="p">),</span>
</span><span id="traction-607"><a href="#traction-607"><span class="linenos"> 607</span></a>                <span class="n">restamount</span><span class="o">=</span><span class="n">Amount</span><span class="p">(</span><span class="n">floatornull</span><span class="p">(</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">restamount</span><span class="p">)),</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">restunit</span><span class="p">)),</span>
</span><span id="traction-608"><a href="#traction-608"><span class="linenos"> 608</span></a>                <span class="n">secondprocessing</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">secondprocessing</span><span class="p">),</span>
</span><span id="traction-609"><a href="#traction-609"><span class="linenos"> 609</span></a>                <span class="n">secondprocessingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">secondprocessingdate</span><span class="p">),</span>
</span><span id="traction-610"><a href="#traction-610"><span class="linenos"> 610</span></a>                <span class="n">sidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">(),</span>
</span><span id="traction-611"><a href="#traction-611"><span class="linenos"> 611</span></a>                <span class="n">stockprocessing</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">stockprocessing</span><span class="p">),</span>
</span><span id="traction-612"><a href="#traction-612"><span class="linenos"> 612</span></a>                <span class="n">stockprocessingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">stockprocessingdate</span><span class="p">),</span>
</span><span id="traction-613"><a href="#traction-613"><span class="linenos"> 613</span></a>                <span class="n">trial</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">trial</span><span class="p">),</span>
</span><span id="traction-614"><a href="#traction-614"><span class="linenos"> 614</span></a>                <span class="nb">type</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">sampletype</span><span class="p">),</span>
</span><span id="traction-615"><a href="#traction-615"><span class="linenos"> 615</span></a>                <span class="n">xposition</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">xposition</span><span class="p">),</span> 
</span><span id="traction-616"><a href="#traction-616"><span class="linenos"> 616</span></a>                <span class="n">yposition</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">yposition</span><span class="p">)</span>
</span><span id="traction-617"><a href="#traction-617"><span class="linenos"> 617</span></a>            <span class="p">)</span>
</span><span id="traction-618"><a href="#traction-618"><span class="linenos"> 618</span></a>            <span class="n">sarr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="traction-619"><a href="#traction-619"><span class="linenos"> 619</span></a>        <span class="k">return</span> <span class="n">sarr</span>
</span><span id="traction-620"><a href="#traction-620"><span class="linenos"> 620</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
</span><span id="traction-621"><a href="#traction-621"><span class="linenos"> 621</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-622"><a href="#traction-622"><span class="linenos"> 622</span></a><span class="sd">         _get_parents collects the parent sample oids of a sample in the `out`</span>
</span><span id="traction-623"><a href="#traction-623"><span class="linenos"> 623</span></a><span class="sd">         list, in order from root to leaf. take oids to include aliquotgroups,</span>
</span><span id="traction-624"><a href="#traction-624"><span class="linenos"> 624</span></a><span class="sd">         they don&#39;t necessarily have an idcontainer attached to them.</span>
</span><span id="traction-625"><a href="#traction-625"><span class="linenos"> 625</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-626"><a href="#traction-626"><span class="linenos"> 626</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="s2">&quot;select parent from centraxx_sample where oid = ?&quot;</span><span class="p">,</span> <span class="n">oid</span><span class="p">)</span>
</span><span id="traction-627"><a href="#traction-627"><span class="linenos"> 627</span></a>        <span class="n">pid</span> <span class="o">=</span> <span class="n">dig</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;parent&quot;</span><span class="p">)</span>
</span><span id="traction-628"><a href="#traction-628"><span class="linenos"> 628</span></a>        <span class="k">if</span> <span class="n">pid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-629"><a href="#traction-629"><span class="linenos"> 629</span></a>            <span class="n">out</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
</span><span id="traction-630"><a href="#traction-630"><span class="linenos"> 630</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_get_parents</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</span><span id="traction-631"><a href="#traction-631"><span class="linenos"> 631</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_childs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
</span><span id="traction-632"><a href="#traction-632"><span class="linenos"> 632</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-633"><a href="#traction-633"><span class="linenos"> 633</span></a><span class="sd">         _get_childs collects the oids of the sample&#39;s children in the `out`</span>
</span><span id="traction-634"><a href="#traction-634"><span class="linenos"> 634</span></a><span class="sd">         list, in order from root-to-leaf. take oids to include aliquotgroups.</span>
</span><span id="traction-635"><a href="#traction-635"><span class="linenos"> 635</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-636"><a href="#traction-636"><span class="linenos"> 636</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="s2">&quot;select oid from centraxx_sample where parent = ?&quot;</span><span class="p">,</span> <span class="n">oid</span><span class="p">)</span>
</span><span id="traction-637"><a href="#traction-637"><span class="linenos"> 637</span></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction-638"><a href="#traction-638"><span class="linenos"> 638</span></a>            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">[</span><span class="s2">&quot;oid&quot;</span><span class="p">])</span>
</span><span id="traction-639"><a href="#traction-639"><span class="linenos"> 639</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_get_childs</span><span class="p">(</span><span class="n">child</span><span class="p">[</span><span class="s2">&quot;oid&quot;</span><span class="p">],</span> <span class="n">out</span><span class="p">)</span>
</span><span id="traction-640"><a href="#traction-640"><span class="linenos"> 640</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">patient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patientids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sampleids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orgas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="p">[],</span> <span class="n">order_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_query</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">raw</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="traction-641"><a href="#traction-641"><span class="linenos"> 641</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-642"><a href="#traction-642"><span class="linenos"> 642</span></a><span class="sd">         patient gets patients and returns them as a list of Patient instances.</span>
</span><span id="traction-643"><a href="#traction-643"><span class="linenos"> 643</span></a><span class="sd">         </span>
</span><span id="traction-644"><a href="#traction-644"><span class="linenos"> 644</span></a><span class="sd">         the parameters work analog to the sample method.</span>
</span><span id="traction-645"><a href="#traction-645"><span class="linenos"> 645</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-646"><a href="#traction-646"><span class="linenos"> 646</span></a>        <span class="n">vaa</span> <span class="o">=</span> <span class="p">[</span><span class="n">orga</span><span class="p">]</span>
</span><span id="traction-647"><a href="#traction-647"><span class="linenos"> 647</span></a>        <span class="n">vaa</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">())</span>        
</span><span id="traction-648"><a href="#traction-648"><span class="linenos"> 648</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="traction-649"><a href="#traction-649"><span class="linenos"> 649</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span>
</span><span id="traction-650"><a href="#traction-650"><span class="linenos"> 650</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concrete_idcs</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="traction-651"><a href="#traction-651"><span class="linenos"> 651</span></a>        <span class="k">if</span> <span class="n">verbose_all</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="traction-652"><a href="#traction-652"><span class="linenos"> 652</span></a>            <span class="n">verbose</span> <span class="o">=</span> <span class="n">vaa</span>
</span><span id="traction-653"><a href="#traction-653"><span class="linenos"> 653</span></a>        <span class="n">silent</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-654"><a href="#traction-654"><span class="linenos"> 654</span></a>        <span class="k">if</span> <span class="n">trials</span><span class="p">:</span>
</span><span id="traction-655"><a href="#traction-655"><span class="linenos"> 655</span></a>            <span class="n">silent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span>
</span><span id="traction-656"><a href="#traction-656"><span class="linenos"> 656</span></a>        <span class="k">if</span> <span class="n">orgas</span><span class="p">:</span>
</span><span id="traction-657"><a href="#traction-657"><span class="linenos"> 657</span></a>            <span class="n">silent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orga</span><span class="p">)</span>
</span><span id="traction-658"><a href="#traction-658"><span class="linenos"> 658</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">_checkverbose</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="n">vaa</span><span class="p">):</span>
</span><span id="traction-659"><a href="#traction-659"><span class="linenos"> 659</span></a>            <span class="k">return</span> <span class="kc">None</span> <span class="c1"># throw error?</span>
</span><span id="traction-660"><a href="#traction-660"><span class="linenos"> 660</span></a>        <span class="c1"># todo check that self.sidc() is not in idc</span>
</span><span id="traction-661"><a href="#traction-661"><span class="linenos"> 661</span></a>        <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-662"><a href="#traction-662"><span class="linenos"> 662</span></a>           <span class="n">idc</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction-663"><a href="#traction-663"><span class="linenos"> 663</span></a>        <span class="k">if</span> <span class="n">sampleids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-664"><a href="#traction-664"><span class="linenos"> 664</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">sampleids</span>
</span><span id="traction-665"><a href="#traction-665"><span class="linenos"> 665</span></a>        <span class="k">if</span> <span class="n">patientids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-666"><a href="#traction-666"><span class="linenos"> 666</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">patientids</span>
</span><span id="traction-667"><a href="#traction-667"><span class="linenos"> 667</span></a>           
</span><span id="traction-668"><a href="#traction-668"><span class="linenos"> 668</span></a>        <span class="n">selects</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction-669"><a href="#traction-669"><span class="linenos"> 669</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">patientid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-670"><a href="#traction-670"><span class="linenos"> 670</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;organisationunit.code as &#39;</span><span class="si">{</span><span class="n">orga</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-671"><a href="#traction-671"><span class="linenos"> 671</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;flexistudy.code as &#39;</span><span class="si">{</span><span class="n">trial</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-672"><a href="#traction-672"><span class="linenos"> 672</span></a>        <span class="p">}</span>
</span><span id="traction-673"><a href="#traction-673"><span class="linenos"> 673</span></a>        <span class="n">joins</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction-674"><a href="#traction-674"><span class="linenos"> 674</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;patient_to_orga&quot;</span><span class="p">],</span>
</span><span id="traction-675"><a href="#traction-675"><span class="linenos"> 675</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;patient_to_trial&quot;</span><span class="p">]</span>
</span><span id="traction-676"><a href="#traction-676"><span class="linenos"> 676</span></a>        <span class="p">}</span>
</span><span id="traction-677"><a href="#traction-677"><span class="linenos"> 677</span></a>        <span class="k">for</span> <span class="n">sidc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sampleidcs</span><span class="p">():</span>
</span><span id="traction-678"><a href="#traction-678"><span class="linenos"> 678</span></a>            <span class="n">joins</span><span class="p">[</span><span class="n">sidc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;patient_to_sample&quot;</span><span class="p">]</span>
</span><span id="traction-679"><a href="#traction-679"><span class="linenos"> 679</span></a>        <span class="n">selectstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectstr</span><span class="p">(</span><span class="n">selects</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;patientcontainer.*&quot;</span><span class="p">],</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="traction-680"><a href="#traction-680"><span class="linenos"> 680</span></a>        <span class="n">joinstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joinstr</span><span class="p">(</span><span class="n">joins</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">+</span> <span class="n">silent</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="traction-681"><a href="#traction-681"><span class="linenos"> 681</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">)</span>
</span><span id="traction-682"><a href="#traction-682"><span class="linenos"> 682</span></a>        <span class="c1">#print(whereargs)</span>
</span><span id="traction-683"><a href="#traction-683"><span class="linenos"> 683</span></a>        <span class="n">topstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
</span><span id="traction-684"><a href="#traction-684"><span class="linenos"> 684</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;select distinct </span><span class="si">{</span><span class="n">topstr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">selectstr</span><span class="si">}</span><span class="s2"> from centraxx_patientcontainer patientcontainer </span><span class="se">\n</span><span class="si">{</span><span class="n">joinstr</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">where </span><span class="si">{</span><span class="n">wherestr</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="traction-685"><a href="#traction-685"><span class="linenos"> 685</span></a>        <span class="k">if</span> <span class="n">order_by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-686"><a href="#traction-686"><span class="linenos"> 686</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; order by </span><span class="si">{</span><span class="n">order_by</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="traction-687"><a href="#traction-687"><span class="linenos"> 687</span></a>        <span class="k">if</span> <span class="n">print_query</span><span class="p">:</span>
</span><span id="traction-688"><a href="#traction-688"><span class="linenos"> 688</span></a>           <span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="traction-689"><a href="#traction-689"><span class="linenos"> 689</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction-690"><a href="#traction-690"><span class="linenos"> 690</span></a>        <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
</span><span id="traction-691"><a href="#traction-691"><span class="linenos"> 691</span></a>            <span class="k">return</span> <span class="n">raw</span>
</span><span id="traction-692"><a href="#traction-692"><span class="linenos"> 692</span></a>        <span class="n">pats</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-693"><a href="#traction-693"><span class="linenos"> 693</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction-694"><a href="#traction-694"><span class="linenos"> 694</span></a>            <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">patientid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span> <span class="p">]</span>
</span><span id="traction-695"><a href="#traction-695"><span class="linenos"> 695</span></a>            <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">():</span>
</span><span id="traction-696"><a href="#traction-696"><span class="linenos"> 696</span></a>                <span class="k">if</span> <span class="n">idc</span> <span class="ow">in</span> <span class="n">r</span> <span class="ow">and</span> <span class="n">r</span><span class="p">[</span><span class="n">idc</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-697"><a href="#traction-697"><span class="linenos"> 697</span></a>                    <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">idc</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="n">idc</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="p">)</span>
</span><span id="traction-698"><a href="#traction-698"><span class="linenos"> 698</span></a>            <span class="n">pat</span> <span class="o">=</span> <span class="n">Patient</span><span class="p">(</span>
</span><span id="traction-699"><a href="#traction-699"><span class="linenos"> 699</span></a>              <span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span>
</span><span id="traction-700"><a href="#traction-700"><span class="linenos"> 700</span></a>              <span class="n">orga</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">orga</span><span class="p">),</span>
</span><span id="traction-701"><a href="#traction-701"><span class="linenos"> 701</span></a>              <span class="n">pidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span>
</span><span id="traction-702"><a href="#traction-702"><span class="linenos"> 702</span></a>            <span class="p">)</span>
</span><span id="traction-703"><a href="#traction-703"><span class="linenos"> 703</span></a>            <span class="n">pats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span>
</span><span id="traction-704"><a href="#traction-704"><span class="linenos"> 704</span></a>        <span class="k">return</span> <span class="n">pats</span>
</span><span id="traction-705"><a href="#traction-705"><span class="linenos"> 705</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">trial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="traction-706"><a href="#traction-706"><span class="linenos"> 706</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-707"><a href="#traction-707"><span class="linenos"> 707</span></a><span class="sd">         trial gives trials.</span>
</span><span id="traction-708"><a href="#traction-708"><span class="linenos"> 708</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-709"><a href="#traction-709"><span class="linenos"> 709</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;select code from centraxx_flexistudy&quot;</span>
</span><span id="traction-710"><a href="#traction-710"><span class="linenos"> 710</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="traction-711"><a href="#traction-711"><span class="linenos"> 711</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="traction-712"><a href="#traction-712"><span class="linenos"> 712</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">finding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampleids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patientids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose_all</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">print_query</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">raw</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="traction-713"><a href="#traction-713"><span class="linenos"> 713</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-714"><a href="#traction-714"><span class="linenos"> 714</span></a><span class="sd">         finding gets the laborfindings (&quot;messbefund&quot; / &quot;begleitschein&quot;) for</span>
</span><span id="traction-715"><a href="#traction-715"><span class="linenos"> 715</span></a><span class="sd">         sampleids or method.  it returns a list of Finding instances.</span>
</span><span id="traction-716"><a href="#traction-716"><span class="linenos"> 716</span></a><span class="sd">         </span>
</span><span id="traction-717"><a href="#traction-717"><span class="linenos"> 717</span></a><span class="sd">         you can pass these to verbose: tr.patientid  // maybe also tr.values?</span>
</span><span id="traction-718"><a href="#traction-718"><span class="linenos"> 718</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-719"><a href="#traction-719"><span class="linenos"> 719</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="traction-720"><a href="#traction-720"><span class="linenos"> 720</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="traction-721"><a href="#traction-721"><span class="linenos"> 721</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concrete_idcs</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="traction-722"><a href="#traction-722"><span class="linenos"> 722</span></a>        <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-723"><a href="#traction-723"><span class="linenos"> 723</span></a>           <span class="n">idc</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction-724"><a href="#traction-724"><span class="linenos"> 724</span></a>        <span class="c1"># todo check that self.sidc() is not in idc</span>
</span><span id="traction-725"><a href="#traction-725"><span class="linenos"> 725</span></a>        <span class="k">if</span> <span class="n">sampleids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-726"><a href="#traction-726"><span class="linenos"> 726</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">sampleids</span>
</span><span id="traction-727"><a href="#traction-727"><span class="linenos"> 727</span></a>        <span class="k">if</span> <span class="n">patientids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-728"><a href="#traction-728"><span class="linenos"> 728</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">patientids</span>
</span><span id="traction-729"><a href="#traction-729"><span class="linenos"> 729</span></a>        <span class="n">selects</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction-730"><a href="#traction-730"><span class="linenos"> 730</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">sampleid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction-731"><a href="#traction-731"><span class="linenos"> 731</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">patientid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>                   
</span><span id="traction-732"><a href="#traction-732"><span class="linenos"> 732</span></a>        <span class="p">}</span>
</span><span id="traction-733"><a href="#traction-733"><span class="linenos"> 733</span></a>        <span class="n">idcselectstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectstr</span><span class="p">(</span><span class="n">selects</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="p">[],</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="traction-734"><a href="#traction-734"><span class="linenos"> 734</span></a>        <span class="n">joins</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction-735"><a href="#traction-735"><span class="linenos"> 735</span></a>        <span class="k">for</span> <span class="n">pidc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">():</span>
</span><span id="traction-736"><a href="#traction-736"><span class="linenos"> 736</span></a>            <span class="n">joins</span><span class="p">[</span><span class="n">pidc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_patient&quot;</span><span class="p">]</span>
</span><span id="traction-737"><a href="#traction-737"><span class="linenos"> 737</span></a>        <span class="n">idcjoinstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joinstr</span><span class="p">(</span><span class="n">joins</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>
</span><span id="traction-738"><a href="#traction-738"><span class="linenos"> 738</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select laborfinding.oid as &quot;laborfinding_oid&quot;, laborfinding.*, labormethod.code as </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">idcselectstr</span><span class="si">}</span>
</span><span id="traction-739"><a href="#traction-739"><span class="linenos"> 739</span></a><span class="s2">        from centraxx_laborfinding as laborfinding</span>
</span><span id="traction-740"><a href="#traction-740"><span class="linenos"> 740</span></a>
</span><span id="traction-741"><a href="#traction-741"><span class="linenos"> 741</span></a><span class="s2">        -- go from laborfinding to sample</span>
</span><span id="traction-742"><a href="#traction-742"><span class="linenos"> 742</span></a><span class="s2">        left join centraxx_labormethod as labormethod on laborfinding.labormethod = labormethod.oid</span>
</span><span id="traction-743"><a href="#traction-743"><span class="linenos"> 743</span></a><span class="s2">        left join centraxx_labormapping as labormapping on labormapping.laborfinding = laborfinding.oid</span>
</span><span id="traction-744"><a href="#traction-744"><span class="linenos"> 744</span></a><span class="s2">        left join centraxx_sample sample on labormapping.relatedoid = sample.oid</span>
</span><span id="traction-745"><a href="#traction-745"><span class="linenos"> 745</span></a><span class="s2">        </span><span class="si">{</span><span class="n">idcjoinstr</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="traction-746"><a href="#traction-746"><span class="linenos"> 746</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="n">methods</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">)</span>
</span><span id="traction-747"><a href="#traction-747"><span class="linenos"> 747</span></a>
</span><span id="traction-748"><a href="#traction-748"><span class="linenos"> 748</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; where &quot;</span> <span class="o">+</span> <span class="n">wherestr</span>
</span><span id="traction-749"><a href="#traction-749"><span class="linenos"> 749</span></a>        <span class="k">if</span> <span class="n">print_query</span><span class="p">:</span>
</span><span id="traction-750"><a href="#traction-750"><span class="linenos"> 750</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="traction-751"><a href="#traction-751"><span class="linenos"> 751</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction-752"><a href="#traction-752"><span class="linenos"> 752</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction-753"><a href="#traction-753"><span class="linenos"> 753</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">finding</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
</span><span id="traction-754"><a href="#traction-754"><span class="linenos"> 754</span></a>            <span class="k">if</span> <span class="n">values</span> <span class="o">!=</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># todo put this outside of the loop?</span>
</span><span id="traction-755"><a href="#traction-755"><span class="linenos"> 755</span></a>                <span class="k">continue</span>
</span><span id="traction-756"><a href="#traction-756"><span class="linenos"> 756</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select recordedvalue.*, laborvalue.code as laborvalue_code, laborvalue.dtype as laborvalue_type, laborvalue.custom_catalog as laborvalue_catalog_oid, unit.code as laborvalue_unit</span>
</span><span id="traction-757"><a href="#traction-757"><span class="linenos"> 757</span></a><span class="s2">                from centraxx_laborfinding as laborfinding</span>
</span><span id="traction-758"><a href="#traction-758"><span class="linenos"> 758</span></a>
</span><span id="traction-759"><a href="#traction-759"><span class="linenos"> 759</span></a><span class="s2">                -- go from laborfinding to recorded value</span>
</span><span id="traction-760"><a href="#traction-760"><span class="linenos"> 760</span></a><span class="s2">                join centraxx_labfindinglabval as labfindinglabval on labfindinglabval.laborfinding = laborfinding.oid</span>
</span><span id="traction-761"><a href="#traction-761"><span class="linenos"> 761</span></a><span class="s2">                join centraxx_recordedvalue as recordedvalue on labfindinglabval.oid = recordedvalue.oid</span>
</span><span id="traction-762"><a href="#traction-762"><span class="linenos"> 762</span></a>
</span><span id="traction-763"><a href="#traction-763"><span class="linenos"> 763</span></a><span class="s2">                --go from labfindinglabval to the laborvalue for the messparam</span>
</span><span id="traction-764"><a href="#traction-764"><span class="linenos"> 764</span></a><span class="s2">                join centraxx_laborvalue laborvalue on labfindinglabval.laborvalue = laborvalue.oid</span>
</span><span id="traction-765"><a href="#traction-765"><span class="linenos"> 765</span></a>
</span><span id="traction-766"><a href="#traction-766"><span class="linenos"> 766</span></a><span class="s2">                --go from laborvalue to unit</span>
</span><span id="traction-767"><a href="#traction-767"><span class="linenos"> 767</span></a><span class="s2">                left join centraxx_unity unit on laborvalue.unit = unit.oid</span>
</span><span id="traction-768"><a href="#traction-768"><span class="linenos"> 768</span></a>
</span><span id="traction-769"><a href="#traction-769"><span class="linenos"> 769</span></a><span class="s2">                where laborfinding.oid = ?</span>
</span><span id="traction-770"><a href="#traction-770"><span class="linenos"> 770</span></a><span class="s2">            &quot;&quot;&quot;</span>
</span><span id="traction-771"><a href="#traction-771"><span class="linenos"> 771</span></a>            <span class="n">recvals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">finding</span><span class="p">[</span><span class="s1">&#39;laborfinding_oid&#39;</span><span class="p">])</span>
</span><span id="traction-772"><a href="#traction-772"><span class="linenos"> 772</span></a>            <span class="n">valsbycode</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction-773"><a href="#traction-773"><span class="linenos"> 773</span></a>            <span class="k">for</span> <span class="n">recval</span> <span class="ow">in</span> <span class="n">recvals</span><span class="p">:</span>
</span><span id="traction-774"><a href="#traction-774"><span class="linenos"> 774</span></a>              <span class="n">valsbycode</span><span class="p">[</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_rec</span><span class="p">(</span><span class="n">recval</span><span class="p">,</span> <span class="n">finding</span><span class="p">)</span>
</span><span id="traction-775"><a href="#traction-775"><span class="linenos"> 775</span></a>            <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">valsbycode</span>
</span><span id="traction-776"><a href="#traction-776"><span class="linenos"> 776</span></a>        <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
</span><span id="traction-777"><a href="#traction-777"><span class="linenos"> 777</span></a>            <span class="k">return</span> <span class="n">results</span>
</span><span id="traction-778"><a href="#traction-778"><span class="linenos"> 778</span></a>        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-779"><a href="#traction-779"><span class="linenos"> 779</span></a>        <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="traction-780"><a href="#traction-780"><span class="linenos"> 780</span></a>            <span class="n">finding</span> <span class="o">=</span> <span class="n">Finding</span><span class="p">(</span>
</span><span id="traction-781"><a href="#traction-781"><span class="linenos"> 781</span></a>                <span class="n">findingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;findingdate&quot;</span><span class="p">),</span>
</span><span id="traction-782"><a href="#traction-782"><span class="linenos"> 782</span></a>                <span class="n">method</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span>
</span><span id="traction-783"><a href="#traction-783"><span class="linenos"> 783</span></a>                <span class="n">methodname</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;shortname&quot;</span><span class="p">],</span>
</span><span id="traction-784"><a href="#traction-784"><span class="linenos"> 784</span></a>                <span class="n">patient</span><span class="o">=</span><span class="n">Idable</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">patientid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">(),</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span> <span class="k">if</span> <span class="n">dig</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">patientid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> 
</span><span id="traction-785"><a href="#traction-785"><span class="linenos"> 785</span></a>                <span class="n">recs</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;values&quot;</span> <span class="ow">in</span> <span class="n">res</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="c1"># todo None ok?</span>
</span><span id="traction-786"><a href="#traction-786"><span class="linenos"> 786</span></a>                <span class="n">sample</span><span class="o">=</span><span class="n">Idable</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="n">sampleid</span><span class="p">],</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">(),</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()),</span>
</span><span id="traction-787"><a href="#traction-787"><span class="linenos"> 787</span></a>                <span class="n">sender</span><span class="o">=</span><span class="kc">None</span>
</span><span id="traction-788"><a href="#traction-788"><span class="linenos"> 788</span></a>            <span class="p">)</span>
</span><span id="traction-789"><a href="#traction-789"><span class="linenos"> 789</span></a>            <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="traction-790"><a href="#traction-790"><span class="linenos"> 790</span></a>        <span class="k">return</span> <span class="n">findings</span>
</span><span id="traction-791"><a href="#traction-791"><span class="linenos"> 791</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="traction-792"><a href="#traction-792"><span class="linenos"> 792</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-793"><a href="#traction-793"><span class="linenos"> 793</span></a><span class="sd">         method (messprofil) gets method(s) and their labvals (messparameter).</span>
</span><span id="traction-794"><a href="#traction-794"><span class="linenos"> 794</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-795"><a href="#traction-795"><span class="linenos"> 795</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select laborvalue.*, labormethod.code as &quot;method&quot;</span>
</span><span id="traction-796"><a href="#traction-796"><span class="linenos"> 796</span></a><span class="s2">from centraxx_labormethod labormethod</span>
</span><span id="traction-797"><a href="#traction-797"><span class="linenos"> 797</span></a><span class="s2">inner join centraxx_crftemplate crf_t</span>
</span><span id="traction-798"><a href="#traction-798"><span class="linenos"> 798</span></a><span class="s2">    on labormethod.crf_template=crf_t.oid</span>
</span><span id="traction-799"><a href="#traction-799"><span class="linenos"> 799</span></a><span class="s2">inner join centraxx_crftempsection crf_ts</span>
</span><span id="traction-800"><a href="#traction-800"><span class="linenos"> 800</span></a><span class="s2">    on crf_t.oid=crf_ts.crftemplate</span>
</span><span id="traction-801"><a href="#traction-801"><span class="linenos"> 801</span></a><span class="s2">inner join centraxx_crftempsection_fields crf_tsf</span>
</span><span id="traction-802"><a href="#traction-802"><span class="linenos"> 802</span></a><span class="s2">    on crf_ts.oid=crf_tsf.crftempsection_oid</span>
</span><span id="traction-803"><a href="#traction-803"><span class="linenos"> 803</span></a><span class="s2">inner join centraxx_crftempfield crf_tf</span>
</span><span id="traction-804"><a href="#traction-804"><span class="linenos"> 804</span></a><span class="s2">    on crf_tsf.crftempfield_oid=crf_tf.oid</span>
</span><span id="traction-805"><a href="#traction-805"><span class="linenos"> 805</span></a><span class="s2">inner join centraxx_laborvalue laborvalue</span>
</span><span id="traction-806"><a href="#traction-806"><span class="linenos"> 806</span></a><span class="s2">    on crf_tf.laborvalue=laborvalue.oid&quot;&quot;&quot;</span>
</span><span id="traction-807"><a href="#traction-807"><span class="linenos"> 807</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">methods</span><span class="o">=</span><span class="n">methods</span><span class="p">)</span>
</span><span id="traction-808"><a href="#traction-808"><span class="linenos"> 808</span></a>
</span><span id="traction-809"><a href="#traction-809"><span class="linenos"> 809</span></a>        <span class="k">if</span> <span class="n">wherestr</span><span class="p">:</span>
</span><span id="traction-810"><a href="#traction-810"><span class="linenos"> 810</span></a>          <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; where &quot;</span> <span class="o">+</span> <span class="n">wherestr</span>
</span><span id="traction-811"><a href="#traction-811"><span class="linenos"> 811</span></a>        <span class="c1"># print(query)</span>
</span><span id="traction-812"><a href="#traction-812"><span class="linenos"> 812</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction-813"><a href="#traction-813"><span class="linenos"> 813</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction-814"><a href="#traction-814"><span class="linenos"> 814</span></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction-815"><a href="#traction-815"><span class="linenos"> 815</span></a>          <span class="n">mc</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>
</span><span id="traction-816"><a href="#traction-816"><span class="linenos"> 816</span></a>          <span class="k">if</span> <span class="n">mc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
</span><span id="traction-817"><a href="#traction-817"><span class="linenos"> 817</span></a>            <span class="n">out</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction-818"><a href="#traction-818"><span class="linenos"> 818</span></a>          <span class="k">del</span> <span class="n">row</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>
</span><span id="traction-819"><a href="#traction-819"><span class="linenos"> 819</span></a>          <span class="n">out</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span>
</span><span id="traction-820"><a href="#traction-820"><span class="linenos"> 820</span></a>        
</span><span id="traction-821"><a href="#traction-821"><span class="linenos"> 821</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="traction-822"><a href="#traction-822"><span class="linenos"> 822</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lang</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ml_table</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="traction-823"><a href="#traction-823"><span class="linenos"> 823</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-824"><a href="#traction-824"><span class="linenos"> 824</span></a><span class="sd">         name gives the multilingual names for a code or all codes in a table.</span>
</span><span id="traction-825"><a href="#traction-825"><span class="linenos"> 825</span></a><span class="sd">         </span>
</span><span id="traction-826"><a href="#traction-826"><span class="linenos"> 826</span></a><span class="sd">         the result is keyed by code and language like this:</span>
</span><span id="traction-827"><a href="#traction-827"><span class="linenos"> 827</span></a><span class="sd">         </span>
</span><span id="traction-828"><a href="#traction-828"><span class="linenos"> 828</span></a><span class="sd">         </span>
</span><span id="traction-829"><a href="#traction-829"><span class="linenos"> 829</span></a><span class="sd">         &quot;NUM_NMR_ISOLEUCINE_VALUE&quot;: {  </span>
</span><span id="traction-830"><a href="#traction-830"><span class="linenos"> 830</span></a><span class="sd">            &quot;de&quot;: &quot;Isoleucin&quot;,  </span>
</span><span id="traction-831"><a href="#traction-831"><span class="linenos"> 831</span></a><span class="sd">            &quot;en&quot;: &quot;Isoleucine&quot;  </span>
</span><span id="traction-832"><a href="#traction-832"><span class="linenos"> 832</span></a><span class="sd">         }</span>
</span><span id="traction-833"><a href="#traction-833"><span class="linenos"> 833</span></a><span class="sd">         </span>
</span><span id="traction-834"><a href="#traction-834"><span class="linenos"> 834</span></a><span class="sd">         </span>
</span><span id="traction-835"><a href="#traction-835"><span class="linenos"> 835</span></a><span class="sd">         table: the name of the centraxx table without centraxx_ prefix  </span>
</span><span id="traction-836"><a href="#traction-836"><span class="linenos"> 836</span></a><span class="sd">         code: a specific code, if none given, all code - name mappings for table are given  </span>
</span><span id="traction-837"><a href="#traction-837"><span class="linenos"> 837</span></a><span class="sd">         lang: de|en  </span>
</span><span id="traction-838"><a href="#traction-838"><span class="linenos"> 838</span></a><span class="sd">         ml_table: if the name of the table connecting to multilingualentry is not simlpy the queried table name followed by &quot;_ml_name&quot;, give the connecting table&#39;s name here. eg: name(&#39;laborvaluegroup&#39;, ..., ml_name=&#39;labval_grp_ml_name&#39;)  </span>
</span><span id="traction-839"><a href="#traction-839"><span class="linenos"> 839</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-840"><a href="#traction-840"><span class="linenos"> 840</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;select [&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;].code, multilingual.value as name, multilingual.lang as lang&quot;</span>
</span><span id="traction-841"><a href="#traction-841"><span class="linenos"> 841</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; from [centraxx_&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;] as [&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
</span><span id="traction-842"><a href="#traction-842"><span class="linenos"> 842</span></a>        <span class="n">ml_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="traction-843"><a href="#traction-843"><span class="linenos"> 843</span></a>        <span class="k">if</span> <span class="n">ml_table</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># the name is different</span>
</span><span id="traction-844"><a href="#traction-844"><span class="linenos"> 844</span></a>            <span class="n">ml_name</span> <span class="o">=</span> <span class="s2">&quot;centraxx_&quot;</span> <span class="o">+</span> <span class="n">ml_table</span>
</span><span id="traction-845"><a href="#traction-845"><span class="linenos"> 845</span></a>        <span class="k">else</span><span class="p">:</span> <span class="c1"># the name is the same</span>
</span><span id="traction-846"><a href="#traction-846"><span class="linenos"> 846</span></a>            <span class="n">ml_name</span> <span class="o">=</span> <span class="s2">&quot;centraxx_&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;_ml_name&quot;</span>
</span><span id="traction-847"><a href="#traction-847"><span class="linenos"> 847</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; inner join [&quot;</span> <span class="o">+</span> <span class="n">ml_name</span> <span class="o">+</span> <span class="s2">&quot;] mlname on mlname.related_oid = [&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;].oid&quot;</span>
</span><span id="traction-848"><a href="#traction-848"><span class="linenos"> 848</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; inner join centraxx_multilingualentry multilingual on mlname.oid = multilingual.oid&quot;</span>
</span><span id="traction-849"><a href="#traction-849"><span class="linenos"> 849</span></a>        <span class="n">wherestrings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-850"><a href="#traction-850"><span class="linenos"> 850</span></a>        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-851"><a href="#traction-851"><span class="linenos"> 851</span></a>        <span class="k">if</span> <span class="n">code</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-852"><a href="#traction-852"><span class="linenos"> 852</span></a>            <span class="n">wherestrings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_whereparam</span><span class="p">(</span><span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;].code&quot;</span><span class="p">))</span>
</span><span id="traction-853"><a href="#traction-853"><span class="linenos"> 853</span></a>            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="traction-854"><a href="#traction-854"><span class="linenos"> 854</span></a>        <span class="k">if</span> <span class="n">lang</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-855"><a href="#traction-855"><span class="linenos"> 855</span></a>            <span class="n">wherestrings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_whereparam</span><span class="p">(</span><span class="s2">&quot;multilingual.lang&quot;</span><span class="p">))</span>
</span><span id="traction-856"><a href="#traction-856"><span class="linenos"> 856</span></a>            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span>
</span><span id="traction-857"><a href="#traction-857"><span class="linenos"> 857</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wherestrings</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="traction-858"><a href="#traction-858"><span class="linenos"> 858</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; where &quot;</span>
</span><span id="traction-859"><a href="#traction-859"><span class="linenos"> 859</span></a>            <span class="c1"># join where clauses by and</span>
</span><span id="traction-860"><a href="#traction-860"><span class="linenos"> 860</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; and &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wherestrings</span><span class="p">)</span>
</span><span id="traction-861"><a href="#traction-861"><span class="linenos"> 861</span></a>
</span><span id="traction-862"><a href="#traction-862"><span class="linenos"> 862</span></a>        <span class="c1"># print(query)</span>
</span><span id="traction-863"><a href="#traction-863"><span class="linenos"> 863</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="traction-864"><a href="#traction-864"><span class="linenos"> 864</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction-865"><a href="#traction-865"><span class="linenos"> 865</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction-866"><a href="#traction-866"><span class="linenos"> 866</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span>
</span><span id="traction-867"><a href="#traction-867"><span class="linenos"> 867</span></a>            <span class="n">lang</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="s2">&quot;lang&quot;</span><span class="p">]</span>
</span><span id="traction-868"><a href="#traction-868"><span class="linenos"> 868</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
</span><span id="traction-869"><a href="#traction-869"><span class="linenos"> 869</span></a>               <span class="n">out</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction-870"><a href="#traction-870"><span class="linenos"> 870</span></a>            <span class="n">out</span><span class="p">[</span><span class="n">code</span><span class="p">][</span><span class="n">lang</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="traction-871"><a href="#traction-871"><span class="linenos"> 871</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="traction-872"><a href="#traction-872"><span class="linenos"> 872</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sidc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="traction-873"><a href="#traction-873"><span class="linenos"> 873</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-874"><a href="#traction-874"><span class="linenos"> 874</span></a><span class="sd">         sidc returns the main idc code by which samples are referenced as</span>
</span><span id="traction-875"><a href="#traction-875"><span class="linenos"> 875</span></a><span class="sd">         specified in the settings. </span>
</span><span id="traction-876"><a href="#traction-876"><span class="linenos"> 876</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-877"><a href="#traction-877"><span class="linenos"> 877</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;sampleid&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>
</span><span id="traction-878"><a href="#traction-878"><span class="linenos"> 878</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pidc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="traction-879"><a href="#traction-879"><span class="linenos"> 879</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-880"><a href="#traction-880"><span class="linenos"> 880</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-881"><a href="#traction-881"><span class="linenos"> 881</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;patientid&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>
</span><span id="traction-882"><a href="#traction-882"><span class="linenos"> 882</span></a>
</span><span id="traction-883"><a href="#traction-883"><span class="linenos"> 883</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_selectstr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selects</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">selecta</span><span class="p">,</span> <span class="n">idc</span><span class="p">):</span>
</span><span id="traction-884"><a href="#traction-884"><span class="linenos"> 884</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-885"><a href="#traction-885"><span class="linenos"> 885</span></a><span class="sd">         _selectstr filters the selects by the verbose array and returns the</span>
</span><span id="traction-886"><a href="#traction-886"><span class="linenos"> 886</span></a><span class="sd">         sql select string. selecta is for fields that should be selected</span>
</span><span id="traction-887"><a href="#traction-887"><span class="linenos"> 887</span></a><span class="sd">         regardless if they&#39;re in the verbose array or not.</span>
</span><span id="traction-888"><a href="#traction-888"><span class="linenos"> 888</span></a><span class="sd">         </span>
</span><span id="traction-889"><a href="#traction-889"><span class="linenos"> 889</span></a><span class="sd">         the idc argument assumes that the sample table is joined it. // todo is this still true?</span>
</span><span id="traction-890"><a href="#traction-890"><span class="linenos"> 890</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-891"><a href="#traction-891"><span class="linenos"> 891</span></a>        <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="traction-892"><a href="#traction-892"><span class="linenos"> 892</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">selects</span><span class="p">:</span>
</span><span id="traction-893"><a href="#traction-893"><span class="linenos"> 893</span></a>                <span class="k">continue</span>
</span><span id="traction-894"><a href="#traction-894"><span class="linenos"> 894</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">selects</span><span class="p">[</span><span class="n">verb</span><span class="p">]:</span>
</span><span id="traction-895"><a href="#traction-895"><span class="linenos"> 895</span></a>                <span class="n">selecta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="traction-896"><a href="#traction-896"><span class="linenos"> 896</span></a>        <span class="n">selecta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_append_idc_select</span><span class="p">(</span><span class="n">selecta</span><span class="p">,</span> <span class="n">idc</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="traction-897"><a href="#traction-897"><span class="linenos"> 897</span></a>        <span class="n">selectstr</span> <span class="o">=</span> <span class="s2">&quot;, </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selecta</span><span class="p">)</span>
</span><span id="traction-898"><a href="#traction-898"><span class="linenos"> 898</span></a>        <span class="k">return</span> <span class="n">selectstr</span>
</span><span id="traction-899"><a href="#traction-899"><span class="linenos"> 899</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_joinstr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">idc</span><span class="p">):</span>
</span><span id="traction-900"><a href="#traction-900"><span class="linenos"> 900</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-901"><a href="#traction-901"><span class="linenos"> 901</span></a><span class="sd">         _joinstr puts together the joins needed by verbose array and idc keys</span>
</span><span id="traction-902"><a href="#traction-902"><span class="linenos"> 902</span></a><span class="sd">         and returns the sql join string.</span>
</span><span id="traction-903"><a href="#traction-903"><span class="linenos"> 903</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-904"><a href="#traction-904"><span class="linenos"> 904</span></a>        <span class="n">joina</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-905"><a href="#traction-905"><span class="linenos"> 905</span></a>        <span class="n">joina</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_append_idc_join</span><span class="p">(</span><span class="n">joina</span><span class="p">,</span> <span class="n">idc</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">joins</span><span class="p">)</span>
</span><span id="traction-906"><a href="#traction-906"><span class="linenos"> 906</span></a>        <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span> 
</span><span id="traction-907"><a href="#traction-907"><span class="linenos"> 907</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">:</span>
</span><span id="traction-908"><a href="#traction-908"><span class="linenos"> 908</span></a>                <span class="k">continue</span>
</span><span id="traction-909"><a href="#traction-909"><span class="linenos"> 909</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">[</span><span class="n">verb</span><span class="p">]:</span>
</span><span id="traction-910"><a href="#traction-910"><span class="linenos"> 910</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">joina</span><span class="p">:</span>
</span><span id="traction-911"><a href="#traction-911"><span class="linenos"> 911</span></a>                    <span class="n">joina</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="traction-912"><a href="#traction-912"><span class="linenos"> 912</span></a>        <span class="n">joinstr</span> <span class="o">=</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">joina</span><span class="p">)</span>
</span><span id="traction-913"><a href="#traction-913"><span class="linenos"> 913</span></a>        <span class="k">return</span> <span class="n">joinstr</span>
</span><span id="traction-914"><a href="#traction-914"><span class="linenos"> 914</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_append_idc_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selecta</span><span class="p">,</span> <span class="n">idc</span><span class="p">,</span> <span class="n">verbose</span><span class="p">):</span>
</span><span id="traction-915"><a href="#traction-915"><span class="linenos"> 915</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-916"><a href="#traction-916"><span class="linenos"> 916</span></a><span class="sd">         _append_idc_select adds the sql select statements for an idc dict.</span>
</span><span id="traction-917"><a href="#traction-917"><span class="linenos"> 917</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-918"><a href="#traction-918"><span class="linenos"> 918</span></a>        <span class="n">idca</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-919"><a href="#traction-919"><span class="linenos"> 919</span></a>        <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="traction-920"><a href="#traction-920"><span class="linenos"> 920</span></a>          <span class="k">if</span> <span class="n">verb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;idc&quot;</span><span class="p">]:</span>
</span><span id="traction-921"><a href="#traction-921"><span class="linenos"> 921</span></a>            <span class="n">idca</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">verb</span><span class="p">)</span>
</span><span id="traction-922"><a href="#traction-922"><span class="linenos"> 922</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">idca</span><span class="p">:</span>
</span><span id="traction-923"><a href="#traction-923"><span class="linenos"> 923</span></a>          <span class="n">selectstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="traction-924"><a href="#traction-924"><span class="linenos"> 924</span></a>          <span class="k">if</span> <span class="ow">not</span> <span class="n">selectstr</span> <span class="ow">in</span> <span class="n">selecta</span><span class="p">:</span>
</span><span id="traction-925"><a href="#traction-925"><span class="linenos"> 925</span></a>            <span class="n">selecta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selectstr</span><span class="p">)</span>
</span><span id="traction-926"><a href="#traction-926"><span class="linenos"> 926</span></a>        <span class="k">return</span> <span class="n">selecta</span>
</span><span id="traction-927"><a href="#traction-927"><span class="linenos"> 927</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_append_idc_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">joina</span><span class="p">,</span> <span class="n">idc</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">joins</span><span class="p">):</span>
</span><span id="traction-928"><a href="#traction-928"><span class="linenos"> 928</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-929"><a href="#traction-929"><span class="linenos"> 929</span></a><span class="sd">         _append_idc_join adds the sql join statements for an idc dict.</span>
</span><span id="traction-930"><a href="#traction-930"><span class="linenos"> 930</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-931"><a href="#traction-931"><span class="linenos"> 931</span></a>        <span class="n">idca</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-932"><a href="#traction-932"><span class="linenos"> 932</span></a>        <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="traction-933"><a href="#traction-933"><span class="linenos"> 933</span></a>          <span class="k">if</span> <span class="n">verb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;idc&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">verb</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span> <span class="ow">or</span> <span class="n">verb</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">():</span>
</span><span id="traction-934"><a href="#traction-934"><span class="linenos"> 934</span></a>            <span class="n">idca</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">verb</span><span class="p">)</span>
</span><span id="traction-935"><a href="#traction-935"><span class="linenos"> 935</span></a>        <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-936"><a href="#traction-936"><span class="linenos"> 936</span></a>          <span class="n">idca</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">idc</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="traction-937"><a href="#traction-937"><span class="linenos"> 937</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">idca</span><span class="p">:</span>
</span><span id="traction-938"><a href="#traction-938"><span class="linenos"> 938</span></a>          <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">:</span>
</span><span id="traction-939"><a href="#traction-939"><span class="linenos"> 939</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
</span><span id="traction-940"><a href="#traction-940"><span class="linenos"> 940</span></a>              <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">joina</span><span class="p">:</span>
</span><span id="traction-941"><a href="#traction-941"><span class="linenos"> 941</span></a>                <span class="n">joina</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="traction-942"><a href="#traction-942"><span class="linenos"> 942</span></a>          <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SAMPLE&quot;</span><span class="p">:</span>
</span><span id="traction-943"><a href="#traction-943"><span class="linenos"> 943</span></a>            <span class="n">joinstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;left join centraxx_sampleidcontainer as idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> on idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.sample = sample.oid and idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.idcontainertype = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_idcoid</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="traction-944"><a href="#traction-944"><span class="linenos"> 944</span></a>    
</span><span id="traction-945"><a href="#traction-945"><span class="linenos"> 945</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">joinstr</span> <span class="ow">in</span> <span class="n">joina</span><span class="p">:</span>
</span><span id="traction-946"><a href="#traction-946"><span class="linenos"> 946</span></a>              <span class="n">joina</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">joinstr</span><span class="p">)</span>
</span><span id="traction-947"><a href="#traction-947"><span class="linenos"> 947</span></a>          <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;PATIENT&quot;</span><span class="p">:</span>
</span><span id="traction-948"><a href="#traction-948"><span class="linenos"> 948</span></a>            <span class="n">joinstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;left join centraxx_idcontainer as idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> on idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.patientcontainer = patientcontainer.oid and idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.idcontainertype = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_idcoid</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="traction-949"><a href="#traction-949"><span class="linenos"> 949</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">joinstr</span> <span class="ow">in</span> <span class="n">joina</span><span class="p">:</span> <span class="c1"># neccessary?</span>
</span><span id="traction-950"><a href="#traction-950"><span class="linenos"> 950</span></a>              <span class="n">joina</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">joinstr</span><span class="p">)</span>
</span><span id="traction-951"><a href="#traction-951"><span class="linenos"> 951</span></a>          <span class="k">else</span><span class="p">:</span>
</span><span id="traction-952"><a href="#traction-952"><span class="linenos"> 952</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error: idcontainer kind </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="si">}</span><span class="s2"> not supported.&quot;</span><span class="p">)</span>
</span><span id="traction-953"><a href="#traction-953"><span class="linenos"> 953</span></a>        <span class="k">return</span> <span class="n">joina</span>
</span><span id="traction-954"><a href="#traction-954"><span class="linenos"> 954</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_where</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="p">{},</span> <span class="n">sampleoids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parentids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parentoids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patientids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">locationpaths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kitids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cxxkitids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">samplingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">receiptdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">derivaldates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">first_repositiondates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">repositiondates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stockprocessingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">secondprocessingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span> <span class="n">wherearg</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> <span class="c1"># -&gt; (str, [])</span>
</span><span id="traction-955"><a href="#traction-955"><span class="linenos"> 955</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-956"><a href="#traction-956"><span class="linenos"> 956</span></a><span class="sd">         _where returns the wherestring and args array for the provided</span>
</span><span id="traction-957"><a href="#traction-957"><span class="linenos"> 957</span></a><span class="sd">         arguments (that are not None).</span>
</span><span id="traction-958"><a href="#traction-958"><span class="linenos"> 958</span></a><span class="sd">         </span>
</span><span id="traction-959"><a href="#traction-959"><span class="linenos"> 959</span></a><span class="sd">         the user needs to make sure that whatever is referenced here is joined</span>
</span><span id="traction-960"><a href="#traction-960"><span class="linenos"> 960</span></a><span class="sd">         into the query before.</span>
</span><span id="traction-961"><a href="#traction-961"><span class="linenos"> 961</span></a><span class="sd">         </span>
</span><span id="traction-962"><a href="#traction-962"><span class="linenos"> 962</span></a><span class="sd">         the names are assumed to be the tr constants, like</span>
</span><span id="traction-963"><a href="#traction-963"><span class="linenos"> 963</span></a><span class="sd">         e.g. tr.sampleid. like is an array of tr constants of the arguments</span>
</span><span id="traction-964"><a href="#traction-964"><span class="linenos"> 964</span></a><span class="sd">         for which it checks likeness. we only check likeness for the first</span>
</span><span id="traction-965"><a href="#traction-965"><span class="linenos"> 965</span></a><span class="sd">         passed string of an argument array. if for example</span>
</span><span id="traction-966"><a href="#traction-966"><span class="linenos"> 966</span></a><span class="sd">         like=[tr.locationpath], it checks likeness of locationpaths[0].</span>
</span><span id="traction-967"><a href="#traction-967"><span class="linenos"> 967</span></a><span class="sd">         </span>
</span><span id="traction-968"><a href="#traction-968"><span class="linenos"> 968</span></a><span class="sd">         make sure only one of sampleids or extsampleids is passed?</span>
</span><span id="traction-969"><a href="#traction-969"><span class="linenos"> 969</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-970"><a href="#traction-970"><span class="linenos"> 970</span></a>        <span class="n">wheredict</span> <span class="o">=</span> <span class="p">{</span> 
</span><span id="traction-971"><a href="#traction-971"><span class="linenos"> 971</span></a>          <span class="n">trial</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">trials</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;flexistudy.code&quot;</span> <span class="p">},</span>
</span><span id="traction-972"><a href="#traction-972"><span class="linenos"> 972</span></a>          <span class="n">locationpath</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">locationpaths</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;samplelocation.locationpath&quot;</span> <span class="p">},</span>
</span><span id="traction-973"><a href="#traction-973"><span class="linenos"> 973</span></a>          <span class="n">method</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">methods</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;labormethod.code&quot;</span> <span class="p">},</span>
</span><span id="traction-974"><a href="#traction-974"><span class="linenos"> 974</span></a>          <span class="n">kitid</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">kitids</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;samplekit.kitid&quot;</span> <span class="p">},</span>
</span><span id="traction-975"><a href="#traction-975"><span class="linenos"> 975</span></a>          <span class="n">cxxkitid</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">cxxkitids</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;samplekit.cxxkitid&quot;</span> <span class="p">},</span>
</span><span id="traction-976"><a href="#traction-976"><span class="linenos"> 976</span></a>          <span class="n">category</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">categories</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.dtype&quot;</span> <span class="p">},</span>
</span><span id="traction-977"><a href="#traction-977"><span class="linenos"> 977</span></a>          <span class="n">parentid</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">parentids</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;parentidc.psn&quot;</span> <span class="p">},</span>
</span><span id="traction-978"><a href="#traction-978"><span class="linenos"> 978</span></a>          <span class="n">parentoid</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">parentoids</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.parent&quot;</span> <span class="p">},</span>
</span><span id="traction-979"><a href="#traction-979"><span class="linenos"> 979</span></a>          <span class="n">sampleoid</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">sampleoids</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.oid&quot;</span> <span class="p">},</span>          
</span><span id="traction-980"><a href="#traction-980"><span class="linenos"> 980</span></a>          <span class="n">samplingdate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">samplingdates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.samplingdate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="traction-981"><a href="#traction-981"><span class="linenos"> 981</span></a>          <span class="n">receiptdate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">receiptdates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.receiptdate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="traction-982"><a href="#traction-982"><span class="linenos"> 982</span></a>          <span class="n">derivaldate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">derivaldates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.derivaldate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="traction-983"><a href="#traction-983"><span class="linenos"> 983</span></a>          <span class="n">first_repositiondate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">first_repositiondates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.first_repositiondate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="traction-984"><a href="#traction-984"><span class="linenos"> 984</span></a>          <span class="n">repositiondate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">repositiondates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.repositiondate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="traction-985"><a href="#traction-985"><span class="linenos"> 985</span></a>          <span class="n">stockprocessingdate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">stockprocessingdates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.stockprocessingdate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">},</span>
</span><span id="traction-986"><a href="#traction-986"><span class="linenos"> 986</span></a>          <span class="n">secondprocessingdate</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">secondprocessingdates</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;sample.secondprocessingdate&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span> <span class="p">}</span>
</span><span id="traction-987"><a href="#traction-987"><span class="linenos"> 987</span></a>        <span class="p">}</span>
</span><span id="traction-988"><a href="#traction-988"><span class="linenos"> 988</span></a>        <span class="n">idckeys</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">idc</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="traction-989"><a href="#traction-989"><span class="linenos"> 989</span></a>        <span class="n">idca</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">idckeys</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;idc&quot;</span><span class="p">]))</span>
</span><span id="traction-990"><a href="#traction-990"><span class="linenos"> 990</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">idca</span><span class="p">:</span>
</span><span id="traction-991"><a href="#traction-991"><span class="linenos"> 991</span></a>            <span class="n">wheredict</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction-992"><a href="#traction-992"><span class="linenos"> 992</span></a>                                <span class="s2">&quot;arr&quot;</span><span class="p">:</span> <span class="n">idc</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">idc</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="traction-993"><a href="#traction-993"><span class="linenos"> 993</span></a>                                <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">.psn&quot;</span>
</span><span id="traction-994"><a href="#traction-994"><span class="linenos"> 994</span></a>                             <span class="p">}</span>
</span><span id="traction-995"><a href="#traction-995"><span class="linenos"> 995</span></a>        <span class="p">(</span><span class="n">wherearr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wherebuild</span><span class="p">(</span><span class="n">wheredict</span><span class="p">,</span> <span class="n">like</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="traction-996"><a href="#traction-996"><span class="linenos"> 996</span></a>
</span><span id="traction-997"><a href="#traction-997"><span class="linenos"> 997</span></a>        <span class="n">wherestr</span> <span class="o">=</span> <span class="s2">&quot; and &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wherearr</span><span class="p">)</span>
</span><span id="traction-998"><a href="#traction-998"><span class="linenos"> 998</span></a>        <span class="k">if</span> <span class="n">wherearg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-999"><a href="#traction-999"><span class="linenos"> 999</span></a>           <span class="n">wherestr</span> <span class="o">+=</span> <span class="s2">&quot; and (&quot;</span> <span class="o">+</span> <span class="n">wherearg</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="traction-1000"><a href="#traction-1000"><span class="linenos">1000</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction-1001"><a href="#traction-1001"><span class="linenos">1001</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_wherebuild</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wheredict</span><span class="p">,</span> <span class="n">likearr</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[]):</span> <span class="c1"># ([]string, [])</span>
</span><span id="traction-1002"><a href="#traction-1002"><span class="linenos">1002</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1003"><a href="#traction-1003"><span class="linenos">1003</span></a><span class="sd">         _wherebuild builds wherestrings and fills whereargs.</span>
</span><span id="traction-1004"><a href="#traction-1004"><span class="linenos">1004</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1005"><a href="#traction-1005"><span class="linenos">1005</span></a>        <span class="n">wherestrs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-1006"><a href="#traction-1006"><span class="linenos">1006</span></a>        <span class="n">whereargs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-1007"><a href="#traction-1007"><span class="linenos">1007</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span> <span class="ow">in</span> <span class="n">wheredict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="traction-1008"><a href="#traction-1008"><span class="linenos">1008</span></a>            <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="traction-1009"><a href="#traction-1009"><span class="linenos">1009</span></a>                <span class="k">continue</span>
</span><span id="traction-1010"><a href="#traction-1010"><span class="linenos">1010</span></a>
</span><span id="traction-1011"><a href="#traction-1011"><span class="linenos">1011</span></a>            <span class="k">if</span> <span class="n">likearr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">likearr</span><span class="p">:</span>
</span><span id="traction-1012"><a href="#traction-1012"><span class="linenos">1012</span></a>                <span class="c1"># put in an or-chain of like checks over all elements</span>
</span><span id="traction-1013"><a href="#traction-1013"><span class="linenos">1013</span></a>                <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wherelikes</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]))</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="traction-1014"><a href="#traction-1014"><span class="linenos">1014</span></a>                <span class="n">wherestrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="traction-1015"><a href="#traction-1015"><span class="linenos">1015</span></a>                <span class="n">whereargs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">])</span>
</span><span id="traction-1016"><a href="#traction-1016"><span class="linenos">1016</span></a>            <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">row</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span>
</span><span id="traction-1017"><a href="#traction-1017"><span class="linenos">1017</span></a>                <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NULL&#39;</span><span class="p">:</span>
</span><span id="traction-1018"><a href="#traction-1018"><span class="linenos">1018</span></a>                    <span class="n">wherestrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; is NULL)&quot;</span><span class="p">)</span>
</span><span id="traction-1019"><a href="#traction-1019"><span class="linenos">1019</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="traction-1020"><a href="#traction-1020"><span class="linenos">1020</span></a>                    <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(CAST(&quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; as date) between ISNULL(?, &quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;) and ISNULL(?, &quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;))&quot;</span>
</span><span id="traction-1021"><a href="#traction-1021"><span class="linenos">1021</span></a>                    <span class="n">wherestrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="traction-1022"><a href="#traction-1022"><span class="linenos">1022</span></a>                    <span class="n">whereargs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">])</span>
</span><span id="traction-1023"><a href="#traction-1023"><span class="linenos">1023</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="traction-1024"><a href="#traction-1024"><span class="linenos">1024</span></a>                <span class="n">wherestr</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span>
</span><span id="traction-1025"><a href="#traction-1025"><span class="linenos">1025</span></a>                <span class="n">needsor</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="traction-1026"><a href="#traction-1026"><span class="linenos">1026</span></a>                <span class="k">if</span> <span class="s1">&#39;NULL&#39;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]:</span>
</span><span id="traction-1027"><a href="#traction-1027"><span class="linenos">1027</span></a>                    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;NULL&quot;</span><span class="p">)</span>
</span><span id="traction-1028"><a href="#traction-1028"><span class="linenos">1028</span></a>                    <span class="n">wherestr</span> <span class="o">+=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; is NULL&quot;</span>
</span><span id="traction-1029"><a href="#traction-1029"><span class="linenos">1029</span></a>                    <span class="n">needsor</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="traction-1030"><a href="#traction-1030"><span class="linenos">1030</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="traction-1031"><a href="#traction-1031"><span class="linenos">1031</span></a>                    <span class="k">if</span> <span class="n">needsor</span><span class="p">:</span>
</span><span id="traction-1032"><a href="#traction-1032"><span class="linenos">1032</span></a>                        <span class="n">wherestr</span> <span class="o">+=</span> <span class="s2">&quot; or &quot;</span>
</span><span id="traction-1033"><a href="#traction-1033"><span class="linenos">1033</span></a>                    <span class="n">placeholder</span> <span class="o">=</span> <span class="n">traction</span><span class="o">.</span><span class="n">_sqlinplaceholder</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">]))</span> <span class="c1"># todo put in package? tr._sqlinplaceholder</span>
</span><span id="traction-1034"><a href="#traction-1034"><span class="linenos">1034</span></a>                    <span class="n">wherestr</span> <span class="o">+=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; in &quot;</span> <span class="o">+</span> <span class="n">placeholder</span> <span class="c1"># e.g. samplelocation.locationpath in (?, ?, ?)</span>
</span><span id="traction-1035"><a href="#traction-1035"><span class="linenos">1035</span></a>                <span class="n">wherestr</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
</span><span id="traction-1036"><a href="#traction-1036"><span class="linenos">1036</span></a>                <span class="n">wherestrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wherestr</span><span class="p">)</span>
</span><span id="traction-1037"><a href="#traction-1037"><span class="linenos">1037</span></a>                <span class="n">whereargs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr&quot;</span><span class="p">])</span>
</span><span id="traction-1038"><a href="#traction-1038"><span class="linenos">1038</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">wherestrs</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction-1039"><a href="#traction-1039"><span class="linenos">1039</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_sqlinplaceholder</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="traction-1040"><a href="#traction-1040"><span class="linenos">1040</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1041"><a href="#traction-1041"><span class="linenos">1041</span></a><span class="sd">         _sqlinplaceholder returns a string like (?, ?, ?, ? ...) with n question marks for sql in.</span>
</span><span id="traction-1042"><a href="#traction-1042"><span class="linenos">1042</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1043"><a href="#traction-1043"><span class="linenos">1043</span></a>
</span><span id="traction-1044"><a href="#traction-1044"><span class="linenos">1044</span></a>        <span class="c1"># put this in a package sqlutil?</span>
</span><span id="traction-1045"><a href="#traction-1045"><span class="linenos">1045</span></a>
</span><span id="traction-1046"><a href="#traction-1046"><span class="linenos">1046</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span>
</span><span id="traction-1047"><a href="#traction-1047"><span class="linenos">1047</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="traction-1048"><a href="#traction-1048"><span class="linenos">1048</span></a>            <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;?&quot;</span>
</span><span id="traction-1049"><a href="#traction-1049"><span class="linenos">1049</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="traction-1050"><a href="#traction-1050"><span class="linenos">1050</span></a>                <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span>
</span><span id="traction-1051"><a href="#traction-1051"><span class="linenos">1051</span></a>        <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
</span><span id="traction-1052"><a href="#traction-1052"><span class="linenos">1052</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="traction-1053"><a href="#traction-1053"><span class="linenos">1053</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_whereparam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">like</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="traction-1054"><a href="#traction-1054"><span class="linenos">1054</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1055"><a href="#traction-1055"><span class="linenos">1055</span></a><span class="sd">         _whereparam gives a ?-parameterized sql where expression for name</span>
</span><span id="traction-1056"><a href="#traction-1056"><span class="linenos">1056</span></a><span class="sd">         equal or like parameter for use in queries.</span>
</span><span id="traction-1057"><a href="#traction-1057"><span class="linenos">1057</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1058"><a href="#traction-1058"><span class="linenos">1058</span></a>        <span class="k">if</span> <span class="n">like</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">like</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="traction-1059"><a href="#traction-1059"><span class="linenos">1059</span></a>            <span class="k">return</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; = ?&quot;</span>
</span><span id="traction-1060"><a href="#traction-1060"><span class="linenos">1060</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="traction-1061"><a href="#traction-1061"><span class="linenos">1061</span></a>            <span class="k">return</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; like &#39;%&#39; + ? + &#39;%&#39;&quot;</span>
</span><span id="traction-1062"><a href="#traction-1062"><span class="linenos">1062</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_wherelike</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span><span id="traction-1063"><a href="#traction-1063"><span class="linenos">1063</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1064"><a href="#traction-1064"><span class="linenos">1064</span></a><span class="sd">         _wherelike gives a ?-parameterized sql where like expression.</span>
</span><span id="traction-1065"><a href="#traction-1065"><span class="linenos">1065</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1066"><a href="#traction-1066"><span class="linenos">1066</span></a>        <span class="k">return</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; like &#39;%&#39; + ? + &#39;%&#39;&quot;</span>
</span><span id="traction-1067"><a href="#traction-1067"><span class="linenos">1067</span></a>
</span><span id="traction-1068"><a href="#traction-1068"><span class="linenos">1068</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_wherelikes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span><span id="traction-1069"><a href="#traction-1069"><span class="linenos">1069</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1070"><a href="#traction-1070"><span class="linenos">1070</span></a><span class="sd">         _wherelikes gives a ?-parameterized sql of or-joined where-like</span>
</span><span id="traction-1071"><a href="#traction-1071"><span class="linenos">1071</span></a><span class="sd">         expressions, as many as given n.</span>
</span><span id="traction-1072"><a href="#traction-1072"><span class="linenos">1072</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1073"><a href="#traction-1073"><span class="linenos">1073</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-1074"><a href="#traction-1074"><span class="linenos">1074</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="traction-1075"><a href="#traction-1075"><span class="linenos">1075</span></a>            <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span> <span class="o">+</span> <span class="s2">&quot; like &#39;%&#39; + ? + &#39;%&#39;&quot;</span><span class="p">)</span> <span class="c1"># the sql takes literal plusses like here</span>
</span><span id="traction-1076"><a href="#traction-1076"><span class="linenos">1076</span></a>        <span class="k">return</span> <span class="s2">&quot; or &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="traction-1077"><a href="#traction-1077"><span class="linenos">1077</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_top</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">):</span>
</span><span id="traction-1078"><a href="#traction-1078"><span class="linenos">1078</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1079"><a href="#traction-1079"><span class="linenos">1079</span></a><span class="sd">         _top returns the top string, for, e.g. `select top 100 * from table`, if</span>
</span><span id="traction-1080"><a href="#traction-1080"><span class="linenos">1080</span></a><span class="sd">         top is None return an empty string.</span>
</span><span id="traction-1081"><a href="#traction-1081"><span class="linenos">1081</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1082"><a href="#traction-1082"><span class="linenos">1082</span></a>        <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction-1083"><a href="#traction-1083"><span class="linenos">1083</span></a>           <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;top </span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="traction-1084"><a href="#traction-1084"><span class="linenos">1084</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="traction-1085"><a href="#traction-1085"><span class="linenos">1085</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_idcinit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="traction-1086"><a href="#traction-1086"><span class="linenos">1086</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1087"><a href="#traction-1087"><span class="linenos">1087</span></a><span class="sd">         _idcinit makes a mapping of idcontainers from their code (lower-case) to respective oid and kind.</span>
</span><span id="traction-1088"><a href="#traction-1088"><span class="linenos">1088</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1089"><a href="#traction-1089"><span class="linenos">1089</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;select code, oid, kind from centraxx_idcontainertype&quot;</span>
</span><span id="traction-1090"><a href="#traction-1090"><span class="linenos">1090</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="traction-1091"><a href="#traction-1091"><span class="linenos">1091</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idcoid</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction-1092"><a href="#traction-1092"><span class="linenos">1092</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction-1093"><a href="#traction-1093"><span class="linenos">1093</span></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction-1094"><a href="#traction-1094"><span class="linenos">1094</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">_idcoid</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;oid&quot;</span><span class="p">]</span>
</span><span id="traction-1095"><a href="#traction-1095"><span class="linenos">1095</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span>
</span><span id="traction-1096"><a href="#traction-1096"><span class="linenos">1096</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_rec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recval</span><span class="p">,</span> <span class="n">finding</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Rec</span><span class="p">:</span>
</span><span id="traction-1097"><a href="#traction-1097"><span class="linenos">1097</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1098"><a href="#traction-1098"><span class="linenos">1098</span></a><span class="sd">         _make_rec makes a recorded value instance from db results.</span>
</span><span id="traction-1099"><a href="#traction-1099"><span class="linenos">1099</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1100"><a href="#traction-1100"><span class="linenos">1100</span></a>        <span class="n">out</span><span class="p">:</span><span class="n">Rec</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="traction-1101"><a href="#traction-1101"><span class="linenos">1101</span></a>        <span class="k">if</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;BOOLEAN&quot;</span><span class="p">:</span>
</span><span id="traction-1102"><a href="#traction-1102"><span class="linenos">1102</span></a>            <span class="n">val</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;boolvalue&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="traction-1103"><a href="#traction-1103"><span class="linenos">1103</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">BooleanRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">val</span><span class="p">)</span>
</span><span id="traction-1104"><a href="#traction-1104"><span class="linenos">1104</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;DECIMAL&quot;</span><span class="p">:</span>
</span><span id="traction-1105"><a href="#traction-1105"><span class="linenos">1105</span></a>            <span class="c1">#print(recval[&quot;laborvalue_code&quot;])</span>
</span><span id="traction-1106"><a href="#traction-1106"><span class="linenos">1106</span></a>            <span class="c1">#print(recval)</span>
</span><span id="traction-1107"><a href="#traction-1107"><span class="linenos">1107</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;numericvalue&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;numericvalue&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="traction-1108"><a href="#traction-1108"><span class="linenos">1108</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">NumberRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_unit&quot;</span><span class="p">])</span>
</span><span id="traction-1109"><a href="#traction-1109"><span class="linenos">1109</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;STRING&quot;</span> <span class="ow">or</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;LONGSTRING&quot;</span><span class="p">:</span>
</span><span id="traction-1110"><a href="#traction-1110"><span class="linenos">1110</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">StringRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;stringvalue&quot;</span><span class="p">])</span>
</span><span id="traction-1111"><a href="#traction-1111"><span class="linenos">1111</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;DATE&quot;</span><span class="p">:</span>
</span><span id="traction-1112"><a href="#traction-1112"><span class="linenos">1112</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">DateRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;datevalue&quot;</span><span class="p">])</span>
</span><span id="traction-1113"><a href="#traction-1113"><span class="linenos">1113</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;LONGDATE&quot;</span><span class="p">:</span>
</span><span id="traction-1114"><a href="#traction-1114"><span class="linenos">1114</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">DateRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;datevalueprecision&quot;</span><span class="p">])</span>
</span><span id="traction-1115"><a href="#traction-1115"><span class="linenos">1115</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CATALOG&quot;</span><span class="p">:</span>
</span><span id="traction-1116"><a href="#traction-1116"><span class="linenos">1116</span></a>            <span class="c1"># get the catalog code</span>
</span><span id="traction-1117"><a href="#traction-1117"><span class="linenos">1117</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select catalog.code as &#39;catalog_code&#39; from centraxx_catalog as catalog</span>
</span><span id="traction-1118"><a href="#traction-1118"><span class="linenos">1118</span></a><span class="s2">            where catalog.oid = ?&quot;&quot;&quot;</span> <span class="c1"># do this once for all catalogs on startup or finding() call?</span>
</span><span id="traction-1119"><a href="#traction-1119"><span class="linenos">1119</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">recval</span><span class="p">[</span><span class="s1">&#39;laborvalue_catalog_oid&#39;</span><span class="p">])</span>
</span><span id="traction-1120"><a href="#traction-1120"><span class="linenos">1120</span></a>            <span class="n">catalog_code</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;catalog_code&quot;</span><span class="p">]</span>
</span><span id="traction-1121"><a href="#traction-1121"><span class="linenos">1121</span></a>            <span class="c1"># get the catalog entries</span>
</span><span id="traction-1122"><a href="#traction-1122"><span class="linenos">1122</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select catalogentry.code as &#39;catalogentry_code&#39; from centraxx_recordedvalue as recordedvalue</span>
</span><span id="traction-1123"><a href="#traction-1123"><span class="linenos">1123</span></a><span class="s2">            join centraxx_recordedval_catentry as recordedval_catentry on recordedval_catentry.recordedvalue_oid = recordedvalue.oid</span>
</span><span id="traction-1124"><a href="#traction-1124"><span class="linenos">1124</span></a><span class="s2">            join centraxx_catalogentry as catalogentry on catalogentry.oid = recordedval_catentry.catalogentry_oid</span>
</span><span id="traction-1125"><a href="#traction-1125"><span class="linenos">1125</span></a><span class="s2">            where recordedvalue.oid = ?&quot;&quot;&quot;</span>
</span><span id="traction-1126"><a href="#traction-1126"><span class="linenos">1126</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">recval</span><span class="p">[</span><span class="s1">&#39;oid&#39;</span><span class="p">])</span>
</span><span id="traction-1127"><a href="#traction-1127"><span class="linenos">1127</span></a>            <span class="n">entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-1128"><a href="#traction-1128"><span class="linenos">1128</span></a>            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction-1129"><a href="#traction-1129"><span class="linenos">1129</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;catalogentry_code&quot;</span><span class="p">])</span>
</span><span id="traction-1130"><a href="#traction-1130"><span class="linenos">1130</span></a>            
</span><span id="traction-1131"><a href="#traction-1131"><span class="linenos">1131</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">CatalogRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">catalog</span><span class="o">=</span><span class="n">catalog_code</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">entries</span><span class="p">)</span>
</span><span id="traction-1132"><a href="#traction-1132"><span class="linenos">1132</span></a>        <span class="k">elif</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ENUMERATION&quot;</span> <span class="ow">or</span> <span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OPTIONGROUP&quot;</span><span class="p">:</span>
</span><span id="traction-1133"><a href="#traction-1133"><span class="linenos">1133</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select usageentry.code as &#39;usageentry_code&#39; from centraxx_recordedvalue as recordedvalue</span>
</span><span id="traction-1134"><a href="#traction-1134"><span class="linenos">1134</span></a><span class="s2">            join centraxx_recordedval_usagentry as recordedval_usagentry on recordedval_usagentry.recordedvalue_oid = recordedvalue.oid</span>
</span><span id="traction-1135"><a href="#traction-1135"><span class="linenos">1135</span></a><span class="s2">            join centraxx_usageentry as usageentry on usageentry.oid = recordedval_usagentry.usageentry_oid</span>
</span><span id="traction-1136"><a href="#traction-1136"><span class="linenos">1136</span></a><span class="s2">            where recordedvalue.oid = ?&quot;&quot;&quot;</span>
</span><span id="traction-1137"><a href="#traction-1137"><span class="linenos">1137</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">recval</span><span class="p">[</span><span class="s1">&#39;oid&#39;</span><span class="p">])</span>
</span><span id="traction-1138"><a href="#traction-1138"><span class="linenos">1138</span></a>            <span class="n">entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-1139"><a href="#traction-1139"><span class="linenos">1139</span></a>            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction-1140"><a href="#traction-1140"><span class="linenos">1140</span></a>                <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;usageentry_code&quot;</span><span class="p">])</span>
</span><span id="traction-1141"><a href="#traction-1141"><span class="linenos">1141</span></a>            
</span><span id="traction-1142"><a href="#traction-1142"><span class="linenos">1142</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">MultiRec</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">finding</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span> <span class="n">labval</span><span class="o">=</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="n">entries</span><span class="p">)</span>
</span><span id="traction-1143"><a href="#traction-1143"><span class="linenos">1143</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="traction-1144"><a href="#traction-1144"><span class="linenos">1144</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no record class for laborvalue of type </span><span class="si">{</span><span class="n">recval</span><span class="p">[</span><span class="s1">&#39;laborvalue_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="traction-1145"><a href="#traction-1145"><span class="linenos">1145</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="traction-1146"><a href="#traction-1146"><span class="linenos">1146</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_sampleidcs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="traction-1147"><a href="#traction-1147"><span class="linenos">1147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1148"><a href="#traction-1148"><span class="linenos">1148</span></a><span class="sd">         _sampleidcs returns the idcs from settings that are specific for sample.</span>
</span><span id="traction-1149"><a href="#traction-1149"><span class="linenos">1149</span></a><span class="sd">         </span>
</span><span id="traction-1150"><a href="#traction-1150"><span class="linenos">1150</span></a><span class="sd">         rather make this a section in conf?</span>
</span><span id="traction-1151"><a href="#traction-1151"><span class="linenos">1151</span></a><span class="sd">         </span>
</span><span id="traction-1152"><a href="#traction-1152"><span class="linenos">1152</span></a><span class="sd">         # idc holds idcontainer codes that should be queryable as command line flags </span>
</span><span id="traction-1153"><a href="#traction-1153"><span class="linenos">1153</span></a><span class="sd">         idc:</span>
</span><span id="traction-1154"><a href="#traction-1154"><span class="linenos">1154</span></a><span class="sd">           sample:</span>
</span><span id="traction-1155"><a href="#traction-1155"><span class="linenos">1155</span></a><span class="sd">             - extsampleid</span>
</span><span id="traction-1156"><a href="#traction-1156"><span class="linenos">1156</span></a><span class="sd">             - modul</span>
</span><span id="traction-1157"><a href="#traction-1157"><span class="linenos">1157</span></a><span class="sd">             - tier</span>
</span><span id="traction-1158"><a href="#traction-1158"><span class="linenos">1158</span></a><span class="sd">           patient:</span>
</span><span id="traction-1159"><a href="#traction-1159"><span class="linenos">1159</span></a><span class="sd">             - mpi</span>
</span><span id="traction-1160"><a href="#traction-1160"><span class="linenos">1160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1161"><a href="#traction-1161"><span class="linenos">1161</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-1162"><a href="#traction-1162"><span class="linenos">1162</span></a>        <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;idc&quot;</span><span class="p">]:</span>
</span><span id="traction-1163"><a href="#traction-1163"><span class="linenos">1163</span></a>            <span class="k">if</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">idc</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SAMPLE&quot;</span><span class="p">:</span>
</span><span id="traction-1164"><a href="#traction-1164"><span class="linenos">1164</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idc</span><span class="p">)</span>
</span><span id="traction-1165"><a href="#traction-1165"><span class="linenos">1165</span></a>        <span class="c1"># include the main sample idcontainer</span>
</span><span id="traction-1166"><a href="#traction-1166"><span class="linenos">1166</span></a>        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="traction-1167"><a href="#traction-1167"><span class="linenos">1167</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="traction-1168"><a href="#traction-1168"><span class="linenos">1168</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_patientidcs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="traction-1169"><a href="#traction-1169"><span class="linenos">1169</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1170"><a href="#traction-1170"><span class="linenos">1170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1171"><a href="#traction-1171"><span class="linenos">1171</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-1172"><a href="#traction-1172"><span class="linenos">1172</span></a>        <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;idc&quot;</span><span class="p">]:</span>
</span><span id="traction-1173"><a href="#traction-1173"><span class="linenos">1173</span></a>            <span class="k">if</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idckind</span><span class="p">[</span><span class="n">idc</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;PATIENT&quot;</span><span class="p">:</span>
</span><span id="traction-1174"><a href="#traction-1174"><span class="linenos">1174</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idc</span><span class="p">)</span>
</span><span id="traction-1175"><a href="#traction-1175"><span class="linenos">1175</span></a>        <span class="c1"># include the main patient idcontainer</span>
</span><span id="traction-1176"><a href="#traction-1176"><span class="linenos">1176</span></a>        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span>
</span><span id="traction-1177"><a href="#traction-1177"><span class="linenos">1177</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="traction-1178"><a href="#traction-1178"><span class="linenos">1178</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_concrete_idcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="p">):</span>
</span><span id="traction-1179"><a href="#traction-1179"><span class="linenos">1179</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1180"><a href="#traction-1180"><span class="linenos">1180</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1181"><a href="#traction-1181"><span class="linenos">1181</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-1182"><a href="#traction-1182"><span class="linenos">1182</span></a>        <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="traction-1183"><a href="#traction-1183"><span class="linenos">1183</span></a>            <span class="k">if</span> <span class="n">verb</span> <span class="o">==</span> <span class="n">patientid</span><span class="p">:</span>
</span><span id="traction-1184"><a href="#traction-1184"><span class="linenos">1184</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span>
</span><span id="traction-1185"><a href="#traction-1185"><span class="linenos">1185</span></a>            <span class="k">elif</span> <span class="n">verb</span> <span class="o">==</span> <span class="n">sampleid</span><span class="p">:</span>
</span><span id="traction-1186"><a href="#traction-1186"><span class="linenos">1186</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="traction-1187"><a href="#traction-1187"><span class="linenos">1187</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="traction-1188"><a href="#traction-1188"><span class="linenos">1188</span></a>                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">verb</span><span class="p">)</span>
</span><span id="traction-1189"><a href="#traction-1189"><span class="linenos">1189</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="traction-1190"><a href="#traction-1190"><span class="linenos">1190</span></a>    
</span><span id="traction-1191"><a href="#traction-1191"><span class="linenos">1191</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_fill_in_primary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">:</span><span class="n">Sample</span><span class="p">):</span>
</span><span id="traction-1192"><a href="#traction-1192"><span class="linenos">1192</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction-1193"><a href="#traction-1193"><span class="linenos">1193</span></a><span class="sd">         _fill_in_primary adds a reference to the given sample&#39;s primary sample,</span>
</span><span id="traction-1194"><a href="#traction-1194"><span class="linenos">1194</span></a><span class="sd">         if there is one.</span>
</span><span id="traction-1195"><a href="#traction-1195"><span class="linenos">1195</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction-1196"><a href="#traction-1196"><span class="linenos">1196</span></a>        <span class="n">poids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction-1197"><a href="#traction-1197"><span class="linenos">1197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_get_parents</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="s2">&quot;oid&quot;</span><span class="p">),</span> <span class="n">poids</span><span class="p">)</span>
</span><span id="traction-1198"><a href="#traction-1198"><span class="linenos">1198</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">poids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="traction-1199"><a href="#traction-1199"><span class="linenos">1199</span></a>            <span class="n">primary_oid</span> <span class="o">=</span> <span class="n">poids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="traction-1200"><a href="#traction-1200"><span class="linenos">1200</span></a>            <span class="n">primary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">oids</span><span class="o">=</span><span class="p">[</span><span class="n">primary_oid</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="traction-1201"><a href="#traction-1201"><span class="linenos">1201</span></a>            <span class="n">sample</span><span class="o">.</span><span class="n">primary</span> <span class="o">=</span> <span class="n">Idable</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">primary</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span> <span class="n">mainidc</span><span class="o">=</span><span class="n">primary</span><span class="o">.</span><span class="n">mainidc</span><span class="p">)</span>
</span></pre></div>


    

                            <div id="traction.__init__" class="classattr">
                                        <input id="traction.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">traction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">target</span></span>)</span>

                <label class="view-source-button" for="traction.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#traction.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="traction.__init__-388"><a href="#traction.__init__-388"><span class="linenos">388</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
</span><span id="traction.__init__-389"><a href="#traction.__init__-389"><span class="linenos">389</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction.__init__-390"><a href="#traction.__init__-390"><span class="linenos">390</span></a><span class="sd">         __init__ takes the db target either as string or dbcq object.</span>
</span><span id="traction.__init__-391"><a href="#traction.__init__-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction.__init__-392"><a href="#traction.__init__-392"><span class="linenos">392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">cnf</span><span class="o">.</span><span class="n">makeload</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;.traction/settings.yaml&quot;</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">cnf</span><span class="o">.</span><span class="n">home</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;yaml&quot;</span><span class="p">,</span> <span class="n">make</span><span class="o">=</span><span class="n">cnftemplate</span><span class="p">)</span>        
</span><span id="traction.__init__-393"><a href="#traction.__init__-393"><span class="linenos">393</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.__init__-394"><a href="#traction.__init__-394"><span class="linenos">394</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;no settings.&quot;</span><span class="p">)</span>
</span><span id="traction.__init__-395"><a href="#traction.__init__-395"><span class="linenos">395</span></a>            <span class="k">return</span>
</span><span id="traction.__init__-396"><a href="#traction.__init__-396"><span class="linenos">396</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="traction.__init__-397"><a href="#traction.__init__-397"><span class="linenos">397</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">dbcq</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="traction.__init__-398"><a href="#traction.__init__-398"><span class="linenos">398</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">dbcq</span><span class="p">):</span> 
</span><span id="traction.__init__-399"><a href="#traction.__init__-399"><span class="linenos">399</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">target</span>
</span><span id="traction.__init__-400"><a href="#traction.__init__-400"><span class="linenos">400</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="traction.__init__-401"><a href="#traction.__init__-401"><span class="linenos">401</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;target needs to be string or dbcq instance&quot;</span><span class="p">)</span>
</span><span id="traction.__init__-402"><a href="#traction.__init__-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idcinit</span><span class="p">()</span>
</span><span id="traction.__init__-403"><a href="#traction.__init__-403"><span class="linenos">403</span></a>        <span class="c1">#print(f&quot;_idcoids: {self._idcoids}&quot;)</span>
</span><span id="traction.__init__-404"><a href="#traction.__init__-404"><span class="linenos">404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">jd</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction.__init__-405"><a href="#traction.__init__-405"><span class="linenos">405</span></a>            <span class="s2">&quot;sample_to_samplekit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;left join centraxx_samplekititem as samplekititem on samplekititem.tubebarcode = idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn&quot;</span><span class="p">,</span> <span class="s2">&quot;left join centraxx_samplekit as samplekit on samplekit.oid = samplekititem.samplekit&quot;</span><span class="p">],</span>
</span><span id="traction.__init__-406"><a href="#traction.__init__-406"><span class="linenos">406</span></a>            <span class="s2">&quot;sample_to_parentid&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;left join centraxx_sampleidcontainer parentidc on parentidc.sample = sample.parent and parentidc.idcontainertype=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_idcoid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span>
</span><span id="traction.__init__-407"><a href="#traction.__init__-407"><span class="linenos">407</span></a>            <span class="s2">&quot;sample_to_samplelocation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_samplelocation samplelocation on samplelocation.oid = sample.samplelocation&quot;</span><span class="p">],</span>
</span><span id="traction.__init__-408"><a href="#traction.__init__-408"><span class="linenos">408</span></a>            <span class="s2">&quot;sample_to_sampletype&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_sampletype as sampletype on sampletype.oid = sample.sampletype&quot;</span><span class="p">],</span>
</span><span id="traction.__init__-409"><a href="#traction.__init__-409"><span class="linenos">409</span></a>            <span class="s2">&quot;sample_to_stockprocessing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_stockprocessing as stockprocessing on sample.stockprocessing = stockprocessing.oid&quot;</span><span class="p">],</span>
</span><span id="traction.__init__-410"><a href="#traction.__init__-410"><span class="linenos">410</span></a>            <span class="s2">&quot;sample_to_secondprocessing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_stockprocessing as secondprocessing on sample.secondprocessing = secondprocessing.oid&quot;</span><span class="p">],</span>
</span><span id="traction.__init__-411"><a href="#traction.__init__-411"><span class="linenos">411</span></a>            <span class="s2">&quot;sample_to_project&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_project as project on sample.project = project.oid&quot;</span><span class="p">],</span>
</span><span id="traction.__init__-412"><a href="#traction.__init__-412"><span class="linenos">412</span></a>            <span class="s2">&quot;sample_to_patient&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_patientcontainer as patientcontainer on sample.patientcontainer = patientcontainer.oid&quot;</span><span class="p">],</span>
</span><span id="traction.__init__-413"><a href="#traction.__init__-413"><span class="linenos">413</span></a>            <span class="s2">&quot;sample_to_receptacle&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_samplereceptable as receptable on sample.receptable = receptable.oid&quot;</span><span class="p">],</span> <span class="c1"># receptable seems to be a typo in the table naming</span>
</span><span id="traction.__init__-414"><a href="#traction.__init__-414"><span class="linenos">414</span></a>            <span class="s2">&quot;sample_to_orga&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_organisationunit as organisationunit on sample.orgunit = organisationunit.oid&quot;</span><span class="p">],</span>
</span><span id="traction.__init__-415"><a href="#traction.__init__-415"><span class="linenos">415</span></a>            <span class="s2">&quot;sample_to_trial&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_flexistudy as flexistudy on sample.flexistudy = flexistudy.oid&quot;</span><span class="p">]</span>
</span><span id="traction.__init__-416"><a href="#traction.__init__-416"><span class="linenos">416</span></a>            <span class="p">,</span>
</span><span id="traction.__init__-417"><a href="#traction.__init__-417"><span class="linenos">417</span></a>            <span class="s2">&quot;patient_to_orga&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_patientorgunit patientorgunit on patientcontainer.oid=patientorgunit.patientcontainer_oid&quot;</span><span class="p">,</span> <span class="s2">&quot;left join centraxx_organisationunit organisationunit on patientorgunit.orgunit_oid=organisationunit.oid&quot;</span><span class="p">],</span>
</span><span id="traction.__init__-418"><a href="#traction.__init__-418"><span class="linenos">418</span></a>            <span class="s2">&quot;patient_to_trial&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_patientstudy as patientstudy on patientstudy.patientcontainer = patientcontainer.oid&quot;</span><span class="p">,</span> <span class="s2">&quot;left join centraxx_flexistudy as flexistudy on flexistudy.oid = patientstudy.flexistudy&quot;</span><span class="p">],</span>
</span><span id="traction.__init__-419"><a href="#traction.__init__-419"><span class="linenos">419</span></a>            <span class="s2">&quot;patient_to_sample&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;left join centraxx_sample sample on sample.patientcontainer = patientcontainer.oid&quot;</span><span class="p">]</span>
</span><span id="traction.__init__-420"><a href="#traction.__init__-420"><span class="linenos">420</span></a>        <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>__init__ takes the db target either as string or dbcq object.</p>
</div>


                            </div>
                            <div id="traction.settings" class="classattr">
                                <div class="attr variable">
            <span class="name">settings</span>

        
    </div>
    <a class="headerlink" href="#traction.settings"></a>
    
    

                            </div>
                            <div id="traction.jd" class="classattr">
                                <div class="attr variable">
            <span class="name">jd</span>

        
    </div>
    <a class="headerlink" href="#traction.jd"></a>
    
    

                            </div>
                            <div id="traction.sample" class="classattr">
                                        <input id="traction.sample-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sample</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">sampleids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">oids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">idc</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">patientids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">parentids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">parentoids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">locationpaths</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">trials</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">kitids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">cxxkitids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">categories</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">samplingdates</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">receiptdates</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">derivaldates</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">first_repositiondates</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">repositiondates</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">stockprocessingdates</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">secondprocessingdates</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="p">[]</span>,</span><span class="param">	<span class="n">verbose_all</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">primaryref</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">incl_parents</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">incl_childs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">incl_tree</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">like</span><span class="o">=</span><span class="p">[]</span>,</span><span class="param">	<span class="n">missing</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">where</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">order_by</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">top</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">print_query</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">raw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="traction.sample-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#traction.sample"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="traction.sample-422"><a href="#traction.sample-422"><span class="linenos">422</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampleids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patientids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parentids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parentoids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">locationpaths</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kitids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cxxkitids</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">categories</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">samplingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">receiptdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">derivaldates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">first_repositiondates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">repositiondates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stockprocessingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">secondprocessingdates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">primaryref</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incl_parents</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incl_childs</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incl_tree</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="p">[],</span> <span class="n">missing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_query</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">raw</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="traction.sample-423"><a href="#traction.sample-423"><span class="linenos">423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction.sample-424"><a href="#traction.sample-424"><span class="linenos">424</span></a><span class="sd">         sample gets sample(s) and returns them as a list of Sample instances.</span>
</span><span id="traction.sample-425"><a href="#traction.sample-425"><span class="linenos">425</span></a><span class="sd">         </span>
</span><span id="traction.sample-426"><a href="#traction.sample-426"><span class="linenos">426</span></a><span class="sd">         pass sampleids and other values to filter for as lists of strings,</span>
</span><span id="traction.sample-427"><a href="#traction.sample-427"><span class="linenos">427</span></a><span class="sd">         e.g. `sampleids=[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]`.</span>
</span><span id="traction.sample-428"><a href="#traction.sample-428"><span class="linenos">428</span></a><span class="sd">         </span>
</span><span id="traction.sample-429"><a href="#traction.sample-429"><span class="linenos">429</span></a><span class="sd">         use the idc param to filter for idcontainer lists by passing a dict of</span>
</span><span id="traction.sample-430"><a href="#traction.sample-430"><span class="linenos">430</span></a><span class="sd">         lists keyed by idcontainer code, e.g. `idc={&quot;extsampleid&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]}`.</span>
</span><span id="traction.sample-431"><a href="#traction.sample-431"><span class="linenos">431</span></a><span class="sd">         </span>
</span><span id="traction.sample-432"><a href="#traction.sample-432"><span class="linenos">432</span></a><span class="sd">         put info that should be joined into the result into the verbose array,</span>
</span><span id="traction.sample-433"><a href="#traction.sample-433"><span class="linenos">433</span></a><span class="sd">         e.g.  `verbose=[tr.locationpath]`. to join in everything, say</span>
</span><span id="traction.sample-434"><a href="#traction.sample-434"><span class="linenos">434</span></a><span class="sd">         `verbose_all=True`. this is slower than non-verbose.</span>
</span><span id="traction.sample-435"><a href="#traction.sample-435"><span class="linenos">435</span></a><span class="sd">         </span>
</span><span id="traction.sample-436"><a href="#traction.sample-436"><span class="linenos">436</span></a><span class="sd">         pass dates as a tuple of from and to datetime, e.g. `samplingdates=(datefrom, None)`.</span>
</span><span id="traction.sample-437"><a href="#traction.sample-437"><span class="linenos">437</span></a><span class="sd">         </span>
</span><span id="traction.sample-438"><a href="#traction.sample-438"><span class="linenos">438</span></a><span class="sd">         to check via like as opposed to exact, put the respective fields into</span>
</span><span id="traction.sample-439"><a href="#traction.sample-439"><span class="linenos">439</span></a><span class="sd">         the like array, e.g. `like=[tr.locationpath]`.</span>
</span><span id="traction.sample-440"><a href="#traction.sample-440"><span class="linenos">440</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction.sample-441"><a href="#traction.sample-441"><span class="linenos">441</span></a>        <span class="c1"># print(&quot;try:&quot; + tr.sampleid)</span>
</span><span id="traction.sample-442"><a href="#traction.sample-442"><span class="linenos">442</span></a>        <span class="n">vaa</span> <span class="o">=</span> <span class="p">[</span><span class="n">cxxkitid</span><span class="p">,</span> <span class="n">kitid</span><span class="p">,</span> <span class="n">locationname</span><span class="p">,</span> <span class="n">locationpath</span><span class="p">,</span> <span class="n">orga</span><span class="p">,</span> <span class="n">parentid</span><span class="p">,</span> 
</span><span id="traction.sample-443"><a href="#traction.sample-443"><span class="linenos">443</span></a>               <span class="n">project</span><span class="p">,</span> <span class="n">receptacle</span><span class="p">,</span> <span class="n">sampletype</span><span class="p">,</span>
</span><span id="traction.sample-444"><a href="#traction.sample-444"><span class="linenos">444</span></a>               <span class="n">secondprocessing</span><span class="p">,</span> <span class="n">stockprocessing</span><span class="p">,</span> <span class="n">trial</span><span class="p">]</span>
</span><span id="traction.sample-445"><a href="#traction.sample-445"><span class="linenos">445</span></a>        <span class="n">vaa</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">())</span>
</span><span id="traction.sample-446"><a href="#traction.sample-446"><span class="linenos">446</span></a>        <span class="n">vaa</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sampleidcs</span><span class="p">())</span>                
</span><span id="traction.sample-447"><a href="#traction.sample-447"><span class="linenos">447</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="traction.sample-448"><a href="#traction.sample-448"><span class="linenos">448</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="traction.sample-449"><a href="#traction.sample-449"><span class="linenos">449</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concrete_idcs</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="traction.sample-450"><a href="#traction.sample-450"><span class="linenos">450</span></a>        <span class="k">if</span> <span class="n">trials</span><span class="p">:</span>
</span><span id="traction.sample-451"><a href="#traction.sample-451"><span class="linenos">451</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span>
</span><span id="traction.sample-452"><a href="#traction.sample-452"><span class="linenos">452</span></a>        <span class="k">if</span> <span class="n">locationpaths</span><span class="p">:</span>
</span><span id="traction.sample-453"><a href="#traction.sample-453"><span class="linenos">453</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">locationpath</span><span class="p">)</span>
</span><span id="traction.sample-454"><a href="#traction.sample-454"><span class="linenos">454</span></a>        <span class="k">if</span> <span class="n">kitids</span><span class="p">:</span>
</span><span id="traction.sample-455"><a href="#traction.sample-455"><span class="linenos">455</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kitid</span><span class="p">)</span>
</span><span id="traction.sample-456"><a href="#traction.sample-456"><span class="linenos">456</span></a>        <span class="k">if</span> <span class="n">cxxkitid</span><span class="p">:</span>
</span><span id="traction.sample-457"><a href="#traction.sample-457"><span class="linenos">457</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cxxkitid</span><span class="p">)</span>
</span><span id="traction.sample-458"><a href="#traction.sample-458"><span class="linenos">458</span></a>        <span class="k">if</span> <span class="n">parentids</span><span class="p">:</span>
</span><span id="traction.sample-459"><a href="#traction.sample-459"><span class="linenos">459</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parentid</span><span class="p">)</span>
</span><span id="traction.sample-460"><a href="#traction.sample-460"><span class="linenos">460</span></a>        <span class="k">if</span> <span class="n">verbose_all</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="traction.sample-461"><a href="#traction.sample-461"><span class="linenos">461</span></a>            <span class="n">verbose</span> <span class="o">=</span> <span class="n">vaa</span>
</span><span id="traction.sample-462"><a href="#traction.sample-462"><span class="linenos">462</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">_checkverbose</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="n">vaa</span><span class="p">):</span> 
</span><span id="traction.sample-463"><a href="#traction.sample-463"><span class="linenos">463</span></a>            <span class="k">return</span> <span class="kc">None</span> <span class="c1"># throw error?</span>
</span><span id="traction.sample-464"><a href="#traction.sample-464"><span class="linenos">464</span></a>        <span class="k">if</span> <span class="n">incl_parents</span> <span class="ow">or</span> <span class="n">incl_childs</span> <span class="ow">or</span> <span class="n">incl_tree</span> <span class="ow">or</span> <span class="n">primaryref</span><span class="p">:</span>
</span><span id="traction.sample-465"><a href="#traction.sample-465"><span class="linenos">465</span></a>            <span class="n">verbosepass</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.sample-466"><a href="#traction.sample-466"><span class="linenos">466</span></a>            <span class="k">if</span> <span class="n">primaryref</span><span class="p">:</span>
</span><span id="traction.sample-467"><a href="#traction.sample-467"><span class="linenos">467</span></a>                <span class="n">verbosepass</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="traction.sample-468"><a href="#traction.sample-468"><span class="linenos">468</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sampleids</span><span class="o">=</span><span class="n">sampleids</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">parentids</span><span class="o">=</span><span class="n">parentids</span><span class="p">,</span> <span class="n">parentoids</span><span class="o">=</span><span class="n">parentoids</span><span class="p">,</span> <span class="n">patientids</span><span class="o">=</span><span class="n">patientids</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">,</span> <span class="n">locationpaths</span><span class="o">=</span><span class="n">locationpaths</span><span class="p">,</span> <span class="n">kitids</span><span class="o">=</span><span class="n">kitids</span><span class="p">,</span> <span class="n">cxxkitids</span><span class="o">=</span><span class="n">cxxkitids</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">samplingdates</span><span class="o">=</span><span class="n">samplingdates</span><span class="p">,</span> <span class="n">receiptdates</span><span class="o">=</span><span class="n">receiptdates</span><span class="p">,</span> <span class="n">derivaldates</span><span class="o">=</span><span class="n">derivaldates</span><span class="p">,</span> <span class="n">first_repositiondates</span><span class="o">=</span><span class="n">first_repositiondates</span><span class="p">,</span> <span class="n">repositiondates</span><span class="o">=</span><span class="n">repositiondates</span><span class="p">,</span> <span class="n">stockprocessingdates</span><span class="o">=</span><span class="n">stockprocessingdates</span><span class="p">,</span> <span class="n">secondprocessingdates</span><span class="o">=</span><span class="n">secondprocessingdates</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbosepass</span><span class="p">,</span> <span class="n">verbose_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="n">missing</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="n">order_by</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span> <span class="n">print_query</span><span class="o">=</span><span class="n">print_query</span><span class="p">)</span>
</span><span id="traction.sample-469"><a href="#traction.sample-469"><span class="linenos">469</span></a>            <span class="k">if</span> <span class="n">primaryref</span><span class="p">:</span>
</span><span id="traction.sample-470"><a href="#traction.sample-470"><span class="linenos">470</span></a>                <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction.sample-471"><a href="#traction.sample-471"><span class="linenos">471</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_fill_in_primary</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="traction.sample-472"><a href="#traction.sample-472"><span class="linenos">472</span></a>                <span class="k">return</span> <span class="n">res</span>
</span><span id="traction.sample-473"><a href="#traction.sample-473"><span class="linenos">473</span></a>            
</span><span id="traction.sample-474"><a href="#traction.sample-474"><span class="linenos">474</span></a>            <span class="n">s_oids</span> <span class="o">=</span> <span class="n">get_ids</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">)</span>
</span><span id="traction.sample-475"><a href="#traction.sample-475"><span class="linenos">475</span></a>            <span class="n">withincl</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.sample-476"><a href="#traction.sample-476"><span class="linenos">476</span></a>            <span class="k">for</span> <span class="n">s_oid</span> <span class="ow">in</span> <span class="n">s_oids</span><span class="p">:</span>
</span><span id="traction.sample-477"><a href="#traction.sample-477"><span class="linenos">477</span></a>               <span class="k">if</span> <span class="n">incl_parents</span><span class="p">:</span>
</span><span id="traction.sample-478"><a href="#traction.sample-478"><span class="linenos">478</span></a>                   <span class="n">p_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.sample-479"><a href="#traction.sample-479"><span class="linenos">479</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_parents</span><span class="p">(</span><span class="n">s_oid</span><span class="p">,</span> <span class="n">p_oids</span><span class="p">)</span>
</span><span id="traction.sample-480"><a href="#traction.sample-480"><span class="linenos">480</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">p_oids</span><span class="p">)</span>
</span><span id="traction.sample-481"><a href="#traction.sample-481"><span class="linenos">481</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_oid</span><span class="p">)</span>
</span><span id="traction.sample-482"><a href="#traction.sample-482"><span class="linenos">482</span></a>               <span class="k">if</span> <span class="n">incl_childs</span><span class="p">:</span>
</span><span id="traction.sample-483"><a href="#traction.sample-483"><span class="linenos">483</span></a>                   <span class="n">c_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.sample-484"><a href="#traction.sample-484"><span class="linenos">484</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_childs</span><span class="p">(</span><span class="n">s_oid</span><span class="p">,</span> <span class="n">c_oids</span><span class="p">)</span>
</span><span id="traction.sample-485"><a href="#traction.sample-485"><span class="linenos">485</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_oid</span><span class="p">)</span>
</span><span id="traction.sample-486"><a href="#traction.sample-486"><span class="linenos">486</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c_oids</span><span class="p">)</span>
</span><span id="traction.sample-487"><a href="#traction.sample-487"><span class="linenos">487</span></a>               <span class="k">if</span> <span class="n">incl_tree</span><span class="p">:</span>
</span><span id="traction.sample-488"><a href="#traction.sample-488"><span class="linenos">488</span></a>                   <span class="n">p_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.sample-489"><a href="#traction.sample-489"><span class="linenos">489</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_parents</span><span class="p">(</span><span class="n">s_oid</span><span class="p">,</span> <span class="n">p_oids</span><span class="p">)</span>
</span><span id="traction.sample-490"><a href="#traction.sample-490"><span class="linenos">490</span></a>                   <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_oids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="traction.sample-491"><a href="#traction.sample-491"><span class="linenos">491</span></a>                       <span class="n">root</span> <span class="o">=</span> <span class="n">p_oids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="traction.sample-492"><a href="#traction.sample-492"><span class="linenos">492</span></a>                   <span class="k">else</span><span class="p">:</span>
</span><span id="traction.sample-493"><a href="#traction.sample-493"><span class="linenos">493</span></a>                       <span class="n">root</span> <span class="o">=</span> <span class="n">s_oid</span>
</span><span id="traction.sample-494"><a href="#traction.sample-494"><span class="linenos">494</span></a>                   <span class="n">c_oids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.sample-495"><a href="#traction.sample-495"><span class="linenos">495</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">_get_childs</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">c_oids</span><span class="p">)</span>
</span><span id="traction.sample-496"><a href="#traction.sample-496"><span class="linenos">496</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="traction.sample-497"><a href="#traction.sample-497"><span class="linenos">497</span></a>                   <span class="n">withincl</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c_oids</span><span class="p">)</span>
</span><span id="traction.sample-498"><a href="#traction.sample-498"><span class="linenos">498</span></a>            <span class="n">withincl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">withincl</span><span class="p">))</span>
</span><span id="traction.sample-499"><a href="#traction.sample-499"><span class="linenos">499</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">oids</span><span class="o">=</span><span class="n">withincl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">print_query</span><span class="o">=</span><span class="n">print_query</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span> <span class="c1"># todo pass verbose_all?</span>
</span><span id="traction.sample-500"><a href="#traction.sample-500"><span class="linenos">500</span></a>        <span class="c1"># todo check that self.sidc() is not in idc</span>
</span><span id="traction.sample-501"><a href="#traction.sample-501"><span class="linenos">501</span></a>        <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.sample-502"><a href="#traction.sample-502"><span class="linenos">502</span></a>           <span class="n">idc</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction.sample-503"><a href="#traction.sample-503"><span class="linenos">503</span></a>        <span class="k">if</span> <span class="n">sampleids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.sample-504"><a href="#traction.sample-504"><span class="linenos">504</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">sampleids</span>
</span><span id="traction.sample-505"><a href="#traction.sample-505"><span class="linenos">505</span></a>        <span class="k">if</span> <span class="n">patientids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.sample-506"><a href="#traction.sample-506"><span class="linenos">506</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">patientids</span>
</span><span id="traction.sample-507"><a href="#traction.sample-507"><span class="linenos">507</span></a>        <span class="n">jselects</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction.sample-508"><a href="#traction.sample-508"><span class="linenos">508</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">sampleid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-509"><a href="#traction.sample-509"><span class="linenos">509</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">patientid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>                   
</span><span id="traction.sample-510"><a href="#traction.sample-510"><span class="linenos">510</span></a>            <span class="n">cxxkitid</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplekit.cxxkitid as &#39;</span><span class="si">{</span><span class="n">cxxkitid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-511"><a href="#traction.sample-511"><span class="linenos">511</span></a>            <span class="c1">#sampleid: [f&quot;sidc.psn as &#39;{sampleid}&#39;&quot;],</span>
</span><span id="traction.sample-512"><a href="#traction.sample-512"><span class="linenos">512</span></a>            <span class="n">parentid</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;parentidc.psn as &#39;</span><span class="si">{</span><span class="n">parentid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-513"><a href="#traction.sample-513"><span class="linenos">513</span></a>            <span class="n">kitid</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplekit.kitid as &#39;</span><span class="si">{</span><span class="n">kitid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-514"><a href="#traction.sample-514"><span class="linenos">514</span></a>            <span class="n">locationname</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplelocation.locationid as &#39;</span><span class="si">{</span><span class="n">locationname</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span> 
</span><span id="traction.sample-515"><a href="#traction.sample-515"><span class="linenos">515</span></a>            <span class="n">locationpath</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;samplelocation.locationpath as &#39;</span><span class="si">{</span><span class="n">locationpath</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-516"><a href="#traction.sample-516"><span class="linenos">516</span></a>            <span class="n">sampletype</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;sampletype.code as &#39;</span><span class="si">{</span><span class="n">sampletype</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-517"><a href="#traction.sample-517"><span class="linenos">517</span></a>            <span class="n">stockprocessing</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;stockprocessing.code as &#39;</span><span class="si">{</span><span class="n">stockprocessing</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-518"><a href="#traction.sample-518"><span class="linenos">518</span></a>            <span class="n">secondprocessing</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;secondprocessing.code as &#39;</span><span class="si">{</span><span class="n">secondprocessing</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-519"><a href="#traction.sample-519"><span class="linenos">519</span></a>            <span class="n">project</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;project.code as &#39;</span><span class="si">{</span><span class="n">project</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-520"><a href="#traction.sample-520"><span class="linenos">520</span></a>            <span class="c1">#patientid: [f&quot;patidc.psn as &#39;{patientid}&#39;&quot;],</span>
</span><span id="traction.sample-521"><a href="#traction.sample-521"><span class="linenos">521</span></a>            <span class="n">receptacle</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;receptable.code as &#39;</span><span class="si">{</span><span class="n">receptacle</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-522"><a href="#traction.sample-522"><span class="linenos">522</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;organisationunit.code as &#39;</span><span class="si">{</span><span class="n">orga</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-523"><a href="#traction.sample-523"><span class="linenos">523</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;flexistudy.code as &#39;</span><span class="si">{</span><span class="n">trial</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.sample-524"><a href="#traction.sample-524"><span class="linenos">524</span></a>        <span class="p">}</span>
</span><span id="traction.sample-525"><a href="#traction.sample-525"><span class="linenos">525</span></a>        <span class="n">lselects</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="traction.sample-526"><a href="#traction.sample-526"><span class="linenos">526</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.amountrest as </span><span class="si">{</span><span class="n">restamount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="traction.sample-527"><a href="#traction.sample-527"><span class="linenos">527</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.appointmentnumber as </span><span class="si">{</span><span class="n">appointment</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="traction.sample-528"><a href="#traction.sample-528"><span class="linenos">528</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.dtype as </span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="traction.sample-529"><a href="#traction.sample-529"><span class="linenos">529</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.oid as </span><span class="si">{</span><span class="n">sampleoid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="traction.sample-530"><a href="#traction.sample-530"><span class="linenos">530</span></a>          <span class="sa">f</span><span class="s2">&quot;sample.parent as </span><span class="si">{</span><span class="n">parentoid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="traction.sample-531"><a href="#traction.sample-531"><span class="linenos">531</span></a>          <span class="s2">&quot;sample.*&quot;</span>
</span><span id="traction.sample-532"><a href="#traction.sample-532"><span class="linenos">532</span></a>        <span class="p">]</span>
</span><span id="traction.sample-533"><a href="#traction.sample-533"><span class="linenos">533</span></a>        <span class="n">joins</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction.sample-534"><a href="#traction.sample-534"><span class="linenos">534</span></a>            <span class="n">cxxkitid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplekit&quot;</span><span class="p">],</span>
</span><span id="traction.sample-535"><a href="#traction.sample-535"><span class="linenos">535</span></a>            <span class="n">parentid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_parentid&quot;</span><span class="p">],</span>
</span><span id="traction.sample-536"><a href="#traction.sample-536"><span class="linenos">536</span></a>            <span class="n">kitid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplekit&quot;</span><span class="p">],</span>
</span><span id="traction.sample-537"><a href="#traction.sample-537"><span class="linenos">537</span></a>            <span class="n">locationname</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplelocation&quot;</span><span class="p">],</span>
</span><span id="traction.sample-538"><a href="#traction.sample-538"><span class="linenos">538</span></a>            <span class="n">locationpath</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_samplelocation&quot;</span><span class="p">],</span>
</span><span id="traction.sample-539"><a href="#traction.sample-539"><span class="linenos">539</span></a>            <span class="n">sampletype</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_sampletype&quot;</span><span class="p">],</span>
</span><span id="traction.sample-540"><a href="#traction.sample-540"><span class="linenos">540</span></a>            <span class="n">stockprocessing</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_stockprocessing&quot;</span><span class="p">],</span>
</span><span id="traction.sample-541"><a href="#traction.sample-541"><span class="linenos">541</span></a>            <span class="n">secondprocessing</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_secondprocessing&quot;</span><span class="p">],</span>
</span><span id="traction.sample-542"><a href="#traction.sample-542"><span class="linenos">542</span></a>            <span class="n">project</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_project&quot;</span><span class="p">],</span>
</span><span id="traction.sample-543"><a href="#traction.sample-543"><span class="linenos">543</span></a>            <span class="n">receptacle</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_receptacle&quot;</span><span class="p">],</span>
</span><span id="traction.sample-544"><a href="#traction.sample-544"><span class="linenos">544</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_orga&quot;</span><span class="p">],</span>
</span><span id="traction.sample-545"><a href="#traction.sample-545"><span class="linenos">545</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_trial&quot;</span><span class="p">]</span>
</span><span id="traction.sample-546"><a href="#traction.sample-546"><span class="linenos">546</span></a>        <span class="p">}</span>
</span><span id="traction.sample-547"><a href="#traction.sample-547"><span class="linenos">547</span></a>        <span class="k">for</span> <span class="n">pidc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">():</span>
</span><span id="traction.sample-548"><a href="#traction.sample-548"><span class="linenos">548</span></a>            <span class="n">joins</span><span class="p">[</span><span class="n">pidc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_patient&quot;</span><span class="p">]</span>
</span><span id="traction.sample-549"><a href="#traction.sample-549"><span class="linenos">549</span></a>        <span class="n">selectstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectstr</span><span class="p">(</span><span class="n">jselects</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">lselects</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="traction.sample-550"><a href="#traction.sample-550"><span class="linenos">550</span></a>        <span class="n">joinstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joinstr</span><span class="p">(</span><span class="n">joins</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="traction.sample-551"><a href="#traction.sample-551"><span class="linenos">551</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">sampleoids</span><span class="o">=</span><span class="n">oids</span><span class="p">,</span> <span class="n">parentids</span><span class="o">=</span><span class="n">parentids</span><span class="p">,</span> <span class="n">parentoids</span><span class="o">=</span><span class="n">parentoids</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">,</span> <span class="n">locationpaths</span><span class="o">=</span><span class="n">locationpaths</span><span class="p">,</span> <span class="n">kitids</span><span class="o">=</span><span class="n">kitids</span><span class="p">,</span> <span class="n">cxxkitids</span><span class="o">=</span><span class="n">cxxkitids</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">samplingdates</span><span class="o">=</span><span class="n">samplingdates</span><span class="p">,</span> <span class="n">receiptdates</span><span class="o">=</span><span class="n">receiptdates</span><span class="p">,</span> <span class="n">derivaldates</span><span class="o">=</span><span class="n">derivaldates</span><span class="p">,</span> <span class="n">first_repositiondates</span><span class="o">=</span><span class="n">first_repositiondates</span><span class="p">,</span> <span class="n">repositiondates</span><span class="o">=</span><span class="n">repositiondates</span><span class="p">,</span> <span class="n">stockprocessingdates</span><span class="o">=</span><span class="n">stockprocessingdates</span><span class="p">,</span> <span class="n">secondprocessingdates</span><span class="o">=</span><span class="n">secondprocessingdates</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">wherearg</span><span class="o">=</span><span class="n">where</span><span class="p">)</span> 
</span><span id="traction.sample-552"><a href="#traction.sample-552"><span class="linenos">552</span></a>        <span class="n">topstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
</span><span id="traction.sample-553"><a href="#traction.sample-553"><span class="linenos">553</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;select </span><span class="si">{</span><span class="n">topstr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">selectstr</span><span class="si">}</span><span class="s2"> from centraxx_sample sample </span><span class="se">\n</span><span class="si">{</span><span class="n">joinstr</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">where </span><span class="si">{</span><span class="n">wherestr</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="traction.sample-554"><a href="#traction.sample-554"><span class="linenos">554</span></a>        <span class="k">if</span> <span class="n">order_by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.sample-555"><a href="#traction.sample-555"><span class="linenos">555</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; order by </span><span class="si">{</span><span class="n">order_by</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="traction.sample-556"><a href="#traction.sample-556"><span class="linenos">556</span></a>        <span class="k">if</span> <span class="n">print_query</span><span class="p">:</span>
</span><span id="traction.sample-557"><a href="#traction.sample-557"><span class="linenos">557</span></a>           <span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="traction.sample-558"><a href="#traction.sample-558"><span class="linenos">558</span></a>           <span class="nb">print</span><span class="p">(</span><span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction.sample-559"><a href="#traction.sample-559"><span class="linenos">559</span></a>
</span><span id="traction.sample-560"><a href="#traction.sample-560"><span class="linenos">560</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction.sample-561"><a href="#traction.sample-561"><span class="linenos">561</span></a>        <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
</span><span id="traction.sample-562"><a href="#traction.sample-562"><span class="linenos">562</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="traction.sample-563"><a href="#traction.sample-563"><span class="linenos">563</span></a>        <span class="n">sarr</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.sample-564"><a href="#traction.sample-564"><span class="linenos">564</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction.sample-565"><a href="#traction.sample-565"><span class="linenos">565</span></a>            <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.sample-566"><a href="#traction.sample-566"><span class="linenos">566</span></a>            <span class="c1">#if dig(r, sampleid) is not None:</span>
</span><span id="traction.sample-567"><a href="#traction.sample-567"><span class="linenos">567</span></a>            <span class="c1">#    ids.append(Identifier(id=dig(r, sampleid), code=self.sidc()))</span>
</span><span id="traction.sample-568"><a href="#traction.sample-568"><span class="linenos">568</span></a>            <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sampleidcs</span><span class="p">():</span>
</span><span id="traction.sample-569"><a href="#traction.sample-569"><span class="linenos">569</span></a>                <span class="c1">#print(&quot;idc:&quot; + idc)</span>
</span><span id="traction.sample-570"><a href="#traction.sample-570"><span class="linenos">570</span></a>                <span class="c1">#print(&quot;r:&quot; + str(r))</span>
</span><span id="traction.sample-571"><a href="#traction.sample-571"><span class="linenos">571</span></a>                <span class="k">if</span> <span class="n">idc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">r</span> <span class="ow">and</span> <span class="n">r</span><span class="p">[</span><span class="n">idc</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.sample-572"><a href="#traction.sample-572"><span class="linenos">572</span></a>                    <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">idc</span><span class="o">.</span><span class="n">lower</span><span class="p">()),</span> <span class="n">code</span><span class="o">=</span><span class="n">idc</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="p">)</span>
</span><span id="traction.sample-573"><a href="#traction.sample-573"><span class="linenos">573</span></a>            <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">sampleoid</span><span class="p">)),</span> <span class="n">code</span><span class="o">=</span><span class="s2">&quot;oid&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># todo rename sampleoid?</span>
</span><span id="traction.sample-574"><a href="#traction.sample-574"><span class="linenos">574</span></a>            <span class="n">pids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.sample-575"><a href="#traction.sample-575"><span class="linenos">575</span></a>            <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="n">parentoid</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.sample-576"><a href="#traction.sample-576"><span class="linenos">576</span></a>                <span class="n">pids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">parentoid</span><span class="p">]),</span> <span class="n">code</span><span class="o">=</span><span class="s2">&quot;oid&quot;</span><span class="p">))</span>
</span><span id="traction.sample-577"><a href="#traction.sample-577"><span class="linenos">577</span></a>            <span class="k">if</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">parentid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.sample-578"><a href="#traction.sample-578"><span class="linenos">578</span></a>                <span class="n">pids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">parentid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()))</span>
</span><span id="traction.sample-579"><a href="#traction.sample-579"><span class="linenos">579</span></a>            <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="traction.sample-580"><a href="#traction.sample-580"><span class="linenos">580</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="traction.sample-581"><a href="#traction.sample-581"><span class="linenos">581</span></a>                <span class="n">parent</span> <span class="o">=</span> <span class="n">Idable</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">pids</span><span class="p">,</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="traction.sample-582"><a href="#traction.sample-582"><span class="linenos">582</span></a>            <span class="n">patids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.sample-583"><a href="#traction.sample-583"><span class="linenos">583</span></a>            <span class="k">if</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">patientid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>   <span class="c1"># todo include patient oid?</span>
</span><span id="traction.sample-584"><a href="#traction.sample-584"><span class="linenos">584</span></a>                <span class="n">patids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">patientid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()))</span>
</span><span id="traction.sample-585"><a href="#traction.sample-585"><span class="linenos">585</span></a>            <span class="n">patient</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="traction.sample-586"><a href="#traction.sample-586"><span class="linenos">586</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">patids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="traction.sample-587"><a href="#traction.sample-587"><span class="linenos">587</span></a>                <span class="n">patient</span> <span class="o">=</span> <span class="n">Idable</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">patids</span><span class="p">,</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span>
</span><span id="traction.sample-588"><a href="#traction.sample-588"><span class="linenos">588</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">(</span>
</span><span id="traction.sample-589"><a href="#traction.sample-589"><span class="linenos">589</span></a>                <span class="n">appointment</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">appointment</span><span class="p">),</span>
</span><span id="traction.sample-590"><a href="#traction.sample-590"><span class="linenos">590</span></a>                <span class="n">category</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">category</span><span class="p">),</span>
</span><span id="traction.sample-591"><a href="#traction.sample-591"><span class="linenos">591</span></a>                <span class="n">samplingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">samplingdate</span><span class="p">),</span>
</span><span id="traction.sample-592"><a href="#traction.sample-592"><span class="linenos">592</span></a>                <span class="n">concentration</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">concentration</span><span class="p">),</span>
</span><span id="traction.sample-593"><a href="#traction.sample-593"><span class="linenos">593</span></a>                <span class="n">cxxkitid</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">cxxkitid</span><span class="p">),</span>
</span><span id="traction.sample-594"><a href="#traction.sample-594"><span class="linenos">594</span></a>                <span class="n">derivaldate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">derivaldate</span><span class="p">),</span>
</span><span id="traction.sample-595"><a href="#traction.sample-595"><span class="linenos">595</span></a>                <span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span>
</span><span id="traction.sample-596"><a href="#traction.sample-596"><span class="linenos">596</span></a>                <span class="n">initialamount</span><span class="o">=</span><span class="n">Amount</span><span class="p">(</span><span class="n">floatornull</span><span class="p">(</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">initialamount</span><span class="p">)),</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">initialunit</span><span class="p">)),</span> <span class="c1"># apparently the cast to float is explicitly needed</span>
</span><span id="traction.sample-597"><a href="#traction.sample-597"><span class="linenos">597</span></a>                <span class="n">kitid</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">kitid</span><span class="p">),</span>
</span><span id="traction.sample-598"><a href="#traction.sample-598"><span class="linenos">598</span></a>                <span class="n">locationpath</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">locationpath</span><span class="p">),</span>
</span><span id="traction.sample-599"><a href="#traction.sample-599"><span class="linenos">599</span></a>                <span class="n">locationname</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">locationname</span><span class="p">),</span>
</span><span id="traction.sample-600"><a href="#traction.sample-600"><span class="linenos">600</span></a>                <span class="n">orga</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">orga</span><span class="p">),</span>
</span><span id="traction.sample-601"><a href="#traction.sample-601"><span class="linenos">601</span></a>                <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
</span><span id="traction.sample-602"><a href="#traction.sample-602"><span class="linenos">602</span></a>                <span class="n">patient</span><span class="o">=</span><span class="n">patient</span><span class="p">,</span>
</span><span id="traction.sample-603"><a href="#traction.sample-603"><span class="linenos">603</span></a>                <span class="n">project</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">project</span><span class="p">),</span>
</span><span id="traction.sample-604"><a href="#traction.sample-604"><span class="linenos">604</span></a>                <span class="n">receiptdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">receiptdate</span><span class="p">),</span>
</span><span id="traction.sample-605"><a href="#traction.sample-605"><span class="linenos">605</span></a>                <span class="n">receptacle</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">receptacle</span><span class="p">),</span>
</span><span id="traction.sample-606"><a href="#traction.sample-606"><span class="linenos">606</span></a>                <span class="n">repositiondate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">repositiondate</span><span class="p">),</span>
</span><span id="traction.sample-607"><a href="#traction.sample-607"><span class="linenos">607</span></a>                <span class="n">restamount</span><span class="o">=</span><span class="n">Amount</span><span class="p">(</span><span class="n">floatornull</span><span class="p">(</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">restamount</span><span class="p">)),</span> <span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">restunit</span><span class="p">)),</span>
</span><span id="traction.sample-608"><a href="#traction.sample-608"><span class="linenos">608</span></a>                <span class="n">secondprocessing</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">secondprocessing</span><span class="p">),</span>
</span><span id="traction.sample-609"><a href="#traction.sample-609"><span class="linenos">609</span></a>                <span class="n">secondprocessingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">secondprocessingdate</span><span class="p">),</span>
</span><span id="traction.sample-610"><a href="#traction.sample-610"><span class="linenos">610</span></a>                <span class="n">sidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">(),</span>
</span><span id="traction.sample-611"><a href="#traction.sample-611"><span class="linenos">611</span></a>                <span class="n">stockprocessing</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">stockprocessing</span><span class="p">),</span>
</span><span id="traction.sample-612"><a href="#traction.sample-612"><span class="linenos">612</span></a>                <span class="n">stockprocessingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">stockprocessingdate</span><span class="p">),</span>
</span><span id="traction.sample-613"><a href="#traction.sample-613"><span class="linenos">613</span></a>                <span class="n">trial</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">trial</span><span class="p">),</span>
</span><span id="traction.sample-614"><a href="#traction.sample-614"><span class="linenos">614</span></a>                <span class="nb">type</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">sampletype</span><span class="p">),</span>
</span><span id="traction.sample-615"><a href="#traction.sample-615"><span class="linenos">615</span></a>                <span class="n">xposition</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">xposition</span><span class="p">),</span> 
</span><span id="traction.sample-616"><a href="#traction.sample-616"><span class="linenos">616</span></a>                <span class="n">yposition</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">yposition</span><span class="p">)</span>
</span><span id="traction.sample-617"><a href="#traction.sample-617"><span class="linenos">617</span></a>            <span class="p">)</span>
</span><span id="traction.sample-618"><a href="#traction.sample-618"><span class="linenos">618</span></a>            <span class="n">sarr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="traction.sample-619"><a href="#traction.sample-619"><span class="linenos">619</span></a>        <span class="k">return</span> <span class="n">sarr</span>
</span></pre></div>


            <div class="docstring"><p>sample gets sample(s) and returns them as a list of Sample instances.</p>

<p>pass sampleids and other values to filter for as lists of strings,
e.g. <code>sampleids=["a", "b", "c"]</code>.</p>

<p>use the idc param to filter for idcontainer lists by passing a dict of
lists keyed by idcontainer code, e.g. <code>idc={"extsampleid": ["a", "b", "c"]}</code>.</p>

<p>put info that should be joined into the result into the verbose array,
e.g.  <code>verbose=[<a href="#locationpath">tr.locationpath</a>]</code>. to join in everything, say
<code>verbose_all=True</code>. this is slower than non-verbose.</p>

<p>pass dates as a tuple of from and to datetime, e.g. <code>samplingdates=(datefrom, None)</code>.</p>

<p>to check via like as opposed to exact, put the respective fields into
the like array, e.g. <code>like=[<a href="#locationpath">tr.locationpath</a>]</code>.</p>
</div>


                            </div>
                            <div id="traction.patient" class="classattr">
                                        <input id="traction.patient-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">patient</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">patientids</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">sampleids</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">idc</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">trials</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">orgas</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="p">[]</span>,</span><span class="param">	<span class="n">verbose_all</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">like</span><span class="o">=</span><span class="p">[]</span>,</span><span class="param">	<span class="n">order_by</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">top</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">print_query</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">raw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="traction.patient-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#traction.patient"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="traction.patient-640"><a href="#traction.patient-640"><span class="linenos">640</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">patient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patientids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sampleids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orgas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="p">[],</span> <span class="n">order_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_query</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">raw</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="traction.patient-641"><a href="#traction.patient-641"><span class="linenos">641</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction.patient-642"><a href="#traction.patient-642"><span class="linenos">642</span></a><span class="sd">         patient gets patients and returns them as a list of Patient instances.</span>
</span><span id="traction.patient-643"><a href="#traction.patient-643"><span class="linenos">643</span></a><span class="sd">         </span>
</span><span id="traction.patient-644"><a href="#traction.patient-644"><span class="linenos">644</span></a><span class="sd">         the parameters work analog to the sample method.</span>
</span><span id="traction.patient-645"><a href="#traction.patient-645"><span class="linenos">645</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction.patient-646"><a href="#traction.patient-646"><span class="linenos">646</span></a>        <span class="n">vaa</span> <span class="o">=</span> <span class="p">[</span><span class="n">orga</span><span class="p">]</span>
</span><span id="traction.patient-647"><a href="#traction.patient-647"><span class="linenos">647</span></a>        <span class="n">vaa</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">())</span>        
</span><span id="traction.patient-648"><a href="#traction.patient-648"><span class="linenos">648</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="traction.patient-649"><a href="#traction.patient-649"><span class="linenos">649</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span>
</span><span id="traction.patient-650"><a href="#traction.patient-650"><span class="linenos">650</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concrete_idcs</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="traction.patient-651"><a href="#traction.patient-651"><span class="linenos">651</span></a>        <span class="k">if</span> <span class="n">verbose_all</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="traction.patient-652"><a href="#traction.patient-652"><span class="linenos">652</span></a>            <span class="n">verbose</span> <span class="o">=</span> <span class="n">vaa</span>
</span><span id="traction.patient-653"><a href="#traction.patient-653"><span class="linenos">653</span></a>        <span class="n">silent</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.patient-654"><a href="#traction.patient-654"><span class="linenos">654</span></a>        <span class="k">if</span> <span class="n">trials</span><span class="p">:</span>
</span><span id="traction.patient-655"><a href="#traction.patient-655"><span class="linenos">655</span></a>            <span class="n">silent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span>
</span><span id="traction.patient-656"><a href="#traction.patient-656"><span class="linenos">656</span></a>        <span class="k">if</span> <span class="n">orgas</span><span class="p">:</span>
</span><span id="traction.patient-657"><a href="#traction.patient-657"><span class="linenos">657</span></a>            <span class="n">silent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orga</span><span class="p">)</span>
</span><span id="traction.patient-658"><a href="#traction.patient-658"><span class="linenos">658</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">_checkverbose</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="n">vaa</span><span class="p">):</span>
</span><span id="traction.patient-659"><a href="#traction.patient-659"><span class="linenos">659</span></a>            <span class="k">return</span> <span class="kc">None</span> <span class="c1"># throw error?</span>
</span><span id="traction.patient-660"><a href="#traction.patient-660"><span class="linenos">660</span></a>        <span class="c1"># todo check that self.sidc() is not in idc</span>
</span><span id="traction.patient-661"><a href="#traction.patient-661"><span class="linenos">661</span></a>        <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.patient-662"><a href="#traction.patient-662"><span class="linenos">662</span></a>           <span class="n">idc</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction.patient-663"><a href="#traction.patient-663"><span class="linenos">663</span></a>        <span class="k">if</span> <span class="n">sampleids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.patient-664"><a href="#traction.patient-664"><span class="linenos">664</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">sampleids</span>
</span><span id="traction.patient-665"><a href="#traction.patient-665"><span class="linenos">665</span></a>        <span class="k">if</span> <span class="n">patientids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.patient-666"><a href="#traction.patient-666"><span class="linenos">666</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">patientids</span>
</span><span id="traction.patient-667"><a href="#traction.patient-667"><span class="linenos">667</span></a>           
</span><span id="traction.patient-668"><a href="#traction.patient-668"><span class="linenos">668</span></a>        <span class="n">selects</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction.patient-669"><a href="#traction.patient-669"><span class="linenos">669</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">patientid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.patient-670"><a href="#traction.patient-670"><span class="linenos">670</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;organisationunit.code as &#39;</span><span class="si">{</span><span class="n">orga</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.patient-671"><a href="#traction.patient-671"><span class="linenos">671</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;flexistudy.code as &#39;</span><span class="si">{</span><span class="n">trial</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.patient-672"><a href="#traction.patient-672"><span class="linenos">672</span></a>        <span class="p">}</span>
</span><span id="traction.patient-673"><a href="#traction.patient-673"><span class="linenos">673</span></a>        <span class="n">joins</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction.patient-674"><a href="#traction.patient-674"><span class="linenos">674</span></a>            <span class="n">orga</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;patient_to_orga&quot;</span><span class="p">],</span>
</span><span id="traction.patient-675"><a href="#traction.patient-675"><span class="linenos">675</span></a>            <span class="n">trial</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;patient_to_trial&quot;</span><span class="p">]</span>
</span><span id="traction.patient-676"><a href="#traction.patient-676"><span class="linenos">676</span></a>        <span class="p">}</span>
</span><span id="traction.patient-677"><a href="#traction.patient-677"><span class="linenos">677</span></a>        <span class="k">for</span> <span class="n">sidc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sampleidcs</span><span class="p">():</span>
</span><span id="traction.patient-678"><a href="#traction.patient-678"><span class="linenos">678</span></a>            <span class="n">joins</span><span class="p">[</span><span class="n">sidc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;patient_to_sample&quot;</span><span class="p">]</span>
</span><span id="traction.patient-679"><a href="#traction.patient-679"><span class="linenos">679</span></a>        <span class="n">selectstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectstr</span><span class="p">(</span><span class="n">selects</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;patientcontainer.*&quot;</span><span class="p">],</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="traction.patient-680"><a href="#traction.patient-680"><span class="linenos">680</span></a>        <span class="n">joinstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joinstr</span><span class="p">(</span><span class="n">joins</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">+</span> <span class="n">silent</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="traction.patient-681"><a href="#traction.patient-681"><span class="linenos">681</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">)</span>
</span><span id="traction.patient-682"><a href="#traction.patient-682"><span class="linenos">682</span></a>        <span class="c1">#print(whereargs)</span>
</span><span id="traction.patient-683"><a href="#traction.patient-683"><span class="linenos">683</span></a>        <span class="n">topstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
</span><span id="traction.patient-684"><a href="#traction.patient-684"><span class="linenos">684</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;select distinct </span><span class="si">{</span><span class="n">topstr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">selectstr</span><span class="si">}</span><span class="s2"> from centraxx_patientcontainer patientcontainer </span><span class="se">\n</span><span class="si">{</span><span class="n">joinstr</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">where </span><span class="si">{</span><span class="n">wherestr</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="traction.patient-685"><a href="#traction.patient-685"><span class="linenos">685</span></a>        <span class="k">if</span> <span class="n">order_by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.patient-686"><a href="#traction.patient-686"><span class="linenos">686</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; order by </span><span class="si">{</span><span class="n">order_by</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="traction.patient-687"><a href="#traction.patient-687"><span class="linenos">687</span></a>        <span class="k">if</span> <span class="n">print_query</span><span class="p">:</span>
</span><span id="traction.patient-688"><a href="#traction.patient-688"><span class="linenos">688</span></a>           <span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="traction.patient-689"><a href="#traction.patient-689"><span class="linenos">689</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction.patient-690"><a href="#traction.patient-690"><span class="linenos">690</span></a>        <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
</span><span id="traction.patient-691"><a href="#traction.patient-691"><span class="linenos">691</span></a>            <span class="k">return</span> <span class="n">raw</span>
</span><span id="traction.patient-692"><a href="#traction.patient-692"><span class="linenos">692</span></a>        <span class="n">pats</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.patient-693"><a href="#traction.patient-693"><span class="linenos">693</span></a>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction.patient-694"><a href="#traction.patient-694"><span class="linenos">694</span></a>            <span class="n">ids</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">patientid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span> <span class="p">]</span>
</span><span id="traction.patient-695"><a href="#traction.patient-695"><span class="linenos">695</span></a>            <span class="k">for</span> <span class="n">idc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">():</span>
</span><span id="traction.patient-696"><a href="#traction.patient-696"><span class="linenos">696</span></a>                <span class="k">if</span> <span class="n">idc</span> <span class="ow">in</span> <span class="n">r</span> <span class="ow">and</span> <span class="n">r</span><span class="p">[</span><span class="n">idc</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.patient-697"><a href="#traction.patient-697"><span class="linenos">697</span></a>                    <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Identifier</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">idc</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="n">idc</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="p">)</span>
</span><span id="traction.patient-698"><a href="#traction.patient-698"><span class="linenos">698</span></a>            <span class="n">pat</span> <span class="o">=</span> <span class="n">Patient</span><span class="p">(</span>
</span><span id="traction.patient-699"><a href="#traction.patient-699"><span class="linenos">699</span></a>              <span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span>
</span><span id="traction.patient-700"><a href="#traction.patient-700"><span class="linenos">700</span></a>              <span class="n">orga</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">orga</span><span class="p">),</span>
</span><span id="traction.patient-701"><a href="#traction.patient-701"><span class="linenos">701</span></a>              <span class="n">pidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span>
</span><span id="traction.patient-702"><a href="#traction.patient-702"><span class="linenos">702</span></a>            <span class="p">)</span>
</span><span id="traction.patient-703"><a href="#traction.patient-703"><span class="linenos">703</span></a>            <span class="n">pats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span>
</span><span id="traction.patient-704"><a href="#traction.patient-704"><span class="linenos">704</span></a>        <span class="k">return</span> <span class="n">pats</span>
</span></pre></div>


            <div class="docstring"><p>patient gets patients and returns them as a list of Patient instances.</p>

<p>the parameters work analog to the sample method.</p>
</div>


                            </div>
                            <div id="traction.trial" class="classattr">
                                        <input id="traction.trial-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trial</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="traction.trial-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#traction.trial"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="traction.trial-705"><a href="#traction.trial-705"><span class="linenos">705</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">trial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="traction.trial-706"><a href="#traction.trial-706"><span class="linenos">706</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction.trial-707"><a href="#traction.trial-707"><span class="linenos">707</span></a><span class="sd">         trial gives trials.</span>
</span><span id="traction.trial-708"><a href="#traction.trial-708"><span class="linenos">708</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction.trial-709"><a href="#traction.trial-709"><span class="linenos">709</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;select code from centraxx_flexistudy&quot;</span>
</span><span id="traction.trial-710"><a href="#traction.trial-710"><span class="linenos">710</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="traction.trial-711"><a href="#traction.trial-711"><span class="linenos">711</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>trial gives trials.</p>
</div>


                            </div>
                            <div id="traction.finding" class="classattr">
                                        <input id="traction.finding-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">finding</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">sampleids</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">patientids</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">idc</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">methods</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">trials</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">values</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="p">[]</span>,</span><span class="param">	<span class="n">verbose_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">print_query</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">raw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="traction.finding-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#traction.finding"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="traction.finding-712"><a href="#traction.finding-712"><span class="linenos">712</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">finding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampleids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patientids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose_all</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">print_query</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">raw</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="traction.finding-713"><a href="#traction.finding-713"><span class="linenos">713</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction.finding-714"><a href="#traction.finding-714"><span class="linenos">714</span></a><span class="sd">         finding gets the laborfindings (&quot;messbefund&quot; / &quot;begleitschein&quot;) for</span>
</span><span id="traction.finding-715"><a href="#traction.finding-715"><span class="linenos">715</span></a><span class="sd">         sampleids or method.  it returns a list of Finding instances.</span>
</span><span id="traction.finding-716"><a href="#traction.finding-716"><span class="linenos">716</span></a><span class="sd">         </span>
</span><span id="traction.finding-717"><a href="#traction.finding-717"><span class="linenos">717</span></a><span class="sd">         you can pass these to verbose: tr.patientid  // maybe also tr.values?</span>
</span><span id="traction.finding-718"><a href="#traction.finding-718"><span class="linenos">718</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction.finding-719"><a href="#traction.finding-719"><span class="linenos">719</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="traction.finding-720"><a href="#traction.finding-720"><span class="linenos">720</span></a>            <span class="n">verbose</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">())</span>
</span><span id="traction.finding-721"><a href="#traction.finding-721"><span class="linenos">721</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_concrete_idcs</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="traction.finding-722"><a href="#traction.finding-722"><span class="linenos">722</span></a>        <span class="k">if</span> <span class="n">idc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.finding-723"><a href="#traction.finding-723"><span class="linenos">723</span></a>           <span class="n">idc</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction.finding-724"><a href="#traction.finding-724"><span class="linenos">724</span></a>        <span class="c1"># todo check that self.sidc() is not in idc</span>
</span><span id="traction.finding-725"><a href="#traction.finding-725"><span class="linenos">725</span></a>        <span class="k">if</span> <span class="n">sampleids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.finding-726"><a href="#traction.finding-726"><span class="linenos">726</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">sampleids</span>
</span><span id="traction.finding-727"><a href="#traction.finding-727"><span class="linenos">727</span></a>        <span class="k">if</span> <span class="n">patientids</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.finding-728"><a href="#traction.finding-728"><span class="linenos">728</span></a>           <span class="n">idc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()]</span> <span class="o">=</span> <span class="n">patientids</span>
</span><span id="traction.finding-729"><a href="#traction.finding-729"><span class="linenos">729</span></a>        <span class="n">selects</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="traction.finding-730"><a href="#traction.finding-730"><span class="linenos">730</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">sampleid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
</span><span id="traction.finding-731"><a href="#traction.finding-731"><span class="linenos">731</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">():</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;idc_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">()</span><span class="si">}</span><span class="s2">.psn as &#39;</span><span class="si">{</span><span class="n">patientid</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>                   
</span><span id="traction.finding-732"><a href="#traction.finding-732"><span class="linenos">732</span></a>        <span class="p">}</span>
</span><span id="traction.finding-733"><a href="#traction.finding-733"><span class="linenos">733</span></a>        <span class="n">idcselectstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectstr</span><span class="p">(</span><span class="n">selects</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="p">[],</span> <span class="n">idc</span><span class="p">)</span>  
</span><span id="traction.finding-734"><a href="#traction.finding-734"><span class="linenos">734</span></a>        <span class="n">joins</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction.finding-735"><a href="#traction.finding-735"><span class="linenos">735</span></a>        <span class="k">for</span> <span class="n">pidc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patientidcs</span><span class="p">():</span>
</span><span id="traction.finding-736"><a href="#traction.finding-736"><span class="linenos">736</span></a>            <span class="n">joins</span><span class="p">[</span><span class="n">pidc</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jd</span><span class="p">[</span><span class="s2">&quot;sample_to_patient&quot;</span><span class="p">]</span>
</span><span id="traction.finding-737"><a href="#traction.finding-737"><span class="linenos">737</span></a>        <span class="n">idcjoinstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joinstr</span><span class="p">(</span><span class="n">joins</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">idc</span><span class="p">)</span>
</span><span id="traction.finding-738"><a href="#traction.finding-738"><span class="linenos">738</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select laborfinding.oid as &quot;laborfinding_oid&quot;, laborfinding.*, labormethod.code as </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">idcselectstr</span><span class="si">}</span>
</span><span id="traction.finding-739"><a href="#traction.finding-739"><span class="linenos">739</span></a><span class="s2">        from centraxx_laborfinding as laborfinding</span>
</span><span id="traction.finding-740"><a href="#traction.finding-740"><span class="linenos">740</span></a>
</span><span id="traction.finding-741"><a href="#traction.finding-741"><span class="linenos">741</span></a><span class="s2">        -- go from laborfinding to sample</span>
</span><span id="traction.finding-742"><a href="#traction.finding-742"><span class="linenos">742</span></a><span class="s2">        left join centraxx_labormethod as labormethod on laborfinding.labormethod = labormethod.oid</span>
</span><span id="traction.finding-743"><a href="#traction.finding-743"><span class="linenos">743</span></a><span class="s2">        left join centraxx_labormapping as labormapping on labormapping.laborfinding = laborfinding.oid</span>
</span><span id="traction.finding-744"><a href="#traction.finding-744"><span class="linenos">744</span></a><span class="s2">        left join centraxx_sample sample on labormapping.relatedoid = sample.oid</span>
</span><span id="traction.finding-745"><a href="#traction.finding-745"><span class="linenos">745</span></a><span class="s2">        </span><span class="si">{</span><span class="n">idcjoinstr</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="traction.finding-746"><a href="#traction.finding-746"><span class="linenos">746</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">idc</span><span class="o">=</span><span class="n">idc</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="n">methods</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">)</span>
</span><span id="traction.finding-747"><a href="#traction.finding-747"><span class="linenos">747</span></a>
</span><span id="traction.finding-748"><a href="#traction.finding-748"><span class="linenos">748</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; where &quot;</span> <span class="o">+</span> <span class="n">wherestr</span>
</span><span id="traction.finding-749"><a href="#traction.finding-749"><span class="linenos">749</span></a>        <span class="k">if</span> <span class="n">print_query</span><span class="p">:</span>
</span><span id="traction.finding-750"><a href="#traction.finding-750"><span class="linenos">750</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="traction.finding-751"><a href="#traction.finding-751"><span class="linenos">751</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction.finding-752"><a href="#traction.finding-752"><span class="linenos">752</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction.finding-753"><a href="#traction.finding-753"><span class="linenos">753</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">finding</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
</span><span id="traction.finding-754"><a href="#traction.finding-754"><span class="linenos">754</span></a>            <span class="k">if</span> <span class="n">values</span> <span class="o">!=</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># todo put this outside of the loop?</span>
</span><span id="traction.finding-755"><a href="#traction.finding-755"><span class="linenos">755</span></a>                <span class="k">continue</span>
</span><span id="traction.finding-756"><a href="#traction.finding-756"><span class="linenos">756</span></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select recordedvalue.*, laborvalue.code as laborvalue_code, laborvalue.dtype as laborvalue_type, laborvalue.custom_catalog as laborvalue_catalog_oid, unit.code as laborvalue_unit</span>
</span><span id="traction.finding-757"><a href="#traction.finding-757"><span class="linenos">757</span></a><span class="s2">                from centraxx_laborfinding as laborfinding</span>
</span><span id="traction.finding-758"><a href="#traction.finding-758"><span class="linenos">758</span></a>
</span><span id="traction.finding-759"><a href="#traction.finding-759"><span class="linenos">759</span></a><span class="s2">                -- go from laborfinding to recorded value</span>
</span><span id="traction.finding-760"><a href="#traction.finding-760"><span class="linenos">760</span></a><span class="s2">                join centraxx_labfindinglabval as labfindinglabval on labfindinglabval.laborfinding = laborfinding.oid</span>
</span><span id="traction.finding-761"><a href="#traction.finding-761"><span class="linenos">761</span></a><span class="s2">                join centraxx_recordedvalue as recordedvalue on labfindinglabval.oid = recordedvalue.oid</span>
</span><span id="traction.finding-762"><a href="#traction.finding-762"><span class="linenos">762</span></a>
</span><span id="traction.finding-763"><a href="#traction.finding-763"><span class="linenos">763</span></a><span class="s2">                --go from labfindinglabval to the laborvalue for the messparam</span>
</span><span id="traction.finding-764"><a href="#traction.finding-764"><span class="linenos">764</span></a><span class="s2">                join centraxx_laborvalue laborvalue on labfindinglabval.laborvalue = laborvalue.oid</span>
</span><span id="traction.finding-765"><a href="#traction.finding-765"><span class="linenos">765</span></a>
</span><span id="traction.finding-766"><a href="#traction.finding-766"><span class="linenos">766</span></a><span class="s2">                --go from laborvalue to unit</span>
</span><span id="traction.finding-767"><a href="#traction.finding-767"><span class="linenos">767</span></a><span class="s2">                left join centraxx_unity unit on laborvalue.unit = unit.oid</span>
</span><span id="traction.finding-768"><a href="#traction.finding-768"><span class="linenos">768</span></a>
</span><span id="traction.finding-769"><a href="#traction.finding-769"><span class="linenos">769</span></a><span class="s2">                where laborfinding.oid = ?</span>
</span><span id="traction.finding-770"><a href="#traction.finding-770"><span class="linenos">770</span></a><span class="s2">            &quot;&quot;&quot;</span>
</span><span id="traction.finding-771"><a href="#traction.finding-771"><span class="linenos">771</span></a>            <span class="n">recvals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">finding</span><span class="p">[</span><span class="s1">&#39;laborfinding_oid&#39;</span><span class="p">])</span>
</span><span id="traction.finding-772"><a href="#traction.finding-772"><span class="linenos">772</span></a>            <span class="n">valsbycode</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction.finding-773"><a href="#traction.finding-773"><span class="linenos">773</span></a>            <span class="k">for</span> <span class="n">recval</span> <span class="ow">in</span> <span class="n">recvals</span><span class="p">:</span>
</span><span id="traction.finding-774"><a href="#traction.finding-774"><span class="linenos">774</span></a>              <span class="n">valsbycode</span><span class="p">[</span><span class="n">recval</span><span class="p">[</span><span class="s2">&quot;laborvalue_code&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_rec</span><span class="p">(</span><span class="n">recval</span><span class="p">,</span> <span class="n">finding</span><span class="p">)</span>
</span><span id="traction.finding-775"><a href="#traction.finding-775"><span class="linenos">775</span></a>            <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">valsbycode</span>
</span><span id="traction.finding-776"><a href="#traction.finding-776"><span class="linenos">776</span></a>        <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
</span><span id="traction.finding-777"><a href="#traction.finding-777"><span class="linenos">777</span></a>            <span class="k">return</span> <span class="n">results</span>
</span><span id="traction.finding-778"><a href="#traction.finding-778"><span class="linenos">778</span></a>        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.finding-779"><a href="#traction.finding-779"><span class="linenos">779</span></a>        <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="traction.finding-780"><a href="#traction.finding-780"><span class="linenos">780</span></a>            <span class="n">finding</span> <span class="o">=</span> <span class="n">Finding</span><span class="p">(</span>
</span><span id="traction.finding-781"><a href="#traction.finding-781"><span class="linenos">781</span></a>                <span class="n">findingdate</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;findingdate&quot;</span><span class="p">),</span>
</span><span id="traction.finding-782"><a href="#traction.finding-782"><span class="linenos">782</span></a>                <span class="n">method</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">],</span>
</span><span id="traction.finding-783"><a href="#traction.finding-783"><span class="linenos">783</span></a>                <span class="n">methodname</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;shortname&quot;</span><span class="p">],</span>
</span><span id="traction.finding-784"><a href="#traction.finding-784"><span class="linenos">784</span></a>                <span class="n">patient</span><span class="o">=</span><span class="n">Idable</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dig</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">patientid</span><span class="p">),</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">(),</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pidc</span><span class="p">())</span> <span class="k">if</span> <span class="n">dig</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">patientid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> 
</span><span id="traction.finding-785"><a href="#traction.finding-785"><span class="linenos">785</span></a>                <span class="n">recs</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;values&quot;</span> <span class="ow">in</span> <span class="n">res</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="c1"># todo None ok?</span>
</span><span id="traction.finding-786"><a href="#traction.finding-786"><span class="linenos">786</span></a>                <span class="n">sample</span><span class="o">=</span><span class="n">Idable</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="n">sampleid</span><span class="p">],</span> <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">(),</span> <span class="n">mainidc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sidc</span><span class="p">()),</span>
</span><span id="traction.finding-787"><a href="#traction.finding-787"><span class="linenos">787</span></a>                <span class="n">sender</span><span class="o">=</span><span class="kc">None</span>
</span><span id="traction.finding-788"><a href="#traction.finding-788"><span class="linenos">788</span></a>            <span class="p">)</span>
</span><span id="traction.finding-789"><a href="#traction.finding-789"><span class="linenos">789</span></a>            <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="traction.finding-790"><a href="#traction.finding-790"><span class="linenos">790</span></a>        <span class="k">return</span> <span class="n">findings</span>
</span></pre></div>


            <div class="docstring"><p>finding gets the laborfindings ("messbefund" / "begleitschein") for
sampleids or method.  it returns a list of Finding instances.</p>

<p>you can pass these to verbose: <a href="#patientid">tr.patientid</a>  // maybe also <a href="#values">tr.values</a>?</p>
</div>


                            </div>
                            <div id="traction.method" class="classattr">
                                        <input id="traction.method-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">method</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">methods</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="traction.method-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#traction.method"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="traction.method-791"><a href="#traction.method-791"><span class="linenos">791</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="traction.method-792"><a href="#traction.method-792"><span class="linenos">792</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction.method-793"><a href="#traction.method-793"><span class="linenos">793</span></a><span class="sd">         method (messprofil) gets method(s) and their labvals (messparameter).</span>
</span><span id="traction.method-794"><a href="#traction.method-794"><span class="linenos">794</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction.method-795"><a href="#traction.method-795"><span class="linenos">795</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;select laborvalue.*, labormethod.code as &quot;method&quot;</span>
</span><span id="traction.method-796"><a href="#traction.method-796"><span class="linenos">796</span></a><span class="s2">from centraxx_labormethod labormethod</span>
</span><span id="traction.method-797"><a href="#traction.method-797"><span class="linenos">797</span></a><span class="s2">inner join centraxx_crftemplate crf_t</span>
</span><span id="traction.method-798"><a href="#traction.method-798"><span class="linenos">798</span></a><span class="s2">    on labormethod.crf_template=crf_t.oid</span>
</span><span id="traction.method-799"><a href="#traction.method-799"><span class="linenos">799</span></a><span class="s2">inner join centraxx_crftempsection crf_ts</span>
</span><span id="traction.method-800"><a href="#traction.method-800"><span class="linenos">800</span></a><span class="s2">    on crf_t.oid=crf_ts.crftemplate</span>
</span><span id="traction.method-801"><a href="#traction.method-801"><span class="linenos">801</span></a><span class="s2">inner join centraxx_crftempsection_fields crf_tsf</span>
</span><span id="traction.method-802"><a href="#traction.method-802"><span class="linenos">802</span></a><span class="s2">    on crf_ts.oid=crf_tsf.crftempsection_oid</span>
</span><span id="traction.method-803"><a href="#traction.method-803"><span class="linenos">803</span></a><span class="s2">inner join centraxx_crftempfield crf_tf</span>
</span><span id="traction.method-804"><a href="#traction.method-804"><span class="linenos">804</span></a><span class="s2">    on crf_tsf.crftempfield_oid=crf_tf.oid</span>
</span><span id="traction.method-805"><a href="#traction.method-805"><span class="linenos">805</span></a><span class="s2">inner join centraxx_laborvalue laborvalue</span>
</span><span id="traction.method-806"><a href="#traction.method-806"><span class="linenos">806</span></a><span class="s2">    on crf_tf.laborvalue=laborvalue.oid&quot;&quot;&quot;</span>
</span><span id="traction.method-807"><a href="#traction.method-807"><span class="linenos">807</span></a>        <span class="p">(</span><span class="n">wherestr</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_where</span><span class="p">(</span><span class="n">methods</span><span class="o">=</span><span class="n">methods</span><span class="p">)</span>
</span><span id="traction.method-808"><a href="#traction.method-808"><span class="linenos">808</span></a>
</span><span id="traction.method-809"><a href="#traction.method-809"><span class="linenos">809</span></a>        <span class="k">if</span> <span class="n">wherestr</span><span class="p">:</span>
</span><span id="traction.method-810"><a href="#traction.method-810"><span class="linenos">810</span></a>          <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; where &quot;</span> <span class="o">+</span> <span class="n">wherestr</span>
</span><span id="traction.method-811"><a href="#traction.method-811"><span class="linenos">811</span></a>        <span class="c1"># print(query)</span>
</span><span id="traction.method-812"><a href="#traction.method-812"><span class="linenos">812</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">whereargs</span><span class="p">)</span>
</span><span id="traction.method-813"><a href="#traction.method-813"><span class="linenos">813</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction.method-814"><a href="#traction.method-814"><span class="linenos">814</span></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction.method-815"><a href="#traction.method-815"><span class="linenos">815</span></a>          <span class="n">mc</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>
</span><span id="traction.method-816"><a href="#traction.method-816"><span class="linenos">816</span></a>          <span class="k">if</span> <span class="n">mc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
</span><span id="traction.method-817"><a href="#traction.method-817"><span class="linenos">817</span></a>            <span class="n">out</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction.method-818"><a href="#traction.method-818"><span class="linenos">818</span></a>          <span class="k">del</span> <span class="n">row</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>
</span><span id="traction.method-819"><a href="#traction.method-819"><span class="linenos">819</span></a>          <span class="n">out</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span>
</span><span id="traction.method-820"><a href="#traction.method-820"><span class="linenos">820</span></a>        
</span><span id="traction.method-821"><a href="#traction.method-821"><span class="linenos">821</span></a>        <span class="k">return</span> <span class="n">out</span>
</span></pre></div>


            <div class="docstring"><p>method (messprofil) gets method(s) and their labvals (messparameter).</p>
</div>


                            </div>
                            <div id="traction.name" class="classattr">
                                        <input id="traction.name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">name</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">table</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">lang</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ml_table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="traction.name-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#traction.name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="traction.name-822"><a href="#traction.name-822"><span class="linenos">822</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lang</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ml_table</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="traction.name-823"><a href="#traction.name-823"><span class="linenos">823</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction.name-824"><a href="#traction.name-824"><span class="linenos">824</span></a><span class="sd">         name gives the multilingual names for a code or all codes in a table.</span>
</span><span id="traction.name-825"><a href="#traction.name-825"><span class="linenos">825</span></a><span class="sd">         </span>
</span><span id="traction.name-826"><a href="#traction.name-826"><span class="linenos">826</span></a><span class="sd">         the result is keyed by code and language like this:</span>
</span><span id="traction.name-827"><a href="#traction.name-827"><span class="linenos">827</span></a><span class="sd">         </span>
</span><span id="traction.name-828"><a href="#traction.name-828"><span class="linenos">828</span></a><span class="sd">         </span>
</span><span id="traction.name-829"><a href="#traction.name-829"><span class="linenos">829</span></a><span class="sd">         &quot;NUM_NMR_ISOLEUCINE_VALUE&quot;: {  </span>
</span><span id="traction.name-830"><a href="#traction.name-830"><span class="linenos">830</span></a><span class="sd">            &quot;de&quot;: &quot;Isoleucin&quot;,  </span>
</span><span id="traction.name-831"><a href="#traction.name-831"><span class="linenos">831</span></a><span class="sd">            &quot;en&quot;: &quot;Isoleucine&quot;  </span>
</span><span id="traction.name-832"><a href="#traction.name-832"><span class="linenos">832</span></a><span class="sd">         }</span>
</span><span id="traction.name-833"><a href="#traction.name-833"><span class="linenos">833</span></a><span class="sd">         </span>
</span><span id="traction.name-834"><a href="#traction.name-834"><span class="linenos">834</span></a><span class="sd">         </span>
</span><span id="traction.name-835"><a href="#traction.name-835"><span class="linenos">835</span></a><span class="sd">         table: the name of the centraxx table without centraxx_ prefix  </span>
</span><span id="traction.name-836"><a href="#traction.name-836"><span class="linenos">836</span></a><span class="sd">         code: a specific code, if none given, all code - name mappings for table are given  </span>
</span><span id="traction.name-837"><a href="#traction.name-837"><span class="linenos">837</span></a><span class="sd">         lang: de|en  </span>
</span><span id="traction.name-838"><a href="#traction.name-838"><span class="linenos">838</span></a><span class="sd">         ml_table: if the name of the table connecting to multilingualentry is not simlpy the queried table name followed by &quot;_ml_name&quot;, give the connecting table&#39;s name here. eg: name(&#39;laborvaluegroup&#39;, ..., ml_name=&#39;labval_grp_ml_name&#39;)  </span>
</span><span id="traction.name-839"><a href="#traction.name-839"><span class="linenos">839</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction.name-840"><a href="#traction.name-840"><span class="linenos">840</span></a>        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;select [&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;].code, multilingual.value as name, multilingual.lang as lang&quot;</span>
</span><span id="traction.name-841"><a href="#traction.name-841"><span class="linenos">841</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; from [centraxx_&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;] as [&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
</span><span id="traction.name-842"><a href="#traction.name-842"><span class="linenos">842</span></a>        <span class="n">ml_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="traction.name-843"><a href="#traction.name-843"><span class="linenos">843</span></a>        <span class="k">if</span> <span class="n">ml_table</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># the name is different</span>
</span><span id="traction.name-844"><a href="#traction.name-844"><span class="linenos">844</span></a>            <span class="n">ml_name</span> <span class="o">=</span> <span class="s2">&quot;centraxx_&quot;</span> <span class="o">+</span> <span class="n">ml_table</span>
</span><span id="traction.name-845"><a href="#traction.name-845"><span class="linenos">845</span></a>        <span class="k">else</span><span class="p">:</span> <span class="c1"># the name is the same</span>
</span><span id="traction.name-846"><a href="#traction.name-846"><span class="linenos">846</span></a>            <span class="n">ml_name</span> <span class="o">=</span> <span class="s2">&quot;centraxx_&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;_ml_name&quot;</span>
</span><span id="traction.name-847"><a href="#traction.name-847"><span class="linenos">847</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; inner join [&quot;</span> <span class="o">+</span> <span class="n">ml_name</span> <span class="o">+</span> <span class="s2">&quot;] mlname on mlname.related_oid = [&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;].oid&quot;</span>
</span><span id="traction.name-848"><a href="#traction.name-848"><span class="linenos">848</span></a>        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; inner join centraxx_multilingualentry multilingual on mlname.oid = multilingual.oid&quot;</span>
</span><span id="traction.name-849"><a href="#traction.name-849"><span class="linenos">849</span></a>        <span class="n">wherestrings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.name-850"><a href="#traction.name-850"><span class="linenos">850</span></a>        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="traction.name-851"><a href="#traction.name-851"><span class="linenos">851</span></a>        <span class="k">if</span> <span class="n">code</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.name-852"><a href="#traction.name-852"><span class="linenos">852</span></a>            <span class="n">wherestrings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_whereparam</span><span class="p">(</span><span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="n">table</span> <span class="o">+</span> <span class="s2">&quot;].code&quot;</span><span class="p">))</span>
</span><span id="traction.name-853"><a href="#traction.name-853"><span class="linenos">853</span></a>            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="traction.name-854"><a href="#traction.name-854"><span class="linenos">854</span></a>        <span class="k">if</span> <span class="n">lang</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="traction.name-855"><a href="#traction.name-855"><span class="linenos">855</span></a>            <span class="n">wherestrings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_whereparam</span><span class="p">(</span><span class="s2">&quot;multilingual.lang&quot;</span><span class="p">))</span>
</span><span id="traction.name-856"><a href="#traction.name-856"><span class="linenos">856</span></a>            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span>
</span><span id="traction.name-857"><a href="#traction.name-857"><span class="linenos">857</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wherestrings</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="traction.name-858"><a href="#traction.name-858"><span class="linenos">858</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; where &quot;</span>
</span><span id="traction.name-859"><a href="#traction.name-859"><span class="linenos">859</span></a>            <span class="c1"># join where clauses by and</span>
</span><span id="traction.name-860"><a href="#traction.name-860"><span class="linenos">860</span></a>            <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; and &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wherestrings</span><span class="p">)</span>
</span><span id="traction.name-861"><a href="#traction.name-861"><span class="linenos">861</span></a>
</span><span id="traction.name-862"><a href="#traction.name-862"><span class="linenos">862</span></a>        <span class="c1"># print(query)</span>
</span><span id="traction.name-863"><a href="#traction.name-863"><span class="linenos">863</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">qfad</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="traction.name-864"><a href="#traction.name-864"><span class="linenos">864</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction.name-865"><a href="#traction.name-865"><span class="linenos">865</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="traction.name-866"><a href="#traction.name-866"><span class="linenos">866</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span>
</span><span id="traction.name-867"><a href="#traction.name-867"><span class="linenos">867</span></a>            <span class="n">lang</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="s2">&quot;lang&quot;</span><span class="p">]</span>
</span><span id="traction.name-868"><a href="#traction.name-868"><span class="linenos">868</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
</span><span id="traction.name-869"><a href="#traction.name-869"><span class="linenos">869</span></a>               <span class="n">out</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="traction.name-870"><a href="#traction.name-870"><span class="linenos">870</span></a>            <span class="n">out</span><span class="p">[</span><span class="n">code</span><span class="p">][</span><span class="n">lang</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="traction.name-871"><a href="#traction.name-871"><span class="linenos">871</span></a>        <span class="k">return</span> <span class="n">out</span>
</span></pre></div>


            <div class="docstring"><p>name gives the multilingual names for a code or all codes in a table.</p>

<p>the result is keyed by code and language like this:</p>

<p>"NUM_NMR_ISOLEUCINE_VALUE": {<br />
   "de": "Isoleucin",<br />
   "en": "Isoleucine"<br />
}</p>

<p>table: the name of the centraxx table without centraxx_ prefix<br />
code: a specific code, if none given, all code - name mappings for table are given<br />
lang: de|en<br />
ml_table: if the name of the table connecting to multilingualentry is not simlpy the queried table name followed by "_ml_name", give the connecting table's name here. eg: name('laborvaluegroup', ..., ml_name='labval_grp_ml_name')</p>
</div>


                            </div>
                            <div id="traction.sidc" class="classattr">
                                        <input id="traction.sidc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sidc</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="traction.sidc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#traction.sidc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="traction.sidc-872"><a href="#traction.sidc-872"><span class="linenos">872</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sidc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="traction.sidc-873"><a href="#traction.sidc-873"><span class="linenos">873</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction.sidc-874"><a href="#traction.sidc-874"><span class="linenos">874</span></a><span class="sd">         sidc returns the main idc code by which samples are referenced as</span>
</span><span id="traction.sidc-875"><a href="#traction.sidc-875"><span class="linenos">875</span></a><span class="sd">         specified in the settings. </span>
</span><span id="traction.sidc-876"><a href="#traction.sidc-876"><span class="linenos">876</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction.sidc-877"><a href="#traction.sidc-877"><span class="linenos">877</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;sampleid&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>sidc returns the main idc code by which samples are referenced as
specified in the settings.</p>
</div>


                            </div>
                            <div id="traction.pidc" class="classattr">
                                        <input id="traction.pidc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">pidc</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="traction.pidc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#traction.pidc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="traction.pidc-878"><a href="#traction.pidc-878"><span class="linenos">878</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pidc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="traction.pidc-879"><a href="#traction.pidc-879"><span class="linenos">879</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="traction.pidc-880"><a href="#traction.pidc-880"><span class="linenos">880</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="traction.pidc-881"><a href="#traction.pidc-881"><span class="linenos">881</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;patientid&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>
</span></pre></div>


    

                            </div>
                </section>
    </main>
</body>
</html>